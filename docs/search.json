[{"path":"index.html","id":"data-preparation","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"IMAP-Part 07: Microbiome Data Preparation Guide","text":"","code":""},{"path":"index.html","id":"welcome-to-chapter-7","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Welcome to chapter 7","text":"Microbiome research employs high-throughput sequencing explore microbial communities across diverse environments. project focuses preparing visualizing microbiome data generated Mothur QIIME2 pipelines. dataset comprises OTU table, taxonomic assignments, metadata. comprehensive guide tailored researchers analysts engaged microbiome studies, providing essential insights methodologies adequate data preparation. Assuming bioinformatics analysis phase successfully completed now possess output features tables, including Operational Taxonomic Unit (OTU) tables, taxonomy tables, metadata table, platforms Mothur QIIME2, guide lead crucial steps refining optimizing microbiome data.","code":""},{"path":"index.html","id":"what-to-expect","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"What to Expect","text":"diving details, let’s take look can expect guide:Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring seamless follow-.Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring seamless follow-.Best Practices: Discover best practices data cleaning, transformation, integration, emphasizing optimization microbiome datasets robust analysis.Best Practices: Discover best practices data cleaning, transformation, integration, emphasizing optimization microbiome datasets robust analysis.Practical Insights: Beyond technical instructions, guide offers practical insights navigate nuanced decisions data preparation, empowering informed choices aligned research goals.Practical Insights: Beyond technical instructions, guide offers practical insights navigate nuanced decisions data preparation, empowering informed choices aligned research goals.Whether ’re venturing microbial communities first time seeking advanced strategies refine microbiome data, guide companion. commitment data preparation pivotal extracting meaningful biological insights contributing advancement microbiome research.Let’s dive !","code":""},{"path":"preface.html","id":"preface","chapter":"Preparing for Downstream Analysis","heading":"Preparing for Downstream Analysis","text":"foundation downstream analyses, effective data preparation essential extracting meaningful biological insights. guide addresses technical aspects data cleaning, transformation, integration also offers practical insights guide researchers nuanced decisions involved optimizing microbiome datasets.","code":""},{"path":"preface.html","id":"why-data-preparation-matters","chapter":"Preparing for Downstream Analysis","heading":"Why Data Preparation Matters","text":"Microbiome analysis relies heavily quality integrity data. researchers analysts, meticulous process data preparation crucial guaranteeing reliability downstream analyses accuracy biological interpretations. guide acknowledges diverse skill levels readers, catering novice researchers seeking foundational knowledge experienced analysts search advanced strategies.","code":""},{"path":"preface.html","id":"using-otu-and-taxonomy-tables","chapter":"Preparing for Downstream Analysis","heading":"Using OTU and Taxonomy Tables","text":"chapter, explore practical utilization Operational Taxonomic Unit (OTU) tables taxonomy tables essential inputs downstream analysis. Derived bioinformatics phase, tables play pivotal roles investigating composition diversity microbial communities. gain insights effectively cleaning, transforming, integrating tables prepare variety downstream analyses.","code":""},{"path":"preface.html","id":"integrating-metadata-for-context","chapter":"Preparing for Downstream Analysis","heading":"Integrating Metadata for Context","text":"integration metadata table enhances analytical capabilities facilitating grouping observations based relevant variables. integration contextualizes microbiome data also enables exploration impact different conditions factors microbial community composition. guide demonstrates seamless incorporation metadata, unlocking valuable insights relationships microbial communities external variables.","code":""},{"path":"prepare-mothur-output.html","id":"prepare-mothur-output","chapter":"1 Prepare Mothur Output","heading":"1 Prepare Mothur Output","text":"","code":""},{"path":"prepare-mothur-output.html","id":"data-directories","chapter":"1 Prepare Mothur Output","heading":"1.1 Data directories","text":"","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/mothur')) {dir.create('data/mothur')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())"},{"path":"prepare-mothur-output.html","id":"mothur-metadata","chapter":"1 Prepare Mothur Output","heading":"1.2 Mothur metadata","text":"","code":"\nread_tsv(\"data/mothur/mothur_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  write_csv(\"data/mothur/mothur_tidy_metadata.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-otutable","chapter":"1 Prepare Mothur Output","heading":"1.3 Mothur otutable","text":"","code":"\nread_tsv(\"../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared\", skip = 0, show_col_types = FALSE) %>%\n  dplyr::rename(group=\"Group\") %>% \n  dplyr::select(-c(label, numASVs)) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-group, names_to = \"OTU\", values_to = \"count\") %>% \n  write_csv(\"data/mothur/mothur_tidy_otutable.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-taxonomy","chapter":"1 Prepare Mothur Output","heading":"1.4 Mothur taxonomy","text":"","code":"\nread_tsv(\"../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy\", show_col_types=FALSE) %>% \n  distinct() %>%\n  dplyr::select(-Size) %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxonomy = gsub(\"\\\\(100\\\\)\", \"\", Taxonomy)) %>%  \n  separate(Taxonomy, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/mothur/mothur_tidy_taxonomy.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-composite","chapter":"1 Prepare Mothur Output","heading":"1.5 Mothur composite","text":"","code":"\n# Mothur composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nmothur_tidy_metadata <- read_csv(\"data/mothur/mothur_tidy_metadata.csv\", show_col_types = FALSE)\nmothur_tidy_otutable <- read_csv(\"data/mothur/mothur_tidy_otutable.csv\", show_col_types = FALSE)\nmothur_tidy_taxonomy <- read_csv(\"data/mothur/mothur_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nmothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = \"group\") %>% \n  inner_join(., mothur_tidy_taxonomy, by = \"OTU\") %>% \n  group_by(group) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(mothur_composite, \"data/mothur/mothur_composite.csv\")"},{"path":"prepare-mothur-output.html","id":"create-a-phyloseq-object","chapter":"1 Prepare Mothur Output","heading":"1.6 Create a phyloseq object","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ape)\n\nmetadata <- read_csv(\"data/mothur/mothur_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"group\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/mothur/mothur_tidy_otutable.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = group, names_from = OTU, values_from = count) %>% \n  tibble::column_to_rownames(\"group\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/mothur/mothur_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"OTU\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\n\nps_raw <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\nps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})\n\nps_df_raw <- psmelt(ps_raw)\n\nps_df_rel <- psmelt(ps_raw)\n\nsave(ps_tree, ps_raw, ps_rel, ps_df_raw, ps_df_rel, file = \"data/qiime2/mothur_phyloseq_objects.rda\")"},{"path":"prepare-mothur-output.html","id":"review-the-mothur-phyloseq-object","chapter":"1 Prepare Mothur Output","heading":"1.7 Review the mothur phyloseq object","text":"","code":"\nps_rawphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 920 taxa and 10 samples ]\nsample_data() Sample Data:       [ 10 samples by 2 sample variables ]\ntax_table()   Taxonomy Table:    [ 920 taxa by 6 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 920 tips and 919 internal nodes ]"},{"path":"prepare-qiime2-output.html","id":"prepare-qiime2-output","chapter":"2 Prepare Qiime2 Output","heading":"2 Prepare Qiime2 Output","text":"","code":""},{"path":"prepare-qiime2-output.html","id":"data-directories-1","chapter":"2 Prepare Qiime2 Output","heading":"2.1 Data directories","text":"","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/qiime2')) {dir.create('data/qiime2')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())"},{"path":"prepare-qiime2-output.html","id":"qiime2-metadata","chapter":"2 Prepare Qiime2 Output","heading":"2.2 Qiime2 metadata","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/resources/metadata/qiime2_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  dplyr::rename(sample_id=\"sample-id\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_metadata.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-otutable","chapter":"2 Prepare Qiime2 Output","heading":"2.3 Qiime2 otutable","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/feature-table.tsv\", skip = 1, show_col_types = FALSE) %>%\n  dplyr::rename(feature='#OTU ID') %>%\n  select(-starts_with('Mock')) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-feature, names_to = \"sample_id\", values_to = \"count\") %>% \n  relocate(sample_id, .before = feature) %>% \n  write_csv(\"data/qiime2/qiime2_tidy_otutable.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-taxonomy","chapter":"2 Prepare Qiime2 Output","heading":"2.4 Qiime2 taxonomy","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/taxonomy.tsv\", show_col_types=FALSE) %>% \n  dplyr::rename(feature=\"Feature ID\") %>% \n  distinct() %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxon = str_replace_all(Taxon, \"; s__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; g__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; f__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; o__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; c__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; p__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; k__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\[|\\\\]\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\s\", \"\")) %>%\n  dplyr::filter(!grepl(\"s__*\", Taxon)) %>%\n  dplyr::filter(grepl(\"g__*\", Taxon)) %>% \n  select(-Confidence) %>% \n  mutate(Taxon = str_replace_all(Taxon, \"\\\\w__\", \"\")) %>% \n  separate(Taxon, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-composite","chapter":"2 Prepare Qiime2 Output","heading":"2.5 Qiime2 composite","text":"","code":"\n# QIIME2 composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nqiime2_tidy_metadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\", show_col_types = FALSE)\nqiime2_tidy_otutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\", show_col_types = FALSE)\nqiime2_tidy_taxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nqiime2_composite <- inner_join(qiime2_tidy_metadata, qiime2_tidy_otutable, by = \"sample_id\") %>% \n  inner_join(., qiime2_tidy_taxonomy, by = \"feature\") %>% \n  group_by(sample_id) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(qiime2_composite, \"data/qiime2/qiime2_composite.csv\")"},{"path":"prepare-qiime2-output.html","id":"create-a-phyloseq-object-1","chapter":"2 Prepare Qiime2 Output","heading":"2.6 Create a phyloseq object","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ape)\n\nmetadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = sample_id, names_from = feature, values_from = count) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"feature\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\n\nps_raw <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\nps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})\n\nps_df_raw <- psmelt(ps_raw)\n\nps_df_rel <- psmelt(ps_raw)\n\nsave(ps_tree, ps_raw, ps_rel, ps_df_raw, ps_df_rel, file = \"data/qiime2/qiime2_phyloseq_objects.rda\")"},{"path":"prepare-qiime2-output.html","id":"review-the-phyloseq-object","chapter":"2 Prepare Qiime2 Output","heading":"2.7 Review the phyloseq object","text":"…","code":"\nps_rawphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 95 taxa and 128 samples ]\nsample_data() Sample Data:       [ 128 samples by 12 sample variables ]\ntax_table()   Taxonomy Table:    [ 95 taxa by 6 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 95 tips and 94 internal nodes ]"},{"path":"import-preprocessed-microbiome-data.html","id":"import-preprocessed-microbiome-data","chapter":"3 Import Preprocessed Microbiome Data","heading":"3 Import Preprocessed Microbiome Data","text":"section, presenting process importing authentic preprocessed data, serve cornerstone subsequent analyses. Although synthetic data certainly advantages, can times introduce biases limitations fully capture intricate diversity inherent real microbiome samples.","code":""},{"path":"import-preprocessed-microbiome-data.html","id":"the-globalpatterns-dataset","chapter":"3 Import Preprocessed Microbiome Data","heading":"3.1 The GlobalPatterns dataset","text":"GlobalPatterns dataset, sourced Earth Microbiome Project (EMP), serves comprehensive repository studying microbial communities worldwide. ’s breakdown key attributes:Source: GlobalPatterns originates Earth Microbiome Project (EMP), collecting samples worldwide.Source: GlobalPatterns originates Earth Microbiome Project (EMP), collecting samples worldwide.Composition: comprises high-throughput sequencing data, revealing taxonomic composition microbial communities.Composition: comprises high-throughput sequencing data, revealing taxonomic composition microbial communities.Scope: Samples represent diverse global ecosystems, offering comprehensive view microbial biodiversity.Scope: Samples represent diverse global ecosystems, offering comprehensive view microbial biodiversity.Format: Presented phyloseq object R, integrates sample metadata taxonomic abundance analysis.Format: Presented phyloseq object R, integrates sample metadata taxonomic abundance analysis.Utility: Researchers utilize community profiling, abundance testing, ecological modeling, enhancing understanding global microbial diversity function.Utility: Researchers utilize community profiling, abundance testing, ecological modeling, enhancing understanding global microbial diversity function.","code":"\nlibrary(phyloseq)\ndata(\"GlobalPatterns\")\n\nGlobalPatternsphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 19216 taxa and 26 samples ]\nsample_data() Sample Data:       [ 26 samples by 7 sample variables ]\ntax_table()   Taxonomy Table:    [ 19216 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 19216 tips and 19215 internal nodes ]"},{"path":"import-preprocessed-microbiome-data.html","id":"the-dietswap-dataset","chapter":"3 Import Preprocessed Microbiome Data","heading":"3.2 The dietswap dataset","text":"dietswap dataset, available microbiome R package, offers valuable insights effects dietary interventions microbial communities. ’s overview attributes:Source: dietswap dataset derived research examining impact dietary changes human gut microbiome.Source: dietswap dataset derived research examining impact dietary changes human gut microbiome.Composition: comprises high-throughput sequencing data, providing insights taxonomic composition dynamics microbial communities response dietary alterations.Composition: comprises high-throughput sequencing data, providing insights taxonomic composition dynamics microbial communities response dietary alterations.Scope: Samples obtained human participants undergoing dietary interventions, enabling researchers explore different diets influence microbial diversity function within gut microbiome.Scope: Samples obtained human participants undergoing dietary interventions, enabling researchers explore different diets influence microbial diversity function within gut microbiome.Format: Presented format suitable microbiome analysis, dataset includes sample metadata taxonomic abundance data, facilitating comprehensive analyses microbial community dynamics.Format: Presented format suitable microbiome analysis, dataset includes sample metadata taxonomic abundance data, facilitating comprehensive analyses microbial community dynamics.Utility: Researchers utilize dietswap dataset investigate effects dietary interventions gut microbiome composition, contributing better understanding intricate interactions diet, host physiology, microbial ecology.Utility: Researchers utilize dietswap dataset investigate effects dietary interventions gut microbiome composition, contributing better understanding intricate interactions diet, host physiology, microbial ecology.","code":"\nlibrary(microbiome)\ndata(\"dietswap\")\n\ndietswapphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]"},{"path":"imap-github-repos.html","id":"imap-github-repos","chapter":"A IMAP GitHub Repos","heading":"A IMAP GitHub Repos","text":"","code":""},{"path":"data-preparation-rulegraph.html","id":"data-preparation-rulegraph","chapter":"B Data Preparation Rulegraph","heading":"B Data Preparation Rulegraph","text":"","code":""},{"path":"session-information.html","id":"session-information","chapter":"C Session Information","heading":"C Session Information","text":"Reproducibility relies ability precisely recreate working environment, session information serves vital reference achieve consistency. record details R environment, package versions, system settings computing environment time analysis.","code":"\nlibrary(sessioninfo)\n\n# Get session info\ninfo <- capture.output(print(session_info()))\n\n# Define patterns to exclude\nexclude_patterns <- c(\"/Users/.*\", \"Africa/Dar_es_Salaam\") # This line is location-dependent\n\n# Exclude lines containing specific information\ninfo_filtered <- info[!grepl(paste(exclude_patterns, collapse = \"|\"), info)]\n\n# Save the filtered session info to a text file in the root directory without line numbers\ncat(info_filtered, file = \"session_info.txt\", sep = \"\\n\")"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
