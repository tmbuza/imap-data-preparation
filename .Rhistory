pivot_longer(-feature, names_to = "sample_id", values_to = "count") %>%
relocate(sample_id, .before = feature) %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/resources/metadata/mothur_sample_metadata.tsv", show_col_types = FALSE) %>%
write_csv("data/mothur/mothur_tidy_metadata.csv")
read_tsv("../imap-mothur-bioinformatics/resources/metadata/mothur_sample_metadata.tsv", show_col_types = FALSE)
read_tsv("data/mothur/mothur_sample_metadata.tsv", show_col_types = FALSE) %>%
write_csv("data/mothur/mothur_tidy_metadata.csv")
read_tsv("data/mothur/mothur_sample_metadata.tsv", show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-feature, names_to = "sample_id", values_to = "count") %>%
relocate(sample_id, .before = feature) %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-c(label, Group, numOtus), names_to = "sample_id", values_to = "count")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric) %>%
dplyr::select(-c(label, Group, numOtus))
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric) %>%
dplyr::select(-c(label, Group, numOtus)) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric) %>%
dplyr::select(-c(label, Group, numOtus)) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(names_to = "otu", values_to = "count")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
mutate_at(2:ncol(.), as.numeric)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus))
ead_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(names_to = "otu", values_to = "count")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-Group, names_to = "otu", values_to = "count")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/sample.final.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-Group, names_to = "otu", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/export/taxonomy.tsv", show_col_types=FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.taxonomy", show_col_types=FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.0.03.cons.taxonomy", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus))
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-Group, names_to = "otu", values_to = "count")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-Group, names_to = "otu", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("data/mothur/mothur_sample_metadata.tsv", show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct()
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("\\(100\\)", "", Taxonomy)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("\\(100\\)", "", "Taxonomy")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("\\(100\\)", "", .)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("\(100\)", "", .)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("(100)", "", .)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("\\(100\\)", "", .)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
gsub("\\(100\\)", "", .)
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
gsub("\\(100\\)", "", .)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
gsub("\\(100\\)", "", 'Taxonomy)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
gsub("\\(100\\)", "", 'Taxonomy')
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
# separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy))
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
write_csv("data/mothur/mothur_tidy_taxonomy.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
write_csv("data/mothur/mothur_tidy_taxonomy.csv")
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
# Mothur composite
library(tidyverse, suppressPackageStartupMessages())
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "sample_id") %>%
inner_join(., mothur_tidy_taxonomy, by = "feature") %>%
group_by(sample_id) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
relocate(count, .before = rel_abund)
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "sample_id") %>%
inner_join(., mothur_tidy_taxonomy, by = "feature") %>%
group_by(sample_id)
inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "sample_id")
mothur_tidy_taxonomy
mothur_tidy_otutable
mothur_tidy_metadata
mothur_tidy_metadata
mothur_tidy_otutable
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-Group, names_to = "otu", values_to = "count") %>%
dplyr::rename(group, Group)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group, Group)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group, Group)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(Group, group)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group, "Group")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-Group, names_to = "otu", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-group, names_to = "otu", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
write_csv("data/mothur/mothur_tidy_taxonomy.csv")
read_tsv("data/mothur/mothur_sample_metadata.tsv", show_col_types = FALSE) %>%
write_csv("data/mothur/mothur_tidy_metadata.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-group, names_to = "OTU", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
write_csv("data/mothur/mothur_tidy_taxonomy.csv")
# Mothur composite
library(tidyverse, suppressPackageStartupMessages())
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "sample_id") %>%
inner_join(., mothur_tidy_taxonomy, by = "feature") %>%
group_by(sample_id) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
relocate(count, .before = rel_abund)
inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group")
inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU")
inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group")
mothur_tidy_taxonomy
inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";")
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/otu_analysis/final.opti_mcc.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE)
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numOtus)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-group, names_to = "OTU", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numOtus))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group")
{r}
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numASVs))
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numASVs)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-group, names_to = "OTU", values_to = "count") %>%
write_csv("data/mothur/mothur_tidy_otutable.csv")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared", skip = 0, show_col_types = FALSE) %>%
dplyr::rename(group="Group") %>%
dplyr::select(-c(label, numASVs)) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-group, names_to = "OTU", values_to = "count")
read_tsv("../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy", show_col_types=FALSE) %>%
distinct() %>%
dplyr::select(-Size) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
mutate(Taxonomy = gsub("\\(100\\)", "", Taxonomy)) %>%
separate(Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep = ";") %>%
write_csv("data/mothur/mothur_tidy_taxonomy.csv")
# Mothur composite
library(tidyverse, suppressPackageStartupMessages())
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(sample_id) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
relocate(count, .before = rel_abund)
mothur_tidy_metadata
mothur_tidy_otutable
mothur_tidy_taxonomy
inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU")
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group)
mothur_composite
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group) %>%
mutate(rel_abund = count/sum(count))
mothur_composite
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group) %>%
mutate(rel_abund = count/sum(count))
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup()
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0))
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
relocate(count, .before = rel_abund)
mothur_composite
# Mothur composite
library(tidyverse, suppressPackageStartupMessages())
mothur_tidy_metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv", show_col_types = FALSE)
mothur_tidy_otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv", show_col_types = FALSE)
mothur_tidy_taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
mothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = "group") %>%
inner_join(., mothur_tidy_taxonomy, by = "OTU") %>%
group_by(group) %>%
mutate(rel_abund = count/sum(count)) %>%
ungroup() %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
relocate(count, .before = rel_abund)
write_csv(mothur_composite, "data/mothur/mothur_composite.csv")
library(tidyverse)
library(phyloseq)
library(microbiome)
library(ape)
metadata <- read_csv("data/mothur/mothur_tidy_metadata.csv",show_col_types = FALSE) %>%
tibble::column_to_rownames("group") %>%
sample_data(metadata)
otutable <- read_csv("data/mothur/mothur_tidy_features.csv",show_col_types = FALSE) %>%
pivot_wider(id_cols = group, names_from = feature, values_from = count) %>%
tibble::column_to_rownames("group") %>%
otu_table(otutable, taxa_are_rows = FALSE)
metadata
otutable
otutable <- read_csv("data/mothur/mothur_otutable.tsv",show_col_types = FALSE) %>%
pivot_wider(id_cols = group, names_from = feature, values_from = count) %>%
tibble::column_to_rownames("group") %>%
otu_table(otutable, taxa_are_rows = FALSE)
read_csv("data/mothur/mothur_otutable.tsv",show_col_types = FALSE)
otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv",show_col_types = FALSE)
otutable
otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv",show_col_types = FALSE) %>%
pivot_wider(id_cols = group, names_from = OTU, values_from = count)
otutable
otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv",show_col_types = FALSE) %>%
pivot_wider(id_cols = group, names_from = OTU, values_from = count) %>%
tibble::column_to_rownames("group")
otutable
otutable <- read_csv("data/mothur/mothur_tidy_otutable.csv",show_col_types = FALSE) %>%
pivot_wider(id_cols = group, names_from = OTU, values_from = count) %>%
tibble::column_to_rownames("group") %>%
otu_table(otutable, taxa_are_rows = FALSE)
otutable
read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE)
read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE) %>%
tibble::column_to_rownames("OTU") %>%
as.matrix()
taxonomy <- read_csv("data/mothur/mothur_tidy_taxonomy.csv", show_col_types = FALSE) %>%
tibble::column_to_rownames("OTU") %>%
as.matrix() %>%
tax_table(taxonomy)
taxonomy
ps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)
library(ape)
ps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))
ps_raw <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)
ps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})
save(ps_tree, ps_raw, ps_rel,  file = "data/mothur/mothur_phyloseq_objects.rda")
read_tsv("../imap-qiime2-bioinformatics/resources/metadata/qiime2_sample_metadata.tsv", show_col_types = FALSE) %>%
dplyr::rename(sample_id="sample-id") %>%
write_csv("data/qiime2/qiime2_tidy_metadata.csv")
read_tsv("../imap-qiime2-bioinformatics/resources/metadata/qiime2_sample_metadata.tsv", show_col_types = FALSE) %>%
dplyr::rename(sample_id="sample-id")
read_tsv("../imap-qiime2-bioinformatics/qiime2_process/export/feature-table.tsv", skip = 1, show_col_types = FALSE) %>%
dplyr::rename(feature='#OTU ID') %>%
select(-starts_with('Mock')) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-feature, names_to = "sample_id", values_to = "count") %>%
relocate(sample_id, .before = feature) %>%
write_csv("data/qiime2/qiime2_tidy_otutable.csv")
qiime2_tidy_otutable.csv
read_tsv("../imap-qiime2-bioinformatics/qiime2_process/export/feature-table.tsv", skip = 1, show_col_types = FALSE) %>%
dplyr::rename(feature='#OTU ID') %>%
select(-starts_with('Mock')) %>%
mutate_at(2:ncol(.), as.numeric) %>%
mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%
pivot_longer(-feature, names_to = "sample_id", values_to = "count") %>%
relocate(sample_id, .before = feature)
