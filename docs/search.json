[{"path":"index.html","id":"data-preparation","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"IMAP-Part 07: Microbiome Data Preparation Guide","text":"","code":""},{"path":"index.html","id":"welcome-to-chapter-7","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Welcome to chapter 7","text":"Microbiome research employs high-throughput sequencing explore microbial communities across diverse environments. project focuses preparing visualizing microbiome data generated Mothur QIIME2 pipelines. dataset comprises OTU table, taxonomic assignments, metadata. comprehensive guide tailored researchers analysts engaged microbiome studies, providing essential insights methodologies adequate data preparation. Assuming bioinformatics analysis phase successfully completed now possess output features tables, including Operational Taxonomic Unit (OTU) tables, taxonomy tables, metadata table, platforms Mothur QIIME2, guide lead crucial steps refining optimizing microbiome data.","code":""},{"path":"index.html","id":"what-to-expect","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"What to Expect","text":"diving details, let’s take look can expect guide:Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring seamless follow-.Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring seamless follow-.Best Practices: Discover best practices data cleaning, transformation, integration, emphasizing optimization microbiome datasets robust analysis.Best Practices: Discover best practices data cleaning, transformation, integration, emphasizing optimization microbiome datasets robust analysis.Practical Insights: Beyond technical instructions, guide offers practical insights navigate nuanced decisions data preparation, empowering informed choices aligned research goals.Practical Insights: Beyond technical instructions, guide offers practical insights navigate nuanced decisions data preparation, empowering informed choices aligned research goals.Whether ’re venturing microbial communities first time seeking advanced strategies refine microbiome data, guide companion. commitment data preparation pivotal extracting meaningful biological insights contributing advancement microbiome research.Let’s dive !","code":""},{"path":"preface.html","id":"preface","chapter":"Preparing for Downstream Analysis","heading":"Preparing for Downstream Analysis","text":"foundation downstream analyses, effective data preparation essential extracting meaningful biological insights. guide addresses technical aspects data cleaning, transformation, integration also offers practical insights guide researchers nuanced decisions involved optimizing microbiome datasets.","code":""},{"path":"preface.html","id":"why-data-preparation-matters","chapter":"Preparing for Downstream Analysis","heading":"Why Data Preparation Matters","text":"Microbiome analysis relies heavily quality integrity data. researchers analysts, meticulous process data preparation crucial guaranteeing reliability downstream analyses accuracy biological interpretations. guide acknowledges diverse skill levels readers, catering novice researchers seeking foundational knowledge experienced analysts search advanced strategies.","code":""},{"path":"preface.html","id":"using-otu-and-taxonomy-tables","chapter":"Preparing for Downstream Analysis","heading":"Using OTU and Taxonomy Tables","text":"chapter, explore practical utilization Operational Taxonomic Unit (OTU) tables taxonomy tables essential inputs downstream analysis. Derived bioinformatics phase, tables play pivotal roles investigating composition diversity microbial communities. gain insights effectively cleaning, transforming, integrating tables prepare variety downstream analyses.","code":""},{"path":"preface.html","id":"integrating-metadata-for-context","chapter":"Preparing for Downstream Analysis","heading":"Integrating Metadata for Context","text":"integration metadata table enhances analytical capabilities facilitating grouping observations based relevant variables. integration contextualizes microbiome data also enables exploration impact different conditions factors microbial community composition. guide demonstrates seamless incorporation metadata, unlocking valuable insights relationships microbial communities external variables.","code":""},{"path":"data-tidying.html","id":"data-tidying","chapter":"1 Data Tidying","heading":"1 Data Tidying","text":"","code":""},{"path":"data-tidying.html","id":"general-snakemake-workflow","chapter":"1 Data Tidying","heading":"1.1 General snakemake workflow","text":"tentative snakemake workflow defines data processing rules DAG (directed acyclic graph) format.\ndetailed interactive snakemake HTML report available . Use wider screen get better interactive snakemake report.","code":""},{"path":"data-tidying.html","id":"data-tidying-1","chapter":"1 Data Tidying","heading":"1.2 Data Tidying","text":"Requires:Sample metadataOTU tables mothur qiime2 pipelines.Taxonomy tables mothur qiime2 pipelines.","code":""},{"path":"data-tidying.html","id":"microbiome-composite-r-objects","chapter":"1 Data Tidying","heading":"1.3 Microbiome composite R objects","text":"Requires:Tidy sample metadata.Tidy OTU tables.Tidy taxonomy tables.mothur qiime2 composite objects long-format suitable types data visualization.","code":""},{"path":"data-tidying.html","id":"microbioma-phyloseq-objects","chapter":"1 Data Tidying","heading":"1.4 Microbioma phyloseq objects","text":"Requires:phyloseq packageTidy sample metadata.Tidy OTU tables.Tidy taxonomy tables.","code":""},{"path":"data-tidying.html","id":"data-transformation","chapter":"1 Data Tidying","heading":"1.5 Data transformation","text":"Requires:phyloseq packageA microbiome packagePhyloseq objectsData transformation intended converting values ready--use matrices.\ndifferent methods , just :transformation similar raw abundance.Compositional version relative abundance.Arc sine (asin) transformation.Z-transform OTUs.Z-transform Samples.Log10 transformation.Log10p transformation,CLR transformation.Shift baseline.Data Scaling.","code":""},{"path":"data-tidying.html","id":"data-reduction","chapter":"1 Data Tidying","heading":"1.6 Data reduction","text":"Dimensionality reduction intended reduce dimension variables keeping much variation possible. , includes:Linear methods (commonly used microbiome data analysis)\nPCA (Principal Component Analysis)\nFactor Analysis\nLDA (Linear Discriminant Analysis)\n.\nPCA (Principal Component Analysis)Factor AnalysisLDA (Linear Discriminant Analysis).Non-linear methods","code":""},{"path":"prepare-mothur-output.html","id":"prepare-mothur-output","chapter":"2 Prepare Mothur Output","heading":"2 Prepare Mothur Output","text":"","code":""},{"path":"prepare-mothur-output.html","id":"data-directories","chapter":"2 Prepare Mothur Output","heading":"2.1 Data directories","text":"","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/mothur')) {dir.create('data/mothur')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())"},{"path":"prepare-mothur-output.html","id":"mothur-metadata","chapter":"2 Prepare Mothur Output","heading":"2.2 Mothur metadata","text":"","code":"\nread_tsv(\"data/mothur/mothur_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  write_csv(\"data/mothur/mothur_tidy_metadata.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-otutable","chapter":"2 Prepare Mothur Output","heading":"2.3 Mothur otutable","text":"","code":"\nread_tsv(\"../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared\", skip = 0, show_col_types = FALSE) %>%\n  dplyr::rename(group=\"Group\") %>% \n  dplyr::select(-c(label, numASVs)) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-group, names_to = \"OTU\", values_to = \"count\") %>% \n  write_csv(\"data/mothur/mothur_tidy_otutable.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-taxonomy","chapter":"2 Prepare Mothur Output","heading":"2.4 Mothur taxonomy","text":"","code":"\nread_tsv(\"../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy\", show_col_types=FALSE) %>% \n  distinct() %>%\n  dplyr::select(-Size) %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxonomy = gsub(\"\\\\(100\\\\)\", \"\", Taxonomy)) %>%  \n  separate(Taxonomy, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/mothur/mothur_tidy_taxonomy.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-composite","chapter":"2 Prepare Mothur Output","heading":"2.5 Mothur composite","text":"","code":"\n# Mothur composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nmothur_tidy_metadata <- read_csv(\"data/mothur/mothur_tidy_metadata.csv\", show_col_types = FALSE)\nmothur_tidy_otutable <- read_csv(\"data/mothur/mothur_tidy_otutable.csv\", show_col_types = FALSE)\nmothur_tidy_taxonomy <- read_csv(\"data/mothur/mothur_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nmothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = \"group\") %>% \n  inner_join(., mothur_tidy_taxonomy, by = \"OTU\") %>% \n  group_by(group) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(mothur_composite, \"data/mothur/mothur_composite.csv\")"},{"path":"prepare-mothur-output.html","id":"create-a-phyloseq-object","chapter":"2 Prepare Mothur Output","heading":"2.6 Create a phyloseq object","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ape)\n\nmetadata <- read_csv(\"data/mothur/mothur_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"group\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/mothur/mothur_tidy_otutable.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = group, names_from = OTU, values_from = count) %>% \n  tibble::column_to_rownames(\"group\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/mothur/mothur_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"OTU\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\n\nps_raw <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\nps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})\n\nps_df_raw <- psmelt(ps_raw)\n\nps_df_rel <- psmelt(ps_raw)\n\nsave(ps_tree, ps_raw, ps_rel, ps_df_raw, ps_df_rel, file = \"data/qiime2/mothur_phyloseq_objects.rda\")"},{"path":"prepare-mothur-output.html","id":"review-the-mothur-phyloseq-object","chapter":"2 Prepare Mothur Output","heading":"2.7 Review the mothur phyloseq object","text":"","code":"\nps_rawphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 920 taxa and 10 samples ]\nsample_data() Sample Data:       [ 10 samples by 2 sample variables ]\ntax_table()   Taxonomy Table:    [ 920 taxa by 6 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 920 tips and 919 internal nodes ]"},{"path":"prepare-qiime2-output.html","id":"prepare-qiime2-output","chapter":"3 Prepare Qiime2 Output","heading":"3 Prepare Qiime2 Output","text":"","code":""},{"path":"prepare-qiime2-output.html","id":"data-directories-1","chapter":"3 Prepare Qiime2 Output","heading":"3.1 Data directories","text":"","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/qiime2')) {dir.create('data/qiime2')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())"},{"path":"prepare-qiime2-output.html","id":"qiime2-metadata","chapter":"3 Prepare Qiime2 Output","heading":"3.2 Qiime2 metadata","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/resources/metadata/qiime2_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  dplyr::rename(sample_id=\"sample-id\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_metadata.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-otutable","chapter":"3 Prepare Qiime2 Output","heading":"3.3 Qiime2 otutable","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/feature-table.tsv\", skip = 1, show_col_types = FALSE) %>%\n  dplyr::rename(feature='#OTU ID') %>%\n  select(-starts_with('Mock')) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-feature, names_to = \"sample_id\", values_to = \"count\") %>% \n  relocate(sample_id, .before = feature) %>% \n  write_csv(\"data/qiime2/qiime2_tidy_otutable.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-taxonomy","chapter":"3 Prepare Qiime2 Output","heading":"3.4 Qiime2 taxonomy","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/taxonomy.tsv\", show_col_types=FALSE) %>% \n  dplyr::rename(feature=\"Feature ID\") %>% \n  distinct() %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxon = str_replace_all(Taxon, \"; s__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; g__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; f__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; o__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; c__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; p__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; k__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\[|\\\\]\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\s\", \"\")) %>%\n  dplyr::filter(!grepl(\"s__*\", Taxon)) %>%\n  dplyr::filter(grepl(\"g__*\", Taxon)) %>% \n  select(-Confidence) %>% \n  mutate(Taxon = str_replace_all(Taxon, \"\\\\w__\", \"\")) %>% \n  separate(Taxon, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-composite","chapter":"3 Prepare Qiime2 Output","heading":"3.5 Qiime2 composite","text":"","code":"\n# QIIME2 composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nqiime2_tidy_metadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\", show_col_types = FALSE)\nqiime2_tidy_otutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\", show_col_types = FALSE)\nqiime2_tidy_taxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nqiime2_composite <- inner_join(qiime2_tidy_metadata, qiime2_tidy_otutable, by = \"sample_id\") %>% \n  inner_join(., qiime2_tidy_taxonomy, by = \"feature\") %>% \n  group_by(sample_id) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(qiime2_composite, \"data/qiime2/qiime2_composite.csv\")"},{"path":"prepare-qiime2-output.html","id":"create-a-phyloseq-object-1","chapter":"3 Prepare Qiime2 Output","heading":"3.6 Create a phyloseq object","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ape)\n\nmetadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = sample_id, names_from = feature, values_from = count) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"feature\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\n\nps_raw <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\nps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})\n\nps_df_raw <- psmelt(ps_raw)\n\nps_df_rel <- psmelt(ps_raw)\n\nsave(ps_tree, ps_raw, ps_rel, ps_df_raw, ps_df_rel, file = \"data/qiime2/qiime2_phyloseq_objects.rda\")"},{"path":"prepare-qiime2-output.html","id":"review-the-phyloseq-object","chapter":"3 Prepare Qiime2 Output","heading":"3.7 Review the phyloseq object","text":"…","code":"\nps_rawphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 95 taxa and 128 samples ]\nsample_data() Sample Data:       [ 128 samples by 12 sample variables ]\ntax_table()   Taxonomy Table:    [ 95 taxa by 6 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 95 tips and 94 internal nodes ]"},{"path":"import-preprocessed-microbiome-data.html","id":"import-preprocessed-microbiome-data","chapter":"4 Import Preprocessed Microbiome Data","heading":"4 Import Preprocessed Microbiome Data","text":"section, presenting process importing authentic preprocessed data, serve cornerstone subsequent analyses. Although synthetic data certainly advantages, can times introduce biases limitations fully capture intricate diversity inherent real microbiome samples.","code":""},{"path":"import-preprocessed-microbiome-data.html","id":"the-globalpatterns-dataset","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.1 The GlobalPatterns dataset","text":"GlobalPatterns dataset, sourced Earth Microbiome Project (EMP), serves comprehensive repository studying microbial communities worldwide. ’s breakdown key attributes:Source: GlobalPatterns originates Earth Microbiome Project (EMP), collecting samples worldwide.Source: GlobalPatterns originates Earth Microbiome Project (EMP), collecting samples worldwide.Composition: comprises high-throughput sequencing data, revealing taxonomic composition microbial communities.Composition: comprises high-throughput sequencing data, revealing taxonomic composition microbial communities.Scope: Samples represent diverse global ecosystems, offering comprehensive view microbial biodiversity.Scope: Samples represent diverse global ecosystems, offering comprehensive view microbial biodiversity.Format: Presented phyloseq object R, integrates sample metadata taxonomic abundance analysis.Format: Presented phyloseq object R, integrates sample metadata taxonomic abundance analysis.Utility: Researchers utilize community profiling, abundance testing, ecological modeling, enhancing understanding global microbial diversity function.Utility: Researchers utilize community profiling, abundance testing, ecological modeling, enhancing understanding global microbial diversity function.","code":"\nlibrary(phyloseq) # for GlobalPatterns dataset\ndata(\"GlobalPatterns\")\n\nps_GlobalPatterns <-GlobalPatterns\ndf_GlobalPatterns <-GlobalPatterns %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  rename_all(tolower)\n\ncolnames(df_GlobalPatterns) [1] \"sample_id\"                \"otu\"                     \n [3] \"sample\"                   \"abundance\"               \n [5] \"x.sampleid\"               \"primer\"                  \n [7] \"final_barcode\"            \"barcode_truncated_plus_t\"\n [9] \"barcode_full_length\"      \"sampletype\"              \n[11] \"description\"              \"kingdom\"                 \n[13] \"phylum\"                   \"class\"                   \n[15] \"order\"                    \"family\"                  \n[17] \"genus\"                    \"species\"                 \ncat(\"\\n\")\nps_GlobalPatternsphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 19216 taxa and 26 samples ]\nsample_data() Sample Data:       [ 26 samples by 7 sample variables ]\ntax_table()   Taxonomy Table:    [ 19216 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 19216 tips and 19215 internal nodes ]"},{"path":"import-preprocessed-microbiome-data.html","id":"the-dietswap-dataset","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.2 The dietswap dataset","text":"dietswap dataset, available microbiome R package, offers valuable insights effects dietary interventions microbial communities. ’s overview attributes:Source: dietswap dataset derived research examining impact dietary changes human gut microbiome.Source: dietswap dataset derived research examining impact dietary changes human gut microbiome.Composition: comprises high-throughput sequencing data, providing insights taxonomic composition dynamics microbial communities response dietary alterations.Composition: comprises high-throughput sequencing data, providing insights taxonomic composition dynamics microbial communities response dietary alterations.Scope: Samples obtained human participants undergoing dietary interventions, enabling researchers explore different diets influence microbial diversity function within gut microbiome.Scope: Samples obtained human participants undergoing dietary interventions, enabling researchers explore different diets influence microbial diversity function within gut microbiome.Format: Presented format suitable microbiome analysis, dataset includes sample metadata taxonomic abundance data, facilitating comprehensive analyses microbial community dynamics.Format: Presented format suitable microbiome analysis, dataset includes sample metadata taxonomic abundance data, facilitating comprehensive analyses microbial community dynamics.Utility: Researchers utilize dietswap dataset investigate effects dietary interventions gut microbiome composition, contributing better understanding intricate interactions diet, host physiology, microbial ecology.Utility: Researchers utilize dietswap dataset investigate effects dietary interventions gut microbiome composition, contributing better understanding intricate interactions diet, host physiology, microbial ecology.","code":"\nlibrary(microbiome) # for dietswap dataset\ndata(\"dietswap\")\n\nps_dietswap <-dietswap\ndf_dietswap <-dietswap %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  dplyr::select(-9) %>% \n  rename_all(tolower)\n\ncolnames(df_dietswap) [1] \"sample_id\"              \"otu\"                    \"sample\"                \n [4] \"abundance\"              \"subject\"                \"sex\"                   \n [7] \"nationality\"            \"group\"                  \"timepoint\"             \n[10] \"timepoint.within.group\" \"bmi_group\"              \"phylum\"                \n[13] \"family\"                 \"genus\"                 \ncat(\"\\n\")\nps_dietswapphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]"},{"path":"import-preprocessed-microbiome-data.html","id":"caporaso-dataset","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.3 Caporaso dataset","text":"Caporaso dataset provides valuable insights microbial marker genes associations various biological factors.Source: Caporaso dataset included microbiomeMarker R package derived research led Dr. J. Gregory Caporaso. aims provide insights microbial marker genes associations various biological factors.Source: Caporaso dataset included microbiomeMarker R package derived research led Dr. J. Gregory Caporaso. aims provide insights microbial marker genes associations various biological factors.Composition: dataset comprises high-throughput sequencing data, focusing microbial marker genes diverse biological samples. offers valuable information regarding taxonomic composition functional potential microbial communities.Composition: dataset comprises high-throughput sequencing data, focusing microbial marker genes diverse biological samples. offers valuable information regarding taxonomic composition functional potential microbial communities.Scope: Samples collected range environments, including limited human microbiomes, environmental samples, animal microbiomes. diversity allows researchers explore microbial diversity across different ecosystems conditions.Scope: Samples collected range environments, including limited human microbiomes, environmental samples, animal microbiomes. diversity allows researchers explore microbial diversity across different ecosystems conditions.Format: dataset structured facilitate microbiome marker analysis, sample metadata taxonomic abundance data included. format enables researchers conduct comprehensive analyses microbial marker genes associations environmental biological factors.Format: dataset structured facilitate microbiome marker analysis, sample metadata taxonomic abundance data included. format enables researchers conduct comprehensive analyses microbial marker genes associations environmental biological factors.Utility: Researchers utilize Caporaso dataset investigate microbial marker genes’ roles various ecosystems, host-microbiome interactions, environmental responses, disease states. dataset contributes better understanding microbial ecology implications human health environmental management.Utility: Researchers utilize Caporaso dataset investigate microbial marker genes’ roles various ecosystems, host-microbiome interactions, environmental responses, disease states. dataset contributes better understanding microbial ecology implications human health environmental management.","code":"\nlibrary(microbiomeMarker) # for caporaso dataset\ndata(\"caporaso\")\n\nps_caporaso <-caporaso\ndf_caporaso <-caporaso %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  rename_all(tolower)\n\ncolnames(df_caporaso) [1] \"sample_id\"                \"otu\"                     \n [3] \"sample\"                   \"abundance\"               \n [5] \"sampletype\"               \"year\"                    \n [7] \"month\"                    \"day\"                     \n [9] \"subject\"                  \"reportedantibioticusage\" \n[11] \"dayssinceexperimentstart\" \"description\"             \n[13] \"kingdom\"                  \"phylum\"                  \n[15] \"class\"                    \"order\"                   \n[17] \"family\"                   \"genus\"                   \n[19] \"species\"                 \ncat(\"\\n\")\nps_caporasophyloseq-class experiment-level object\notu_table()   OTU Table:         [ 3426 taxa and 34 samples ]\nsample_data() Sample Data:       [ 34 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 3426 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 3426 tips and 3424 internal nodes ]"},{"path":"import-preprocessed-microbiome-data.html","id":"kostic_crc-dataset","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.4 Kostic_CRC dataset","text":"Kostic_CRC dataset provides valuable insights gut microbiome individuals diagnosed colorectal cancer (CRC).Source: Kostic_CRC dataset included microbiomeMarker R package. derived research conducted Kostic Lab focuses investigating gut microbiome colorectal cancer (CRC) patients.Source: Kostic_CRC dataset included microbiomeMarker R package. derived research conducted Kostic Lab focuses investigating gut microbiome colorectal cancer (CRC) patients.Composition: dataset comprises high-throughput sequencing data, specifically targeting gut microbiome individuals colorectal cancer. provides insights taxonomic composition potential functional characteristics microbial communities associated CRC.Composition: dataset comprises high-throughput sequencing data, specifically targeting gut microbiome individuals colorectal cancer. provides insights taxonomic composition potential functional characteristics microbial communities associated CRC.Scope: Samples collected individuals diagnosed colorectal cancer, allowing researchers explore microbial diversity potential biomarkers associated CRC development progression.Scope: Samples collected individuals diagnosed colorectal cancer, allowing researchers explore microbial diversity potential biomarkers associated CRC development progression.Format: dataset structured facilitate microbiome marker analysis, including sample metadata taxonomic abundance data. format enables researchers conduct comprehensive analyses microbial community dynamics colorectal cancer.Format: dataset structured facilitate microbiome marker analysis, including sample metadata taxonomic abundance data. format enables researchers conduct comprehensive analyses microbial community dynamics colorectal cancer.Utility: Researchers utilize Kostic_CRC dataset investigate role gut microbiome colorectal cancer pathogenesis, prognosis, treatment response. dataset contributes deeper understanding complex interplay gut microbiome colorectal cancer biology, potentially leading novel diagnostic therapeutic strategies.Utility: Researchers utilize Kostic_CRC dataset investigate role gut microbiome colorectal cancer pathogenesis, prognosis, treatment response. dataset contributes deeper understanding complex interplay gut microbiome colorectal cancer biology, potentially leading novel diagnostic therapeutic strategies.","code":"\nlibrary(microbiomeMarker) # for kostic_crc dataset\ndata(\"kostic_crc\")\n\nps_kostic_crc <-kostic_crc\ndf_kostic_crc <-kostic_crc %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  rename_all(tolower)\n\ncolnames(df_kostic_crc) [1] \"sample_id\"                     \"otu\"                          \n [3] \"sample\"                        \"abundance\"                    \n [5] \"x.sampleid\"                    \"barcodesequence\"              \n [7] \"linkerprimersequence\"          \"necrosis_percent\"             \n [9] \"target_subfragment\"            \"assigned_from_geo\"            \n[11] \"experiment_center\"             \"title\"                        \n[13] \"run_prefix\"                    \"age\"                          \n[15] \"normal_equivalent_percent\"     \"fibroblast_and_vessel_percent\"\n[17] \"depth\"                         \"treatment\"                    \n[19] \"age_at_diagnosis\"              \"common_name\"                  \n[21] \"host_common_name\"              \"body_site\"                    \n[23] \"elevation\"                     \"reports_received\"             \n[25] \"cea\"                           \"pcr_primers\"                  \n[27] \"collection_date\"               \"altitude\"                     \n[29] \"env_biome\"                     \"sex\"                          \n[31] \"platform\"                      \"race\"                         \n[33] \"bsp_diagnosis\"                 \"study_center\"                 \n[35] \"country\"                       \"chemotherapy\"                 \n[37] \"year_of_death\"                 \"ethnicity\"                    \n[39] \"anonymized_name\"               \"taxon_id\"                     \n[41] \"sample_center\"                 \"samp_size\"                    \n[43] \"year_of_birth\"                 \"original_diagnosis\"           \n[45] \"age_unit\"                      \"study_id\"                     \n[47] \"experiment_design_description\" \"description_duplicate\"        \n[49] \"diagnosis\"                     \"body_habitat\"                 \n[51] \"sequencing_meth\"               \"run_date\"                     \n[53] \"histologic_grade\"              \"longitude\"                    \n[55] \"env_matter\"                    \"target_gene\"                  \n[57] \"env_feature\"                   \"key_seq\"                      \n[59] \"body_product\"                  \"tumor_percent\"                \n[61] \"library_construction_protocol\" \"region\"                       \n[63] \"run_center\"                    \"tumor_type\"                   \n[65] \"bsp_notes\"                     \"radiation_therapy\"            \n[67] \"inflammation_percent\"          \"host_subject_id\"              \n[69] \"pc3\"                           \"latitude\"                     \n[71] \"osh_diagnosis\"                 \"stage\"                        \n[73] \"primary_disease\"               \"host_taxid\"                   \n[75] \"description\"                   \"kingdom\"                      \n[77] \"phylum\"                        \"class\"                        \n[79] \"order\"                         \"family\"                       \n[81] \"genus\"                         \"species\"                      \ncat(\"\\n\")\nps_kostic_crcphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 2505 taxa and 177 samples ]\nsample_data() Sample Data:       [ 177 samples by 71 sample variables ]\ntax_table()   Taxonomy Table:    [ 2505 taxa by 7 taxonomic ranks ]"},{"path":"import-preprocessed-microbiome-data.html","id":"save_ps_objects","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.5 Save objects for transformation and exploration","text":"","code":"\nsave(df_GlobalPatterns, \n     # df_ibd_phylo, \n     df_dietswap,  \n     df_caporaso,\n     df_kostic_crc,\n\n     ps_GlobalPatterns, \n     # ps_ibd_phylo, \n     ps_dietswap,\n     ps_caporaso,\n     ps_kostic_crc,\n     file = \"data/external/external_ps_objects.rda\")"},{"path":"import-preprocessed-microbiome-data.html","id":"confirm-saved-objects","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.6 Confirm saved objects","text":"","code":"\nload(\"data/external/external_ps_objects.rda\", verbose = TRUE)Loading objects:\n  df_GlobalPatterns\n  df_dietswap\n  df_caporaso\n  df_kostic_crc\n  ps_GlobalPatterns\n  ps_dietswap\n  ps_caporaso\n  ps_kostic_crc"},{"path":"import-preprocessed-microbiome-data.html","id":"review-phyloseq-objects","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7 Review Phyloseq Objects","text":"","code":"\nlibrary(phyloseq)\nlibrary(ape)\n\nps <- ps_dietswap\n\nlibrary(metagMisc)"},{"path":"import-preprocessed-microbiome-data.html","id":"taxonomy-rank-names","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.1 Taxonomy rank names","text":"","code":"\nrank_names(ps)[1] \"Phylum\" \"Family\" \"Genus\" "},{"path":"import-preprocessed-microbiome-data.html","id":"number-of-taxa","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.2 Number of taxa","text":"","code":"\nntaxa(ps)[1] 130"},{"path":"import-preprocessed-microbiome-data.html","id":"split-by-taxon-name-e.g.-firmicutes","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.3 Split by taxon name, e.g. Firmicutes","text":"","code":"\ntaxa_stats <- phyloseq_sep_tax(ps, TaxRank = \"Phylum\", drop_NA = FALSE)\ncat(\"\\n\")\ntaxa_stats$Firmicutesphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 76 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 76 taxa by 3 taxonomic ranks ]\ncat(\"\\n\")\ntaxa_stats$Bacteroidetesphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 16 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 16 taxa by 3 taxonomic ranks ]\ncat(\"\\n\")\ntaxa_stats$Actinobacteriaphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 8 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 8 taxa by 3 taxonomic ranks ]"},{"path":"import-preprocessed-microbiome-data.html","id":"number-of-samples","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.4 Number of samples","text":"","code":"\nnsamples(ps)[1] 222"},{"path":"import-preprocessed-microbiome-data.html","id":"sample-names","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.5 Sample names","text":"","code":"\nhead(sample_names(ps), 20) [1] \"Sample-1\"  \"Sample-2\"  \"Sample-3\"  \"Sample-4\"  \"Sample-5\"  \"Sample-6\" \n [7] \"Sample-7\"  \"Sample-8\"  \"Sample-9\"  \"Sample-10\" \"Sample-11\" \"Sample-12\"\n[13] \"Sample-13\" \"Sample-14\" \"Sample-15\" \"Sample-16\" \"Sample-17\" \"Sample-18\"\n[19] \"Sample-19\" \"Sample-20\""},{"path":"import-preprocessed-microbiome-data.html","id":"sample-variables","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.6 Sample variables","text":"","code":"\nsample_variables(ps)[1] \"subject\"                \"sex\"                    \"nationality\"           \n[4] \"group\"                  \"sample\"                 \"timepoint\"             \n[7] \"timepoint.within.group\" \"bmi_group\"             "},{"path":"import-preprocessed-microbiome-data.html","id":"abundance-table","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.7 Abundance table","text":"","code":"\notu_table(ps)[1:5, 1:5]OTU Table:          [5 taxa and 5 samples]\n                     taxa are rows\n                             Sample-1 Sample-2 Sample-3 Sample-4 Sample-5\nActinomycetaceae                    0        1        0        1        0\nAerococcus                          0        0        0        0        0\nAeromonas                           0        0        0        0        0\nAkkermansia                        18       97       67      256       21\nAlcaligenes faecalis et rel.        1        2        3        2        2"},{"path":"import-preprocessed-microbiome-data.html","id":"taxonomy-table","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.8 Taxonomy table","text":"","code":"\ntax_table(ps)[1:5, ]Taxonomy Table:     [5 taxa by 3 taxonomic ranks]:\n                             Phylum            Family           \nActinomycetaceae             \"Actinobacteria\"  \"Actinobacteria\" \nAerococcus                   \"Firmicutes\"      \"Bacilli\"        \nAeromonas                    \"Proteobacteria\"  \"Proteobacteria\" \nAkkermansia                  \"Verrucomicrobia\" \"Verrucomicrobia\"\nAlcaligenes faecalis et rel. \"Proteobacteria\"  \"Proteobacteria\" \n                             Genus                         \nActinomycetaceae             \"Actinomycetaceae\"            \nAerococcus                   \"Aerococcus\"                  \nAeromonas                    \"Aeromonas\"                   \nAkkermansia                  \"Akkermansia\"                 \nAlcaligenes faecalis et rel. \"Alcaligenes faecalis et rel.\""},{"path":"import-preprocessed-microbiome-data.html","id":"phylogenetic-tree-if-available","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.9 Phylogenetic tree if available","text":"","code":""},{"path":"import-preprocessed-microbiome-data.html","id":"taxa-names","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.10 Taxa names","text":"","code":"\ntaxa_names(ps)[1:10] [1] \"Actinomycetaceae\"                  \"Aerococcus\"                       \n [3] \"Aeromonas\"                         \"Akkermansia\"                      \n [5] \"Alcaligenes faecalis et rel.\"      \"Allistipes et rel.\"               \n [7] \"Anaerobiospirillum\"                \"Anaerofustis\"                     \n [9] \"Anaerostipes caccae et rel.\"       \"Anaerotruncus colihominis et rel.\""},{"path":"import-preprocessed-microbiome-data.html","id":"summarize-phyloseq-object","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.11 Summarize Phyloseq Object","text":"","code":"\nmicrobiome::summarize_phyloseq(ps)[[1]]\n[1] \"1] Min. number of reads = 1776\"\n\n[[2]]\n[1] \"2] Max. number of reads = 28883\"\n\n[[3]]\n[1] \"3] Total number of reads = 2949085\"\n\n[[4]]\n[1] \"4] Average number of reads = 13284.1666666667\"\n\n[[5]]\n[1] \"5] Median number of reads = 13255\"\n\n[[6]]\n[1] \"7] Sparsity = 0.205647955647956\"\n\n[[7]]\n[1] \"6] Any OTU sum to 1 or less? YES\"\n\n[[8]]\n[1] \"8] Number of singletons = 10\"\n\n[[9]]\n[1] \"9] Percent of OTUs that are singletons \\n        (i.e. exactly one read detected across all samples)2.30769230769231\"\n\n[[10]]\n[1] \"10] Number of sample variables are: 8\"\n\n[[11]]\n[1] \"subject\"                \"sex\"                    \"nationality\"           \n[4] \"group\"                  \"sample\"                 \"timepoint\"             \n[7] \"timepoint.within.group\" \"bmi_group\"             "},{"path":"import-preprocessed-microbiome-data.html","id":"sort-samples-in-ascending-and-descending","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.12 Sort Samples in ascending and descending","text":"","code":"\ncat(\"In ascending order\\n\")In ascending order\nhead(sort(phyloseq::sample_sums(ps), decreasing = F)) Sample-56 Sample-195 Sample-196  Sample-42 Sample-164 Sample-147 \n      1776       4477       4606       5006       5541       5624 \ncat(\"\\nIn descending order\\n\")\nIn descending order\nhead(sort(phyloseq::sample_sums(ps), decreasing = T))  Sample-3  Sample-11  Sample-12  Sample-54 Sample-208  Sample-20 \n     28883      26895      25238      23529      23131      22413 "},{"path":"import-preprocessed-microbiome-data.html","id":"drop-samples-below-a-threshold","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.13 Drop Samples Below a Threshold","text":"","code":"\nps1perc0 <- phyloseq::subset_samples(ps, phyloseq::sample_sums(ps) > 1)\nps1perc0phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]"},{"path":"import-preprocessed-microbiome-data.html","id":"drop-taxa-below-a-threshold","chapter":"4 Import Preprocessed Microbiome Data","heading":"4.7.14 Drop Taxa Below a Threshold","text":"","code":"\npstaxa01 <- phyloseq::prune_taxa(phyloseq::taxa_sums(ps) > 1, ps)\npstaxa01 phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 120 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 120 taxa by 3 taxonomic ranks ]"},{"path":"data-tarnsformation.html","id":"data-tarnsformation","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5 Data Tranformation from Phyloseq Objects","text":"process data transformation microbiome analysis involves converting raw relative abundance values matrices suitable analysis. Data transformation focuses modifying data . context, explore various methods used transformation phyloseq object.","code":""},{"path":"data-tarnsformation.html","id":"import-processed-phyloseq-object","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.1 Import processed phyloseq object","text":"","code":"\nload(\"../imap-data-preparation/data/external/external_ps_objects.rda\", verbose = TRUE) Loading objects:\n  df_GlobalPatterns\n  df_dietswap\n  df_caporaso\n  df_kostic_crc\n  ps_GlobalPatterns\n  ps_dietswap\n  ps_caporaso\n  ps_kostic_crc"},{"path":"data-tarnsformation.html","id":"raw-abundance","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.2 Raw Abundance","text":"","code":"\nps_raw <- ps_dietswap\notu_table(ps_raw)[1:10, 1:10]OTU Table:          [10 taxa and 10 samples]\n                     taxa are rows\n                                  Sample-1 Sample-2 Sample-3 Sample-4 Sample-5\nActinomycetaceae                         0        1        0        1        0\nAerococcus                               0        0        0        0        0\nAeromonas                                0        0        0        0        0\nAkkermansia                             18       97       67      256       21\nAlcaligenes faecalis et rel.             1        2        3        2        2\nAllistipes et rel.                     336       63       36       96       49\nAnaerobiospirillum                       0        0        0        0        0\nAnaerofustis                             0        1        0        0        0\nAnaerostipes caccae et rel.            244      137       27       36       23\nAnaerotruncus colihominis et rel.       12      108      203       68       15\n                                  Sample-6 Sample-7 Sample-8 Sample-9 Sample-10\nActinomycetaceae                         0        0        0        0         0\nAerococcus                               0        0        0        0         0\nAeromonas                                0        0        0        0         0\nAkkermansia                             16       26       30       19       125\nAlcaligenes faecalis et rel.             2        2        2        2         7\nAllistipes et rel.                      17       47       49       14        31\nAnaerobiospirillum                       0        0        0        0         0\nAnaerofustis                             0        0        0        0         0\nAnaerostipes caccae et rel.             29       58       49       23        29\nAnaerotruncus colihominis et rel.       36       31       40       19       720"},{"path":"data-tarnsformation.html","id":"no-transformation","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.3 No Transformation","text":"Similar raw abundance","code":"\n(ps_identity <- microbiome::transform(ps_raw, 'identity'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_identity)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                             Sample-1 Sample-2 Sample-3\nActinomycetaceae                    0        1        0\nAerococcus                          0        0        0\nAeromonas                           0        0        0\nAkkermansia                        18       97       67\nAlcaligenes faecalis et rel.        1        2        3"},{"path":"data-tarnsformation.html","id":"relative-abundance","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.4 Relative abundance","text":"","code":"\n(ps_rel = phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)}))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\notu_table(ps_rel)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                                 Sample-1     Sample-2     Sample-3\nActinomycetaceae             0.0000000000 4.742483e-05 0.0000000000\nAerococcus                   0.0000000000 0.000000e+00 0.0000000000\nAeromonas                    0.0000000000 0.000000e+00 0.0000000000\nAkkermansia                  0.0021279111 4.600209e-03 0.0023197036\nAlcaligenes faecalis et rel. 0.0001182173 9.484966e-05 0.0001038673"},{"path":"data-tarnsformation.html","id":"arc-sine-asin-transformation","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.5 Arc sine (asin) transformation","text":"Typically used dealing proportional percentages.Proportionals range 0 1Percentages range 0 100The Metaphlan3 relative abundances percentages! means column totals 100.","code":"\nx = otu_table(ps_rel)\ny <- x/max(x)\n\nps_asin <- round(asin(sqrt(y)), 6)\n\nps_asin <- as.matrix(ps_asin)\nps_asin[1:5, 1:4]OTU Table:          [5 taxa and 4 samples]\n                     taxa are rows\n                             Sample-1 Sample-2 Sample-3 Sample-4\nActinomycetaceae             0.000000 0.007848 0.000000 0.009903\nAerococcus                   0.000000 0.000000 0.000000 0.000000\nAeromonas                    0.000000 0.000000 0.000000 0.000000\nAkkermansia                  0.052595 0.077374 0.054917 0.159111\nAlcaligenes faecalis et rel. 0.012391 0.011099 0.011615 0.014005"},{"path":"data-tarnsformation.html","id":"compositional-version","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.6 Compositional Version","text":"Compositional data represents relative proportions percentages different microbial taxa within sample, rather absolute abundance taxon. transformation necessary raw abundance data typically affected various factors, sequencing depth, can lead spurious correlations biases downstream analyses.","code":"\n(ps_compositional <- microbiome::transform(ps_raw, 'compositional'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_compositional)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                                 Sample-1     Sample-2     Sample-3\nActinomycetaceae             0.0000000000 4.742483e-05 0.0000000000\nAerococcus                   0.0000000000 0.000000e+00 0.0000000000\nAeromonas                    0.0000000000 0.000000e+00 0.0000000000\nAkkermansia                  0.0021279111 4.600209e-03 0.0023197036\nAlcaligenes faecalis et rel. 0.0001182173 9.484966e-05 0.0001038673"},{"path":"data-tarnsformation.html","id":"z-transform-for-otus","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.7 Z-transform for OTUs","text":"","code":"\n(ps_z_otu <- microbiome::transform(ps_raw, 'Z', 'OTU'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_z_otu)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                                Sample-1    Sample-2    Sample-3\nActinomycetaceae             -0.27806481  3.58008443 -0.27806481\nAerococcus                    0.00000000  0.00000000  0.00000000\nAeromonas                    -0.09513127 -0.09513127 -0.09513127\nAkkermansia                  -0.73331670  0.65311419  0.34425962\nAlcaligenes faecalis et rel. -0.93076516 -0.44189484 -0.09503583"},{"path":"data-tarnsformation.html","id":"z-transform-for-samples","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.8 Z-transform for Samples","text":"","code":"\n(ps_z_sample <- microbiome::transform(ps_raw, 'Z', 'sample'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_z_sample)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                               Sample-1   Sample-2   Sample-3\nActinomycetaceae             -1.1517915 -0.8924188 -1.1804675\nAerococcus                   -1.1517915 -1.2167251 -1.1804675\nAeromonas                    -1.1517915 -1.2167251 -1.1804675\nAkkermansia                   0.4182158  0.9284674  0.7203872\nAlcaligenes faecalis et rel. -0.7821978 -0.7027117 -0.5559529"},{"path":"data-tarnsformation.html","id":"log10-transform","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.9 Log10 Transform","text":"","code":"\n(ps_log10 <- microbiome::transform(ps_raw, 'log10'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_log10)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                             Sample-1  Sample-2 Sample-3\nActinomycetaceae             0.000000 0.3010300 0.000000\nAerococcus                   0.000000 0.0000000 0.000000\nAeromonas                    0.000000 0.0000000 0.000000\nAkkermansia                  1.278754 1.9912261 1.832509\nAlcaligenes faecalis et rel. 0.301030 0.4771213 0.602060"},{"path":"data-tarnsformation.html","id":"log10p-transform","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.10 Log10p Transform","text":"","code":"\n(ps_log10p <- microbiome::transform(ps_raw, 'log10p'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_log10p)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                             Sample-1  Sample-2 Sample-3\nActinomycetaceae             0.000000 0.3010300 0.000000\nAerococcus                   0.000000 0.0000000 0.000000\nAeromonas                    0.000000 0.0000000 0.000000\nAkkermansia                  1.278754 1.9912261 1.832509\nAlcaligenes faecalis et rel. 0.301030 0.4771213 0.602060"},{"path":"data-tarnsformation.html","id":"clr-transform","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.11 CLR Transform","text":"Note small pseudocount added data contains zeroes","code":"\n(ps_clr <- microbiome::transform(ps_raw, 'clr'))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_clr)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                              Sample-1  Sample-2  Sample-3\nActinomycetaceae             -3.555474 -2.040486 -3.114983\nAerococcus                   -3.555474 -3.359449 -3.114983\nAeromonas                    -3.555474 -3.359449 -3.114983\nAkkermansia                   1.264169  2.226809  1.790291\nAlcaligenes faecalis et rel. -1.497647 -1.490870 -1.169073"},{"path":"data-tarnsformation.html","id":"shift-the-baseline","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.12 Shift the baseline","text":"","code":"\n(ps_shift <- microbiome::transform(ps_raw, 'shift', shift=1))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_shift)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                             Sample-1 Sample-2 Sample-3\nActinomycetaceae                    1        2        1\nAerococcus                          1        1        1\nAeromonas                           1        1        1\nAkkermansia                        19       98       68\nAlcaligenes faecalis et rel.        2        3        4"},{"path":"data-tarnsformation.html","id":"data-scaling","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.13 Data Scaling","text":"","code":"\n(ps_scale <- microbiome::transform(ps_raw, 'scale', scale=1))phyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\ncat(\"\\n\\n\")\notu_table(ps_scale)[1:5, 1:3]OTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                             Sample-1 Sample-2 Sample-3\nActinomycetaceae                    0        1        0\nAerococcus                          0        0        0\nAeromonas                           0        0        0\nAkkermansia                        18       97       67\nAlcaligenes faecalis et rel.        1        2        3"},{"path":"data-tarnsformation.html","id":"save-transformed-objects","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.14 Save transformed objects","text":"","code":"\nsave(\n  ps_asin, \n  ps_identity,\n  ps_compositional, \n  ps_z_otu, \n  ps_z_sample, \n  ps_log10, \n  ps_log10p, \n  ps_clr, \n  ps_shift, \n  ps_scale, \n  file = \"data/ps_transformed.rda\")"},{"path":"data-tarnsformation.html","id":"confirm-saved-object","chapter":"5 Data Tranformation from Phyloseq Objects","heading":"5.15 Confirm saved object","text":"","code":"\nload(\"data/ps_transformed.rda\", verbose = TRUE)Loading objects:\n  ps_asin\n  ps_identity\n  ps_compositional\n  ps_z_otu\n  ps_z_sample\n  ps_log10\n  ps_log10p\n  ps_clr\n  ps_shift\n  ps_scale"},{"path":"data-reduction.html","id":"data-reduction","chapter":"6 Dimensionality Reduction","heading":"6 Dimensionality Reduction","text":"Data dimensional reduction crucial step microbiome analysis, aimed reducing complexity datasets retaining important information. section, ’ll explore techniques reducing number features variables phyloseq object, allowing efficient analysis visualization microbial community data.","code":""},{"path":"data-reduction.html","id":"prerequisite","chapter":"6 Dimensionality Reduction","heading":"6.1 Prerequisite","text":"Preprocessed R objectsPreprocessed phyloseq objectsEither R phyloseq objects can used input data.","code":""},{"path":"data-reduction.html","id":"import-libraries-and-data-objects","chapter":"6 Dimensionality Reduction","heading":"6.2 Import libraries and data objects","text":"","code":"\nset.seed(110912)\n\nlibrary(tidyverse, suppressPackageStartupMessages())\nlibrary(phyloseq)\nlibrary(microbiome)\n\ncat(\"\\nSaved phyloseq objects and dataframes\\n\\n\")\nSaved phyloseq objects and dataframes\nload(\"../imap-data-preparation/data/external/external_ps_objects.rda\", verbose = T)Loading objects:\n  df_GlobalPatterns\n  df_dietswap\n  df_caporaso\n  df_kostic_crc\n  ps_GlobalPatterns\n  ps_dietswap\n  ps_caporaso\n  ps_kostic_crc\nlibrary(phyloseq)\nlibrary(microbiome)\n\nps_raw <- ps_dietswap\nps_rawphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]"},{"path":"imap-github-repos.html","id":"imap-github-repos","chapter":"A IMAP GitHub Repos","heading":"A IMAP GitHub Repos","text":"","code":""},{"path":"data-preparation-rulegraph.html","id":"data-preparation-rulegraph","chapter":"B Data Preparation Rulegraph","heading":"B Data Preparation Rulegraph","text":"","code":""},{"path":"session-information.html","id":"session-information","chapter":"C Session Information","heading":"C Session Information","text":"Reproducibility relies ability precisely recreate working environment, session information serves vital reference achieve consistency. record details R environment, package versions, system settings computing environment time analysis.","code":"\nlibrary(sessioninfo)\n\n# Get session info\ninfo <- capture.output(print(session_info()))\n\n# Define patterns to exclude\nexclude_patterns <- c(\"/Users/.*\", \"Africa/Dar_es_Salaam\") # This line is location-dependent\n\n# Exclude lines containing specific information\ninfo_filtered <- info[!grepl(paste(exclude_patterns, collapse = \"|\"), info)]\n\n# Save the filtered session info to a text file in the root directory without line numbers\ncat(info_filtered, file = \"session_info.txt\", sep = \"\\n\")"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
