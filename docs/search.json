[{"path":"index.html","id":"data-preparation","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"IMAP-Part 07: Microbiome Data Preparation Guide","text":"","code":""},{"path":"index.html","id":"welcome-to-imap-chapter-07","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Welcome to IMAP chapter 07","text":"Microbiome research employs high-throughput sequencing explore microbial communities across diverse environments. project focuses preparing visualizing microbiome data generated Mothur QIIME2 pipelines. dataset comprises OTU table, taxonomic assignments, metadata. comprehensive guide tailored researchers analysts engaged microbiome studies, providing essential insights methodologies adequate data preparation. Assuming bioinformatics analysis phase successfully completed now possess output features tables, including Operational Taxonomic Unit (OTU) tables, taxonomy tables, metadata table, platforms Mothur QIIME2, guide lead crucial steps refining optimizing microbiome data.","code":""},{"path":"index.html","id":"what-to-expect","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"What to Expect","text":"diving details, let’s take look can expect guide:Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring seamless follow-.Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring seamless follow-.Best Practices: Discover best practices data cleaning, transformation, integration, emphasizing optimization microbiome datasets robust analysis.Best Practices: Discover best practices data cleaning, transformation, integration, emphasizing optimization microbiome datasets robust analysis.Practical Insights: Beyond technical instructions, guide offers practical insights navigate nuanced decisions data preparation, empowering informed choices aligned research goals.Practical Insights: Beyond technical instructions, guide offers practical insights navigate nuanced decisions data preparation, empowering informed choices aligned research goals.Whether ’re venturing microbial communities first time seeking advanced strategies refine microbiome data, guide companion. commitment data preparation pivotal extracting meaningful biological insights contributing advancement microbiome research.Let’s dive !","code":""},{"path":"preface.html","id":"preface","chapter":"Preparing for Downstream Analysis","heading":"Preparing for Downstream Analysis","text":"foundation downstream analyses, effective data preparation essential extracting meaningful biological insights. guide addresses technical aspects data cleaning, transformation, integration also offers practical insights guide researchers nuanced decisions involved optimizing microbiome datasets.","code":""},{"path":"preface.html","id":"why-data-preparation-matters","chapter":"Preparing for Downstream Analysis","heading":"Why Data Preparation Matters","text":"Microbiome analysis relies heavily quality integrity data. researchers analysts, meticulous process data preparation crucial guaranteeing reliability downstream analyses accuracy biological interpretations. guide acknowledges diverse skill levels readers, catering novice researchers seeking foundational knowledge experienced analysts search advanced strategies.","code":""},{"path":"preface.html","id":"using-otu-and-taxonomy-tables","chapter":"Preparing for Downstream Analysis","heading":"Using OTU and Taxonomy Tables","text":"chapter, explore practical utilization Operational Taxonomic Unit (OTU) tables taxonomy tables essential inputs downstream analysis. Derived bioinformatics phase, tables play pivotal roles investigating composition diversity microbial communities. gain insights effectively cleaning, transforming, integrating tables prepare variety downstream analyses.","code":""},{"path":"preface.html","id":"integrating-metadata-for-context","chapter":"Preparing for Downstream Analysis","heading":"Integrating Metadata for Context","text":"integration metadata table enhances analytical capabilities facilitating grouping observations based relevant variables. integration contextualizes microbiome data also enables exploration impact different conditions factors microbial community composition. guide demonstrates seamless incorporation metadata, unlocking valuable insights relationships microbial communities external variables.","code":""},{"path":"data-tidying.html","id":"data-tidying","chapter":"1 Data Tidying","heading":"1 Data Tidying","text":"","code":""},{"path":"data-tidying.html","id":"general-snakemake-workflow","chapter":"1 Data Tidying","heading":"1.1 General snakemake workflow","text":"tentative snakemake workflow defines data processing rules DAG (directed acyclic graph) format.\ndetailed interactive snakemake HTML report available . Use wider screen get better interactive snakemake report.","code":""},{"path":"data-tidying.html","id":"data-tidying-1","chapter":"1 Data Tidying","heading":"1.2 Data Tidying","text":"Requires:Sample metadataOTU tables mothur qiime2 pipelines.Taxonomy tables mothur qiime2 pipelines.","code":""},{"path":"data-tidying.html","id":"microbiome-composite-r-objects","chapter":"1 Data Tidying","heading":"1.3 Microbiome composite R objects","text":"Requires:Tidy sample metadata.Tidy OTU tables.Tidy taxonomy tables.mothur qiime2 composite objects long-format suitable types data visualization.","code":""},{"path":"data-tidying.html","id":"microbioma-phyloseq-objects","chapter":"1 Data Tidying","heading":"1.4 Microbioma phyloseq objects","text":"Requires:phyloseq packageTidy sample metadata.Tidy OTU tables.Tidy taxonomy tables.","code":""},{"path":"data-tidying.html","id":"data-transformation","chapter":"1 Data Tidying","heading":"1.5 Data transformation","text":"Requires:phyloseq packageA microbiome packagePhyloseq objectsData transformation intended converting values ready--use matrices.\ndifferent methods , just :transformation similar raw abundance.Compositional version relative abundance.Arc sine (asin) transformation.Z-transform OTUs.Z-transform Samples.Log10 transformation.Log10p transformation,CLR transformation.Shift baseline.Data Scaling.","code":""},{"path":"data-tidying.html","id":"data-reduction","chapter":"1 Data Tidying","heading":"1.6 Data reduction","text":"Dimensionality reduction intended reduce dimension variables keeping much variation possible. , includes:Linear methods (commonly used microbiome data analysis)\nPCA (Principal Component Analysis)\nFactor Analysis\nLDA (Linear Discriminant Analysis)\n.\nPCA (Principal Component Analysis)Factor AnalysisLDA (Linear Discriminant Analysis).Non-linear methods","code":""},{"path":"prepare-mothur-output.html","id":"prepare-mothur-output","chapter":"2 Prepare Mothur Output","heading":"2 Prepare Mothur Output","text":"completing Mothur bioinformatics pipeline, next step involves preparing Mothur output analysis. typically includes organizing formatting output data files generated Mothur suitable format downstream analysis. preparation step crucial ensuring data appropriately structured compatible statistical analysis visualization tools used subsequent analyses.","code":""},{"path":"prepare-mothur-output.html","id":"creating-data-directories","chapter":"2 Prepare Mothur Output","heading":"2.1 Creating data directories","text":"Data directories folders directories data files stored. Organizing data directories helps maintain structured manageable workflow, making easier locate access specific files analysis. Properly organizing data directories essential ensuring efficient data management reproducibility bioinformatics analyses.","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/mothur')) {dir.create('data/mothur')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())"},{"path":"prepare-mothur-output.html","id":"mothur-metadata","chapter":"2 Prepare Mothur Output","heading":"2.2 Mothur metadata","text":"Mothur metadata contains essential information samples processed Mothur bioinformatics pipeline. metadata typically includes details sample identifiers, experimental conditions, relevant metadata associated sample.","code":"\nread_tsv(\"data/mothur/mothur_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  write_csv(\"data/mothur/mothur_tidy_metadata.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-otutable","chapter":"2 Prepare Mothur Output","heading":"2.3 Mothur otutable","text":"Mothur OTU (Operational Taxonomic Unit) table provides comprehensive summary microbial community composition across different samples Mothur pipeline. lists abundance occurrence OTU sample, allowing comparisons microbial community structure diversity samples.","code":"\nread_tsv(\"../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.shared\", skip = 0, show_col_types = FALSE) %>%\n  dplyr::rename(group=\"Group\") %>% \n  dplyr::select(-c(label, numASVs)) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-group, names_to = \"OTU\", values_to = \"count\") %>% \n  write_csv(\"data/mothur/mothur_tidy_otutable.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-taxonomy","chapter":"2 Prepare Mothur Output","heading":"2.4 Mothur taxonomy","text":"Mothur taxonomy file assigns taxonomic classifications OTU identified microbial community Mothur. file provides information taxonomic identity OTU, often various taxonomic levels phylum, class, order, family, genus, species.","code":"\nread_tsv(\"../imap-mothur-bioinformatics/mothur_process/asv_analysis/final.asv.ASV.cons.taxonomy\", show_col_types=FALSE) %>% \n  distinct() %>%\n  dplyr::select(-Size) %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxonomy = gsub(\"\\\\(100\\\\)\", \"\", Taxonomy)) %>%  \n  separate(Taxonomy, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/mothur/mothur_tidy_taxonomy.csv\")"},{"path":"prepare-mothur-output.html","id":"mothur-composite-object","chapter":"2 Prepare Mothur Output","heading":"2.5 Mothur Composite Object","text":"Mothur, creating composite object involves combining metadata, OTU table, taxonomy single cohesive entity. composite object consolidates relevant information microbial community samples processed Mothur pipeline, facilitating seamless downstream analysis.","code":"\n# Mothur composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nmothur_tidy_metadata <- read_csv(\"data/mothur/mothur_tidy_metadata.csv\", show_col_types = FALSE)\nmothur_tidy_otutable <- read_csv(\"data/mothur/mothur_tidy_otutable.csv\", show_col_types = FALSE)\nmothur_tidy_taxonomy <- read_csv(\"data/mothur/mothur_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nmothur_composite <- inner_join(mothur_tidy_metadata, mothur_tidy_otutable, by = \"group\") %>% \n  inner_join(., mothur_tidy_taxonomy, by = \"OTU\") %>% \n  group_by(group) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(mothur_composite, \"data/mothur/mothur_composite.csv\")"},{"path":"prepare-qiime2-output.html","id":"prepare-qiime2-output","chapter":"3 Prepare Qiime2 Output","heading":"3 Prepare Qiime2 Output","text":"completing QIIME2 bioinformatics pipeline, next step involves preparing QIIME2 output analysis. typically includes organizing formatting output data files generated QIIME2 suitable format downstream analysis. preparation step crucial ensuring data appropriately structured compatible statistical analysis visualization tools used subsequent analyses.","code":""},{"path":"prepare-qiime2-output.html","id":"data-directories","chapter":"3 Prepare Qiime2 Output","heading":"3.1 Data directories","text":"Data directories folders directories data files stored.","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/qiime2')) {dir.create('data/qiime2')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())"},{"path":"prepare-qiime2-output.html","id":"qiime2-metadata","chapter":"3 Prepare Qiime2 Output","heading":"3.2 QIIME2 Metadata","text":"QIIME2 metadata contains essential information samples processed QIIME2 bioinformatics pipeline. Similar Mothur, metadata includes details sample identifiers, experimental conditions, relevant metadata associated sample.","code":"\nlibrary(dplyr)\n\nread_tsv(\"../imap-qiime2-bioinformatics/resources/metadata/qiime2_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  dplyr::rename(sample_id=\"sample-id\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_metadata.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-feature-table","chapter":"3 Prepare Qiime2 Output","heading":"3.3 QIIME2 Feature Table","text":"QIIME2, Feature Table serves similar purpose OTU table Mothur. provides comprehensive summary microbial community composition across different samples. However, QIIME2, term “Feature” used instead “OTU” represent unique sequences entities identified microbial community.","code":"\nlibrary(dplyr)\n\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/feature-table.tsv\", skip = 1, show_col_types = FALSE) %>%\n  dplyr::rename(feature='#OTU ID') %>%\n  select(-starts_with('Mock')) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-feature, names_to = \"sample_id\", values_to = \"count\") %>% \n  relocate(sample_id, .before = feature) %>% \n  write_csv(\"data/qiime2/qiime2_tidy_otutable.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-taxonomy","chapter":"3 Prepare Qiime2 Output","heading":"3.4 QIIME2 Taxonomy","text":"Similar Mothur, QIIME2 taxonomy file assigns taxonomic classifications Feature identified microbial community. file provides information taxonomic identity Feature, often various taxonomic levels phylum, class, order, family, genus, species.","code":"\nlibrary(dplyr)\n\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/taxonomy.tsv\", show_col_types=FALSE) %>% \n  dplyr::rename(feature=\"Feature ID\") %>% \n  distinct() %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxon = str_replace_all(Taxon, \"; s__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; g__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; f__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; o__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; c__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; p__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; k__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\[|\\\\]\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\s\", \"\")) %>%\n  dplyr::filter(!grepl(\"s__*\", Taxon)) %>%\n  dplyr::filter(grepl(\"g__*\", Taxon)) %>% \n  select(-Confidence) %>% \n  mutate(Taxon = str_replace_all(Taxon, \"\\\\w__\", \"\")) %>% \n  separate(Taxon, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\")"},{"path":"prepare-qiime2-output.html","id":"qiime2-composite-object","chapter":"3 Prepare Qiime2 Output","heading":"3.5 QIIME2 Composite Object","text":"Similarly, QIIME2, essential integrate metadata, Feature table (equivalent OTU table Mothur), taxonomy unified composite object. composite object encapsulates pertinent details microbial community samples analyzed using QIIME2 pipeline, streamlining subsequent analytical workflows.","code":"\n# QIIME2 composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nqiime2_tidy_metadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\", show_col_types = FALSE)\nqiime2_tidy_otutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\", show_col_types = FALSE)\nqiime2_tidy_taxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nqiime2_composite <- inner_join(qiime2_tidy_metadata, qiime2_tidy_otutable, by = \"sample_id\") %>% \n  inner_join(., qiime2_tidy_taxonomy, by = \"feature\") %>% \n  group_by(sample_id) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(qiime2_composite, \"data/qiime2/qiime2_composite.csv\")"},{"path":"creating-phyloseq-objects.html","id":"creating-phyloseq-objects","chapter":"4 Creating phyloseq Objects","heading":"4 Creating phyloseq Objects","text":"section, demonstrate create phyloseq objects organize structure microbiome data analysis. objects serve foundation downstream analyses visualization.","code":""},{"path":"creating-phyloseq-objects.html","id":"from-mothur-output","chapter":"4 Creating phyloseq Objects","heading":"4.1 From mothur output","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ape)\n\nmetadata <- read_csv(\"data/mothur/mothur_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"group\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/mothur/mothur_tidy_otutable.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = group, names_from = OTU, values_from = count) %>% \n  tibble::column_to_rownames(\"group\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/mothur/mothur_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"OTU\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nmt_ps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nmt_ps_tree = rtree(ntaxa(mt_ps_raw_basic), rooted=TRUE, tip.label=taxa_names(mt_ps_raw_basic))\n\nmt_ps_raw <- phyloseq::merge_phyloseq(mt_ps_raw_basic, mt_ps_tree)\n\nmt_ps_rel <- phyloseq::transform_sample_counts(mt_ps_raw, function(x){x / sum(x)})\n\nmt_ps_df_raw <- psmelt(mt_ps_raw)\n\nmt_ps_df_rel <- psmelt(mt_ps_raw)\n\nsave(mt_ps_tree, mt_ps_raw, mt_ps_rel, mt_ps_df_raw, mt_ps_df_rel, file = \"data/mothur_phyloseq_objects.rda\")"},{"path":"creating-phyloseq-objects.html","id":"review-the-mothur-phyloseq-object","chapter":"4 Creating phyloseq Objects","heading":"4.1.1 Review the Mothur phyloseq object","text":"","code":"mt_ps_raw\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 920 taxa and 10 samples ]\nsample_data() Sample Data:       [ 10 samples by 2 sample variables ]\ntax_table()   Taxonomy Table:    [ 920 taxa by 6 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 920 tips and 919 internal nodes ]"},{"path":"creating-phyloseq-objects.html","id":"from-qiime2-output","chapter":"4 Creating phyloseq Objects","heading":"4.2 From QIIME2 output","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(ape)\n\nmetadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = sample_id, names_from = feature, values_from = count) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"feature\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nq2_ps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nq2_ps_tree = rtree(ntaxa(q2_ps_raw_basic), rooted=TRUE, tip.label=taxa_names(q2_ps_raw_basic))\n\nq2_ps_raw <- phyloseq::merge_phyloseq(q2_ps_raw_basic, q2_ps_tree)\n\nq2_ps_rel <- phyloseq::transform_sample_counts(q2_ps_raw, function(x){x / sum(x)})\n\nq2_ps_df_raw <- psmelt(q2_ps_raw)\n\nq2_ps_df_rel <- psmelt(q2_ps_raw)\n\nsave(q2_ps_tree, q2_ps_raw, q2_ps_rel, q2_ps_df_raw, q2_ps_df_rel, file = \"data/qiime2_phyloseq_objects.rda\")"},{"path":"creating-phyloseq-objects.html","id":"review-the-qiime2-phyloseq-object","chapter":"4 Creating phyloseq Objects","heading":"4.3 Review the QIIME2 phyloseq object","text":"","code":"q2_ps_raw\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 95 taxa and 128 samples ]\nsample_data() Sample Data:       [ 128 samples by 12 sample variables ]\ntax_table()   Taxonomy Table:    [ 95 taxa by 6 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 95 tips and 94 internal nodes ]"},{"path":"phyloseq-objects-demo-datasets.html","id":"phyloseq-objects-demo-datasets","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5 Phyloseq Objects Demo Datasets","text":"section, utilize publicly available real-world datasets demonstrate functionality analysis workflows phyloseq objects. datasets serve valuable resources researchers seeking reproduce validate analyses using similar microbiome data. leveraging demo datasets, aim enhance reproducibility accessibility microbiome research analysis.","code":""},{"path":"phyloseq-objects-demo-datasets.html","id":"the-globalpatterns-dataset","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5.1 The GlobalPatterns dataset","text":"GlobalPatterns dataset, sourced Earth Microbiome Project (EMP), serves comprehensive repository studying microbial communities worldwide. ’s breakdown key attributes:Source: GlobalPatterns originates Earth Microbiome Project (EMP), collecting samples worldwide.Source: GlobalPatterns originates Earth Microbiome Project (EMP), collecting samples worldwide.Composition: comprises high-throughput sequencing data, revealing taxonomic composition microbial communities.Composition: comprises high-throughput sequencing data, revealing taxonomic composition microbial communities.Scope: Samples represent diverse global ecosystems, offering comprehensive view microbial biodiversity.Scope: Samples represent diverse global ecosystems, offering comprehensive view microbial biodiversity.Format: Presented phyloseq object R, integrates sample metadata taxonomic abundance analysis.Format: Presented phyloseq object R, integrates sample metadata taxonomic abundance analysis.Utility: Researchers utilize community profiling, abundance testing, ecological modeling, enhancing understanding global microbial diversity function.Utility: Researchers utilize community profiling, abundance testing, ecological modeling, enhancing understanding global microbial diversity function.GlobalPatterns phyloseq-classColumns GlobalPatterns dataset","code":"\nlibrary(phyloseq) # for GlobalPatterns dataset\ndata(\"GlobalPatterns\")\n\nps_GlobalPatterns <-GlobalPatterns\ndf_GlobalPatterns <-GlobalPatterns %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  rename_all(tolower)ps_GlobalPatterns\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 19216 taxa and 26 samples ]\nsample_data() Sample Data:       [ 26 samples by 7 sample variables ]\ntax_table()   Taxonomy Table:    [ 19216 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 19216 tips and 19215 internal nodes ]colnames(df_GlobalPatterns)\n [1] \"sample_id\"                \"otu\"                     \n [3] \"sample\"                   \"abundance\"               \n [5] \"x.sampleid\"               \"primer\"                  \n [7] \"final_barcode\"            \"barcode_truncated_plus_t\"\n [9] \"barcode_full_length\"      \"sampletype\"              \n[11] \"description\"              \"kingdom\"                 \n[13] \"phylum\"                   \"class\"                   \n[15] \"order\"                    \"family\"                  \n[17] \"genus\"                    \"species\"                 \ncat(\"\\n\")"},{"path":"phyloseq-objects-demo-datasets.html","id":"the-dietswap-dataset","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5.2 The dietswap dataset","text":"dietswap dataset, available microbiome R package, offers valuable insights effects dietary interventions microbial communities. ’s overview attributes:Source: dietswap dataset derived research examining impact dietary changes human gut microbiome.Source: dietswap dataset derived research examining impact dietary changes human gut microbiome.Composition: comprises high-throughput sequencing data, providing insights taxonomic composition dynamics microbial communities response dietary alterations.Composition: comprises high-throughput sequencing data, providing insights taxonomic composition dynamics microbial communities response dietary alterations.Scope: Samples obtained human participants undergoing dietary interventions, enabling researchers explore different diets influence microbial diversity function within gut microbiome.Scope: Samples obtained human participants undergoing dietary interventions, enabling researchers explore different diets influence microbial diversity function within gut microbiome.Format: Presented format suitable microbiome analysis, dataset includes sample metadata taxonomic abundance data, facilitating comprehensive analyses microbial community dynamics.Format: Presented format suitable microbiome analysis, dataset includes sample metadata taxonomic abundance data, facilitating comprehensive analyses microbial community dynamics.Utility: Researchers utilize dietswap dataset investigate effects dietary interventions gut microbiome composition, contributing better understanding intricate interactions diet, host physiology, microbial ecology.Utility: Researchers utilize dietswap dataset investigate effects dietary interventions gut microbiome composition, contributing better understanding intricate interactions diet, host physiology, microbial ecology.Note: dietswap missing phylo_tree slot, can construct add like :Dietswap phyloseq-classColumns Dietswap dataset","code":"library(microbiome) # for dietswap dataset\ndata(\"dietswap\")\n\ndietswap\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\nlibrary(microbiome)\ndata('dietswap')\nps_raw_basic <- dietswap\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\nps_dietswap <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\ndf_dietswap <-ps_dietswap %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  dplyr::select(-9) %>% \n  rename_all(tolower)ps_dietswap\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 130 tips and 129 internal nodes ]colnames(df_dietswap)\n [1] \"sample_id\"              \"otu\"                    \"sample\"                \n [4] \"abundance\"              \"subject\"                \"sex\"                   \n [7] \"nationality\"            \"group\"                  \"timepoint\"             \n[10] \"timepoint.within.group\" \"bmi_group\"              \"phylum\"                \n[13] \"family\"                 \"genus\"                 "},{"path":"phyloseq-objects-demo-datasets.html","id":"caporaso-dataset","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5.3 Caporaso dataset","text":"Caporaso dataset provides valuable insights microbial marker genes associations various biological factors.Source: Caporaso dataset included microbiomeMarker R package derived research led Dr. J. Gregory Caporaso. aims provide insights microbial marker genes associations various biological factors.Source: Caporaso dataset included microbiomeMarker R package derived research led Dr. J. Gregory Caporaso. aims provide insights microbial marker genes associations various biological factors.Composition: dataset comprises high-throughput sequencing data, focusing microbial marker genes diverse biological samples. offers valuable information regarding taxonomic composition functional potential microbial communities.Composition: dataset comprises high-throughput sequencing data, focusing microbial marker genes diverse biological samples. offers valuable information regarding taxonomic composition functional potential microbial communities.Scope: Samples collected range environments, including limited human microbiomes, environmental samples, animal microbiomes. diversity allows researchers explore microbial diversity across different ecosystems conditions.Scope: Samples collected range environments, including limited human microbiomes, environmental samples, animal microbiomes. diversity allows researchers explore microbial diversity across different ecosystems conditions.Format: dataset structured facilitate microbiome marker analysis, sample metadata taxonomic abundance data included. format enables researchers conduct comprehensive analyses microbial marker genes associations environmental biological factors.Format: dataset structured facilitate microbiome marker analysis, sample metadata taxonomic abundance data included. format enables researchers conduct comprehensive analyses microbial marker genes associations environmental biological factors.Utility: Researchers utilize Caporaso dataset investigate microbial marker genes’ roles various ecosystems, host-microbiome interactions, environmental responses, disease states. dataset contributes better understanding microbial ecology implications human health environmental management.Utility: Researchers utilize Caporaso dataset investigate microbial marker genes’ roles various ecosystems, host-microbiome interactions, environmental responses, disease states. dataset contributes better understanding microbial ecology implications human health environmental management.Caporaso phyloseq-classColumns Caporaso dataset","code":"\nlibrary(microbiomeMarker) # for caporaso dataset\ndata(\"caporaso\")\n\nps_caporaso <-caporaso\ndf_caporaso <-caporaso %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  rename_all(tolower)ps_caporaso\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 3426 taxa and 34 samples ]\nsample_data() Sample Data:       [ 34 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 3426 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 3426 tips and 3424 internal nodes ]colnames(df_caporaso)\n [1] \"sample_id\"                \"otu\"                     \n [3] \"sample\"                   \"abundance\"               \n [5] \"sampletype\"               \"year\"                    \n [7] \"month\"                    \"day\"                     \n [9] \"subject\"                  \"reportedantibioticusage\" \n[11] \"dayssinceexperimentstart\" \"description\"             \n[13] \"kingdom\"                  \"phylum\"                  \n[15] \"class\"                    \"order\"                   \n[17] \"family\"                   \"genus\"                   \n[19] \"species\"                 "},{"path":"phyloseq-objects-demo-datasets.html","id":"kostic_crc-dataset","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5.4 Kostic_CRC dataset","text":"Kostic_CRC dataset provides valuable insights gut microbiome individuals diagnosed colorectal cancer (CRC).Source: Kostic_CRC dataset included microbiomeMarker R package. derived research conducted Kostic Lab focuses investigating gut microbiome colorectal cancer (CRC) patients.Source: Kostic_CRC dataset included microbiomeMarker R package. derived research conducted Kostic Lab focuses investigating gut microbiome colorectal cancer (CRC) patients.Composition: dataset comprises high-throughput sequencing data, specifically targeting gut microbiome individuals colorectal cancer. provides insights taxonomic composition potential functional characteristics microbial communities associated CRC.Composition: dataset comprises high-throughput sequencing data, specifically targeting gut microbiome individuals colorectal cancer. provides insights taxonomic composition potential functional characteristics microbial communities associated CRC.Scope: Samples collected individuals diagnosed colorectal cancer, allowing researchers explore microbial diversity potential biomarkers associated CRC development progression.Scope: Samples collected individuals diagnosed colorectal cancer, allowing researchers explore microbial diversity potential biomarkers associated CRC development progression.Format: dataset structured facilitate microbiome marker analysis, including sample metadata taxonomic abundance data. format enables researchers conduct comprehensive analyses microbial community dynamics colorectal cancer.Format: dataset structured facilitate microbiome marker analysis, including sample metadata taxonomic abundance data. format enables researchers conduct comprehensive analyses microbial community dynamics colorectal cancer.Utility: Researchers utilize Kostic_CRC dataset investigate role gut microbiome colorectal cancer pathogenesis, prognosis, treatment response. dataset contributes deeper understanding complex interplay gut microbiome colorectal cancer biology, potentially leading novel diagnostic therapeutic strategies.Utility: Researchers utilize Kostic_CRC dataset investigate role gut microbiome colorectal cancer pathogenesis, prognosis, treatment response. dataset contributes deeper understanding complex interplay gut microbiome colorectal cancer biology, potentially leading novel diagnostic therapeutic strategies.Kostic_crc phyloseq-classColumns Kostic_crc dataset","code":"\nlibrary(microbiomeMarker) # for kostic_crc dataset\ndata(\"kostic_crc\")\n\nps_raw_basic <- kostic_crc\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\nps_kostic_crc <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\ndf_kostic_crc <-kostic_crc %>% \n  phyloseq::psmelt() %>% \n  tibble::rownames_to_column(\"sample_id\") %>% \n  rename_all(tolower)ps_kostic_crc\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 2505 taxa and 177 samples ]\nsample_data() Sample Data:       [ 177 samples by 71 sample variables ]\ntax_table()   Taxonomy Table:    [ 2505 taxa by 7 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 2505 tips and 2504 internal nodes ]colnames(df_kostic_crc)\n [1] \"sample_id\"                     \"otu\"                          \n [3] \"sample\"                        \"abundance\"                    \n [5] \"x.sampleid\"                    \"barcodesequence\"              \n [7] \"linkerprimersequence\"          \"necrosis_percent\"             \n [9] \"target_subfragment\"            \"assigned_from_geo\"            \n[11] \"experiment_center\"             \"title\"                        \n[13] \"run_prefix\"                    \"age\"                          \n[15] \"normal_equivalent_percent\"     \"fibroblast_and_vessel_percent\"\n[17] \"depth\"                         \"treatment\"                    \n[19] \"age_at_diagnosis\"              \"common_name\"                  \n[21] \"host_common_name\"              \"body_site\"                    \n[23] \"elevation\"                     \"reports_received\"             \n[25] \"cea\"                           \"pcr_primers\"                  \n[27] \"collection_date\"               \"altitude\"                     \n[29] \"env_biome\"                     \"sex\"                          \n[31] \"platform\"                      \"race\"                         \n[33] \"bsp_diagnosis\"                 \"study_center\"                 \n[35] \"country\"                       \"chemotherapy\"                 \n[37] \"year_of_death\"                 \"ethnicity\"                    \n[39] \"anonymized_name\"               \"taxon_id\"                     \n[41] \"sample_center\"                 \"samp_size\"                    \n[43] \"year_of_birth\"                 \"original_diagnosis\"           \n[45] \"age_unit\"                      \"study_id\"                     \n[47] \"experiment_design_description\" \"description_duplicate\"        \n[49] \"diagnosis\"                     \"body_habitat\"                 \n[51] \"sequencing_meth\"               \"run_date\"                     \n[53] \"histologic_grade\"              \"longitude\"                    \n[55] \"env_matter\"                    \"target_gene\"                  \n[57] \"env_feature\"                   \"key_seq\"                      \n[59] \"body_product\"                  \"tumor_percent\"                \n[61] \"library_construction_protocol\" \"region\"                       \n[63] \"run_center\"                    \"tumor_type\"                   \n[65] \"bsp_notes\"                     \"radiation_therapy\"            \n[67] \"inflammation_percent\"          \"host_subject_id\"              \n[69] \"pc3\"                           \"latitude\"                     \n[71] \"osh_diagnosis\"                 \"stage\"                        \n[73] \"primary_disease\"               \"host_taxid\"                   \n[75] \"description\"                   \"kingdom\"                      \n[77] \"phylum\"                        \"class\"                        \n[79] \"order\"                         \"family\"                       \n[81] \"genus\"                         \"species\"                      "},{"path":"phyloseq-objects-demo-datasets.html","id":"save_ps_objects","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5.5 Save objects for transformation and exploration","text":"","code":"\nsave(df_GlobalPatterns, \n     df_dietswap,  \n     df_caporaso,\n     df_kostic_crc,     \n     file = \"data/dataframe_objects.rda\")\n\nsave(ps_GlobalPatterns, \n     ps_dietswap,\n     ps_caporaso,\n     ps_kostic_crc,\n     file = \"data/phyloseq_objects.rda\")"},{"path":"phyloseq-objects-demo-datasets.html","id":"confirm-saved-objects","chapter":"5 Phyloseq Objects Demo Datasets","heading":"5.6 Confirm saved objects","text":"","code":"load(\"data/phyloseq_objects.rda\", verbose = TRUE)\nLoading objects:\n  ps_GlobalPatterns\n  ps_dietswap\n  ps_caporaso\n  ps_kostic_crc"},{"path":"reviewing-phyloseq-objects.html","id":"reviewing-phyloseq-objects","chapter":"6 Reviewing Phyloseq Objects","heading":"6 Reviewing Phyloseq Objects","text":"section, demonstrate basic functions reviewing exploring contents phyloseq objects. familiarizing functions, gain insights structure, composition, metadata associated phyloseq objects, facilitating effective analysis interpretation microbiome data.","code":"library(phyloseq)\nlibrary(ape)\n\nps <- ps_dietswap\nps\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 130 tips and 129 internal nodes ]"},{"path":"reviewing-phyloseq-objects.html","id":"taxonomy-rank-names","chapter":"6 Reviewing Phyloseq Objects","heading":"6.1 Taxonomy rank names","text":"","code":"rank_names(ps)\n[1] \"Phylum\" \"Family\" \"Genus\" "},{"path":"reviewing-phyloseq-objects.html","id":"number-of-taxa","chapter":"6 Reviewing Phyloseq Objects","heading":"6.2 Number of taxa","text":"","code":"ntaxa(ps)\n[1] 130"},{"path":"reviewing-phyloseq-objects.html","id":"split-by-taxon-name-e.g.-firmicutes","chapter":"6 Reviewing Phyloseq Objects","heading":"6.3 Split by taxon name, e.g. Firmicutes","text":"","code":"library(metagMisc) # foe phyloseq_sep_tax()\n\ntaxa_stats <- phyloseq_sep_tax(ps, TaxRank = \"Phylum\", drop_NA = FALSE)\ncat(\"\\n\")\ntaxa_stats$Firmicutes\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 76 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 76 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 76 tips and 75 internal nodes ]\ncat(\"\\n\")\ntaxa_stats$Bacteroidetes\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 16 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 16 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 16 tips and 15 internal nodes ]\ncat(\"\\n\")\ntaxa_stats$Actinobacteria\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 8 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 8 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 8 tips and 7 internal nodes ]"},{"path":"reviewing-phyloseq-objects.html","id":"number-of-samples","chapter":"6 Reviewing Phyloseq Objects","heading":"6.4 Number of samples","text":"","code":"nsamples(ps)\n[1] 222"},{"path":"reviewing-phyloseq-objects.html","id":"sample-names","chapter":"6 Reviewing Phyloseq Objects","heading":"6.5 Sample names","text":"","code":"head(sample_names(ps), 20)\n [1] \"Sample-1\"  \"Sample-2\"  \"Sample-3\"  \"Sample-4\"  \"Sample-5\"  \"Sample-6\" \n [7] \"Sample-7\"  \"Sample-8\"  \"Sample-9\"  \"Sample-10\" \"Sample-11\" \"Sample-12\"\n[13] \"Sample-13\" \"Sample-14\" \"Sample-15\" \"Sample-16\" \"Sample-17\" \"Sample-18\"\n[19] \"Sample-19\" \"Sample-20\""},{"path":"reviewing-phyloseq-objects.html","id":"sample-variables","chapter":"6 Reviewing Phyloseq Objects","heading":"6.6 Sample variables","text":"","code":"sample_variables(ps)\n[1] \"subject\"                \"sex\"                    \"nationality\"           \n[4] \"group\"                  \"sample\"                 \"timepoint\"             \n[7] \"timepoint.within.group\" \"bmi_group\"             "},{"path":"reviewing-phyloseq-objects.html","id":"abundance-table","chapter":"6 Reviewing Phyloseq Objects","heading":"6.7 Abundance table","text":"","code":"otu_table(ps)[1:5, 1:5]\nOTU Table:          [5 taxa and 5 samples]\n                     taxa are rows\n                                      Sample-1 Sample-2 Sample-3 Sample-4\nPhascolarctobacterium faecium et rel.        4        5       13        4\nActinomycetaceae                             0        1        0        1\nEubacterium hallii et rel.                  10      102       39       31\nClostridium stercorarium et rel.             6        3        9        8\nClostridium symbiosum et rel.              220      247      214      111\n                                      Sample-5\nPhascolarctobacterium faecium et rel.       33\nActinomycetaceae                             0\nEubacterium hallii et rel.                  28\nClostridium stercorarium et rel.             3\nClostridium symbiosum et rel.              155"},{"path":"reviewing-phyloseq-objects.html","id":"taxonomy-table","chapter":"6 Reviewing Phyloseq Objects","heading":"6.8 Taxonomy table","text":"","code":"tax_table(ps)[1:5, ]\nTaxonomy Table:     [5 taxa by 3 taxonomic ranks]:\n                                      Phylum          \nPhascolarctobacterium faecium et rel. \"Firmicutes\"    \nActinomycetaceae                      \"Actinobacteria\"\nEubacterium hallii et rel.            \"Firmicutes\"    \nClostridium stercorarium et rel.      \"Firmicutes\"    \nClostridium symbiosum et rel.         \"Firmicutes\"    \n                                      Family                    \nPhascolarctobacterium faecium et rel. \"Clostridium cluster IX\"  \nActinomycetaceae                      \"Actinobacteria\"          \nEubacterium hallii et rel.            \"Clostridium cluster XIVa\"\nClostridium stercorarium et rel.      \"Clostridium cluster III\" \nClostridium symbiosum et rel.         \"Clostridium cluster XIVa\"\n                                      Genus                                  \nPhascolarctobacterium faecium et rel. \"Phascolarctobacterium faecium et rel.\"\nActinomycetaceae                      \"Actinomycetaceae\"                     \nEubacterium hallii et rel.            \"Eubacterium hallii et rel.\"           \nClostridium stercorarium et rel.      \"Clostridium stercorarium et rel.\"     \nClostridium symbiosum et rel.         \"Clostridium symbiosum et rel.\"        "},{"path":"reviewing-phyloseq-objects.html","id":"phylogenetic-tree-if-available","chapter":"6 Reviewing Phyloseq Objects","heading":"6.9 Phylogenetic tree if available","text":"","code":""},{"path":"reviewing-phyloseq-objects.html","id":"taxa-names","chapter":"6 Reviewing Phyloseq Objects","heading":"6.10 Taxa names","text":"","code":"taxa_names(ps)[1:10]\n [1] \"Phascolarctobacterium faecium et rel.\"\n [2] \"Actinomycetaceae\"                     \n [3] \"Eubacterium hallii et rel.\"           \n [4] \"Clostridium stercorarium et rel.\"     \n [5] \"Clostridium symbiosum et rel.\"        \n [6] \"Wissella et rel.\"                     \n [7] \"Peptostreptococcus anaerobius et rel.\"\n [8] \"Ruminococcus bromii et rel.\"          \n [9] \"Prevotella ruminicola et rel.\"        \n[10] \"Yersinia et rel.\"                     "},{"path":"reviewing-phyloseq-objects.html","id":"summarize-phyloseq-object","chapter":"6 Reviewing Phyloseq Objects","heading":"6.11 Summarize Phyloseq Object","text":"","code":"\nmicrobiome::summarize_phyloseq(ps)\n[[1]]\n[1] \"1] Min. number of reads = 1776\"\n\n[[2]]\n[1] \"2] Max. number of reads = 28883\"\n\n[[3]]\n[1] \"3] Total number of reads = 2949085\"\n\n[[4]]\n[1] \"4] Average number of reads = 13284.1666666667\"\n\n[[5]]\n[1] \"5] Median number of reads = 13255\"\n\n[[6]]\n[1] \"7] Sparsity = 0.205647955647956\"\n\n[[7]]\n[1] \"6] Any OTU sum to 1 or less? YES\"\n\n[[8]]\n[1] \"8] Number of singletons = 10\"\n\n[[9]]\n[1] \"9] Percent of OTUs that are singletons \\n        (i.e. exactly one read detected across all samples)2.30769230769231\"\n\n[[10]]\n[1] \"10] Number of sample variables are: 8\"\n\n[[11]]\n[1] \"subject\"                \"sex\"                    \"nationality\"           \n[4] \"group\"                  \"sample\"                 \"timepoint\"             \n[7] \"timepoint.within.group\" \"bmi_group\"             "},{"path":"reviewing-phyloseq-objects.html","id":"sort-samples-in-ascending-and-descending","chapter":"6 Reviewing Phyloseq Objects","heading":"6.12 Sort Samples in ascending and descending","text":"","code":"cat(\"In ascending order\\n\")\nIn ascending order\nhead(sort(phyloseq::sample_sums(ps), decreasing = F))\n Sample-56 Sample-195 Sample-196  Sample-42 Sample-164 Sample-147 \n      1776       4477       4606       5006       5541       5624 \ncat(\"\\nIn descending order\\n\")\n\nIn descending order\nhead(sort(phyloseq::sample_sums(ps), decreasing = T))\n  Sample-3  Sample-11  Sample-12  Sample-54 Sample-208  Sample-20 \n     28883      26895      25238      23529      23131      22413 "},{"path":"reviewing-phyloseq-objects.html","id":"drop-samples-below-a-threshold","chapter":"6 Reviewing Phyloseq Objects","heading":"6.13 Drop Samples Below a Threshold","text":"","code":"ps1perc0 <- phyloseq::subset_samples(ps, phyloseq::sample_sums(ps) > 1)\nps1perc0\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 130 tips and 129 internal nodes ]"},{"path":"reviewing-phyloseq-objects.html","id":"drop-taxa-below-a-threshold","chapter":"6 Reviewing Phyloseq Objects","heading":"6.14 Drop Taxa Below a Threshold","text":"","code":"pstaxa01 <- phyloseq::prune_taxa(phyloseq::taxa_sums(ps) > 1, ps)\npstaxa01 \nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 120 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 120 taxa by 3 taxonomic ranks ]\nphy_tree()    Phylogenetic Tree: [ 120 tips and 119 internal nodes ]"},{"path":"create-psextra-objects.html","id":"create-psextra-objects","chapter":"7 Create psExtra Objects","heading":"7 Create psExtra Objects","text":"creation phyloseq objects, proceed create psExtra objects using functionalities provided microViz package. psExtra objects extend capabilities phyloseq objects incorporating additional metadata, experimental conditions, statistical results, enhancing depth breadth analyses performed using microbiome data.","code":""},{"path":"create-psextra-objects.html","id":"prerequisite","chapter":"7 Create psExtra Objects","heading":"7.1 Prerequisite","text":"creating psExtra objects, ’s essential pre-existing phyloseq objects containing microbiome data associated metadata. phyloseq objects serve input data creating psExtra objects. example, pre-existing phyloseq objects ps_dietswap, ps_GlobalPatterns, ps_caporaso, ps_kostic_crc prepared previous sections available.","code":""},{"path":"create-psextra-objects.html","id":"load-pre-existing-phyloseq-objects","chapter":"7 Create psExtra Objects","heading":"7.2 Load pre-existing phyloseq objects","text":"","code":"load(\"data/phyloseq_objects.rda\", verbose = TRUE)\nLoading objects:\n  ps_GlobalPatterns\n  ps_dietswap\n  ps_caporaso\n  ps_kostic_crc"},{"path":"create-psextra-objects.html","id":"aggregate-taxonomic-data","chapter":"7 Create psExtra Objects","heading":"7.3 Aggregate taxonomic data","text":"","code":"# Load required packages\nlibrary(phyloseq) # For handling microbiome data\nlibrary(microViz) # For advanced microbiome visualization\n\n# Assuming ps_dietswap is already loaded or available\n\n# Aggregate taxonomic data\npsextra_clr_dietswap <- tax_agg(\n  ps = ps_dietswap,\n  rank = \"Genus\") %>% \n  tax_transform(trans = \"clr\")\n\n# Display a subset of the transformed data\ncat(\"\\nCentered log Ratio (CLR) Transformation\\n\")\n\nCentered log Ratio (CLR) Transformation\npsextra_clr_dietswap %>% \n  otu_get() %>%\n  .[1:4, 1:3]\nOTU Table:          [3 taxa and 4 samples]\n                     taxa are columns\n         Phascolarctobacterium faecium et rel. Actinomycetaceae\nSample-1                            -0.2120560        -3.555474\nSample-2                            -0.6717570        -2.040486\nSample-3                             0.1808535        -3.114983\nSample-4                            -0.7078750        -1.943474\n         Eubacterium hallii et rel.\nSample-1                  0.6828174\nSample-2                  2.2768872\nSample-3                  1.2544645\nSample-4                  1.2914479\n\n# Aggregate taxonomic data\npsextra_id_dietswap <- tax_agg(\n  ps = ps_dietswap,\n  rank = \"Genus\") %>% \n  tax_transform(trans = \"identity\")\n\n# Display a subset of the transformed data\ncat(\"\\nIdentity Transformation\\n\")\n\nIdentity Transformation\npsextra_id_dietswap %>% \n  otu_get() %>%\n  .[1:4, 1:3]\nOTU Table:          [3 taxa and 4 samples]\n                     taxa are columns\n         Phascolarctobacterium faecium et rel. Actinomycetaceae\nSample-1                                     4                0\nSample-2                                     5                1\nSample-3                                    13                0\nSample-4                                     4                1\n         Eubacterium hallii et rel.\nSample-1                         10\nSample-2                        102\nSample-3                         39\nSample-4                         31\n\n# Aggregate taxonomic data\npsextra_log10p_dietswap <- tax_agg(\n  ps = ps_dietswap,\n  rank = \"Genus\") %>% \n  tax_transform(trans = \"log10p\")\n\n# Display a subset of the transformed data\ncat(\"\\nLog10p Transformation\\n\")\n\nLog10p Transformation\npsextra_log10p_dietswap %>% \n  otu_get() %>%\n  .[1:4, 1:3]\nOTU Table:          [3 taxa and 4 samples]\n                     taxa are columns\n         Phascolarctobacterium faecium et rel. Actinomycetaceae\nSample-1                             0.6989700          0.00000\nSample-2                             0.7781513          0.30103\nSample-3                             1.1461280          0.00000\nSample-4                             0.6989700          0.30103\n         Eubacterium hallii et rel.\nSample-1                   1.041393\nSample-2                   2.012837\nSample-3                   1.602060\nSample-4                   1.505150"},{"path":"create-psextra-objects.html","id":"confirm-the-psextra-class","chapter":"7 Create psExtra Objects","heading":"7.4 Confirm the psExtra class","text":"","code":"summary(psextra_clr_dietswap)\n Length   Class    Mode \n      1 psExtra      S4 \nsummary(psextra_id_dietswap)\n Length   Class    Mode \n      1 psExtra      S4 \nsummary(psextra_log10p_dietswap)\n Length   Class    Mode \n      1 psExtra      S4 "},{"path":"create-psextra-objects.html","id":"save-psextra-to-r-object","chapter":"7 Create psExtra Objects","heading":"7.5 Save psExtra to R object","text":"","code":"\nsave(psextra_clr_dietswap, psextra_id_dietswap, psextra_log10p_dietswap, file = \"data/phyloseq_extra_objects.rda\")"},{"path":"pipeline-for-cleaning-phyloseq-objects.html","id":"pipeline-for-cleaning-phyloseq-objects","chapter":"8 Pipeline for Cleaning Phyloseq Objects","heading":"8 Pipeline for Cleaning Phyloseq Objects","text":"proceeding downstream analyses, ’s good practice inspect clean phyloseq object minimize potential errors biases. ensuring data integrity consistency, can enhance reliability results.section, ’ll outline pipeline inspecting cleaning phyloseq object. ’ll thoroughly examine contents rebuild object needed prepare subsequent analyses.","code":""},{"path":"pipeline-for-cleaning-phyloseq-objects.html","id":"demo-with-the-dietswap-dataset","chapter":"8 Pipeline for Cleaning Phyloseq Objects","heading":"8.1 Demo with the dietswap dataset","text":"","code":"# Set seed for reproducibility\nset.seed(110912)\n\n# Load required libraries\nlibrary(tidyverse)\nlibrary(phyloseq)\nlibrary(microbiome) # for dietswap ps object\nlibrary(microViz) # for ps_melt function and psExtra object.\nlibrary(ape)\n\n# Load the dietswap dataset from the microbiome package\ndata(\"dietswap\", package = \"microbiome\")\n\nps <- ps_dietswap\n\n# Apply string replacement to specified columns\nps_df <- ps_melt(ps)  %>% # melt using microViz function ps_melt()\nmutate(Genus = str_replace_all(Genus, \" et rel.\", \"\"),\n       Genus = str_replace_all(Genus, \" at rel.\", \"\"),\n       # Species = replace(Species, is.na(Species), 0),\n       Genus = replace(Genus, is.na(Genus), 0),\n       Family = replace(Family, is.na(Family), 0),\n       # Order = replace(Order, is.na(Order), 0),\n       # Class = replace(Genus, is.na(Class), 0),\n       Phylum = replace(Phylum, is.na(Phylum), 0)\n      )\n\notu_table <- ps_df %>%\npivot_wider(id_cols = \"OTU\", names_from = \"Sample\", values_from = \"Abundance\") %>%\nmutate(OTU = paste0(\"OTU\", sprintf(\"%03d\", 1:nrow(otu_table(ps))))) %>% # just for neat OTU names\ntibble::column_to_rownames(\"OTU\") %>%\notu_table(otutable, taxa_are_rows = TRUE)\n\ntax_table <- ps_df %>%\nselect(\"OTU\", \"Phylum\", \"Family\", \"Genus\") %>%\ndistinct() %>%\nmutate(OTU = paste0(\"OTU\", sprintf(\"%03d\", 1:nrow(otu_table(ps))))) %>%\ntibble::column_to_rownames(\"OTU\") %>%\nas.matrix() %>%\ntax_table(taxtable)\n\n# Check if rowname of otutable and that of taxonomy are equal\nx1 = otu_table %>%\nas.data.frame() %>%\nrownames_to_column(\"OTU\")\n\n\nx2 = tax_table %>%\nas.data.frame() %>%\nrownames_to_column(\"OTU\")\n\nidentical(x1$OTU, x2$OTU)\n[1] TRUE\n\n\n## Creating a new phyloseq object after alteration\n\nps_basic<- merge_phyloseq(otu_table, tax_table, sample_data(ps))\nps_tree = rtree(ntaxa(ps_basic), rooted=TRUE, tip.label=taxa_names(ps_basic))\nps_raw <- phyloseq::merge_phyloseq(ps_basic, ps_tree)\nps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})\n\n# # Check points\n# otu_table(ps_raw)\n# tax_table(ps_raw)\n# sample_data(ps_raw)\n# phy_tree(ps_raw)\n\n## Create a Phylosic extra object\n\nlibrary(microViz)\n\npsextra_raw <- tax_agg(ps = ps_raw, rank = \"Genus\")\n\ncat(\"\\nClass of ps_raw\\n\\n\")\n\nClass of ps_raw\nsummary(ps_raw)\n  Length    Class     Mode \n       1 phyloseq       S4 \n\ncat(\"\\nClass of psextra_raw\\n\")\n\nClass of psextra_raw\nsummary(psextra_raw)\n Length   Class    Mode \n      1 psExtra      S4 \n\notu_table(psextra_raw)[1:3, 1:3] %>% as.data.frame()\n                    Sample-1 Sample-2 Sample-3\nEubacterium limosum        1        1        1\nStaphylococcus             0        0        0\nOceanospirillum            1        2        1\n\npsextra_rel <- phyloseq::transform_sample_counts(psextra_raw, function(x){x / sum(x)})\n\notu_table(ps_rel)[1:3, 1:3] %>% as.data.frame()\n           Sample-1     Sample-2     Sample-3\nOTU016 0.0001182173 4.742483e-05 3.462244e-05\nOTU038 0.0000000000 0.000000e+00 0.000000e+00\nOTU055 0.0001182173 9.484966e-05 3.462244e-05\n\n\n## Getting clean dataframe from psExtra object\nps_df <- psmelt(psextra_raw) %>%\ngroup_by(Sample) %>%\nmutate(total = sum(Abundance)) %>%\nfilter(total > 0) %>%\nfilter(Abundance >0) %>%\ngroup_by(OTU) %>%\nmutate(total = sum(Abundance)) %>%\nfilter(total != 0) %>%\nungroup() %>%\nselect(-total) %>% as.data.frame() %>%\ngroup_by(Sample) %>%\nmutate(rel_abund = Abundance/sum(Abundance)) %>%\nungroup() %>%\nrelocate(Abundance, .before = rel_abund) %>%\nrename_all(~ make.unique(tolower(.), sep = \"_\")) %>%\nrename(sample_id = sample,\ncount = abundance,\nbmi = bmi_group,\ngrp = group,\ntimewithingrp = timepoint.within.group) %>%\npivot_longer(cols = c(\"phylum\", \"family\", \"genus\", \"otu\"), names_to = \"level\", values_to = \"taxon\") %>%\nmutate(taxon = str_replace(string = taxon,\npattern = \"(.*)\",\nreplacement = \"*\\\\1*\"),\ntaxon = str_replace(string = taxon,\npattern = \"\\\\*(.*)_unclassified\\\\*\",\nreplacement = \"Unclassified<br>*\\\\1*\"),\ntaxon = str_replace_all(taxon, \"_\", \" \"))"},{"path":"pipeline-for-cleaning-phyloseq-objects.html","id":"save-clean-object","chapter":"8 Pipeline for Cleaning Phyloseq Objects","heading":"8.2 Save clean object","text":"","code":"\nsave(ps_raw, ps_rel, psextra_raw, psextra_rel, ps_df, file = \"data/phyloseq_raw_rel_psextra_df_objects.rda\")"},{"path":"data-tarnsformation.html","id":"data-tarnsformation","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9 Data Tranformation from Phyloseq Objects","text":"process data transformation microbiome analysis involves converting raw relative abundance values matrices suitable analysis. Data transformation focuses modifying data . context, explore various methods used transformation phyloseq object.","code":""},{"path":"data-tarnsformation.html","id":"import-processed-phyloseq-object","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.1 Import processed phyloseq object","text":"","code":"load(\"../imap-data-preparation/data/phyloseq_raw_rel_psextra_df_objects.rda\", verbose = TRUE) \nLoading objects:\n  ps_raw\n  ps_rel\n  psextra_raw\n  psextra_rel\n  ps_df"},{"path":"data-tarnsformation.html","id":"raw-abundance","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.2 Raw Abundance","text":"","code":"ps_raw <- psextra_raw\notu_table(ps_raw)[1:10, 1:10]\nOTU Table:          [10 taxa and 10 samples]\n                     taxa are rows\n                       Sample-1 Sample-2 Sample-3 Sample-4 Sample-5 Sample-6\nEubacterium limosum           1        1        1        1        1        1\nStaphylococcus                0        0        0        0        0        0\nOceanospirillum               1        2        1        2        1        1\nRuminococcus obeum           89      901      620      476      457      375\nBurkholderia                  1        1        2        0        2        1\nClostridium sphenoides       41      127      133       63       94       90\nFusobacteria                  4        5        5        5        5        8\nBifidobacterium              43       25      183      493       22       24\nMethylobacterium              0        0        0        0        0        0\nClostridium ramosum           2        2        2        2        2        2\n                       Sample-7 Sample-8 Sample-9 Sample-10\nEubacterium limosum           1        1        1         1\nStaphylococcus                0        0        0         0\nOceanospirillum               1        1        1         2\nRuminococcus obeum          661      444      339       599\nBurkholderia                  1        1        0         1\nClostridium sphenoides      153       92       55        84\nFusobacteria                  5        5        4         5\nBifidobacterium             116       62      151        20\nMethylobacterium              0        0        0         0\nClostridium ramosum           3        2        2         2"},{"path":"data-tarnsformation.html","id":"no-transformation","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.3 No Transformation","text":"Similar raw abundance","code":"(ps_identity <- microbiome::transform(ps_raw, 'identity'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_identity)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                    Sample-1 Sample-2 Sample-3\nEubacterium limosum        1        1        1\nStaphylococcus             0        0        0\nOceanospirillum            1        2        1\nRuminococcus obeum        89      901      620\nBurkholderia               1        1        2"},{"path":"data-tarnsformation.html","id":"relative-abundance","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.4 Relative abundance","text":"","code":"(ps_rel = phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)}))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\notu_table(ps_rel)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                        Sample-1     Sample-2     Sample-3\nEubacterium limosum 0.0001182173 4.742483e-05 3.462244e-05\nStaphylococcus      0.0000000000 0.000000e+00 0.000000e+00\nOceanospirillum     0.0001182173 9.484966e-05 3.462244e-05\nRuminococcus obeum  0.0105213382 4.272977e-02 2.146591e-02\nBurkholderia        0.0001182173 4.742483e-05 6.924488e-05"},{"path":"data-tarnsformation.html","id":"arc-sine-asin-transformation","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.5 Arc sine (asin) transformation","text":"Typically used dealing proportional percentages.Proportionals range 0 1Percentages range 0 100The Metaphlan3 relative abundances percentages! means column totals 100.","code":"x = otu_table(ps_rel)\ny <- x/max(x)\n\nps_asin <- round(asin(sqrt(y)), 6)\n\nps_asin <- as.matrix(ps_asin)\nps_asin[1:5, 1:4]\nOTU Table:          [5 taxa and 4 samples]\n                     taxa are rows\n                    Sample-1 Sample-2 Sample-3 Sample-4\nEubacterium limosum 0.012391 0.007848 0.006706 0.009903\nStaphylococcus      0.000000 0.000000 0.000000 0.000000\nOceanospirillum     0.012391 0.011099 0.006706 0.014005\nRuminococcus obeum  0.117166 0.237814 0.167759 0.217764\nBurkholderia        0.012391 0.007848 0.009484 0.000000"},{"path":"data-tarnsformation.html","id":"compositional-version","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.6 Compositional Version","text":"Compositional data represents relative proportions percentages different microbial taxa within sample, rather absolute abundance taxon. transformation necessary raw abundance data typically affected various factors, sequencing depth, can lead spurious correlations biases downstream analyses.","code":"(ps_compositional <- microbiome::transform(ps_raw, 'compositional'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_compositional)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                        Sample-1     Sample-2     Sample-3\nEubacterium limosum 0.0001182173 4.742483e-05 3.462244e-05\nStaphylococcus      0.0000000000 0.000000e+00 0.000000e+00\nOceanospirillum     0.0001182173 9.484966e-05 3.462244e-05\nRuminococcus obeum  0.0105213382 4.272977e-02 2.146591e-02\nBurkholderia        0.0001182173 4.742483e-05 6.924488e-05"},{"path":"data-tarnsformation.html","id":"z-transform-for-otus","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.7 Z-transform for OTUs","text":"","code":"(ps_z_otu <- microbiome::transform(ps_raw, 'Z', 'OTU'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_z_otu)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                      Sample-1   Sample-2   Sample-3\nEubacterium limosum -0.2855358 -0.2855358 -0.2855358\nStaphylococcus      -0.2685840 -0.2685840 -0.2685840\nOceanospirillum     -0.5570347  0.2530445 -0.5570347\nRuminococcus obeum  -0.7310885  2.1112033  1.6508691\nBurkholderia         0.3632341  0.3632341  1.1488042"},{"path":"data-tarnsformation.html","id":"z-transform-for-samples","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.8 Z-transform for Samples","text":"","code":"(ps_z_sample <- microbiome::transform(ps_raw, 'Z', 'sample'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_z_sample)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                      Sample-1   Sample-2   Sample-3\nEubacterium limosum -0.7821978 -0.8924188 -0.8682102\nStaphylococcus      -1.1517915 -1.2167251 -1.1804675\nOceanospirillum     -0.7821978 -0.7027117 -0.8682102\nRuminococcus obeum   1.2475566  1.9669852  1.7167961\nBurkholderia        -0.7821978 -0.8924188 -0.6855514"},{"path":"data-tarnsformation.html","id":"log10-transform","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.9 Log10 Transform","text":"","code":"(ps_log10 <- microbiome::transform(ps_raw, 'log10'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_log10)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                    Sample-1  Sample-2  Sample-3\nEubacterium limosum 0.301030 0.3010300 0.3010300\nStaphylococcus      0.000000 0.0000000 0.0000000\nOceanospirillum     0.301030 0.4771213 0.3010300\nRuminococcus obeum  1.954243 2.9552065 2.7930916\nBurkholderia        0.301030 0.3010300 0.4771213"},{"path":"data-tarnsformation.html","id":"log10p-transform","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.10 Log10p Transform","text":"","code":"(ps_log10p <- microbiome::transform(ps_raw, 'log10p'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_log10p)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                    Sample-1  Sample-2  Sample-3\nEubacterium limosum 0.301030 0.3010300 0.3010300\nStaphylococcus      0.000000 0.0000000 0.0000000\nOceanospirillum     0.301030 0.4771213 0.3010300\nRuminococcus obeum  1.954243 2.9552065 2.7930916\nBurkholderia        0.301030 0.3010300 0.4771213"},{"path":"data-tarnsformation.html","id":"clr-transform","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.11 CLR Transform","text":"Note small pseudocount added data contains zeroes","code":"(ps_clr <- microbiome::transform(ps_raw, 'clr'))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_clr)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                     Sample-1  Sample-2  Sample-3\nEubacterium limosum -1.497647 -2.040486 -2.016371\nStaphylococcus      -3.555474 -3.359449 -3.114983\nOceanospirillum     -1.497647 -1.490870 -2.016371\nRuminococcus obeum   2.855975  4.452252  4.008689\nBurkholderia        -1.497647 -2.040486 -1.505545"},{"path":"data-tarnsformation.html","id":"shift-the-baseline","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.12 Shift the baseline","text":"","code":"(ps_shift <- microbiome::transform(ps_raw, 'shift', shift=1))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_shift)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                    Sample-1 Sample-2 Sample-3\nEubacterium limosum        2        2        2\nStaphylococcus             1        1        1\nOceanospirillum            2        3        2\nRuminococcus obeum        90      902      621\nBurkholderia               2        2        3"},{"path":"data-tarnsformation.html","id":"data-scaling","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.13 Data Scaling","text":"","code":"(ps_scale <- microbiome::transform(ps_raw, 'scale', scale=1))\nphyloseq-class experiment-level object\notu_table()   OTU Table:         [ 130 taxa and 222 samples ]\nsample_data() Sample Data:       [ 222 samples by 8 sample variables ]\ntax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]\n\ncat(\"\\n\\n\")\notu_table(ps_scale)[1:5, 1:3]\nOTU Table:          [5 taxa and 3 samples]\n                     taxa are rows\n                    Sample-1 Sample-2 Sample-3\nEubacterium limosum        1        1        1\nStaphylococcus             0        0        0\nOceanospirillum            1        2        1\nRuminococcus obeum        89      901      620\nBurkholderia               1        1        2"},{"path":"data-tarnsformation.html","id":"save-transformed-objects","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.14 Save transformed objects","text":"","code":"\nsave(\n  ps_asin, \n  ps_identity,\n  ps_compositional, \n  ps_z_otu, \n  ps_z_sample, \n  ps_log10, \n  ps_log10p, \n  ps_clr, \n  ps_shift, \n  ps_scale, \n  file = \"data/ps_transformed.rda\")"},{"path":"data-tarnsformation.html","id":"confirm-saved-object","chapter":"9 Data Tranformation from Phyloseq Objects","heading":"9.15 Confirm saved object","text":"","code":"load(\"data/ps_transformed.rda\", verbose = TRUE)\nLoading objects:\n  ps_asin\n  ps_identity\n  ps_compositional\n  ps_z_otu\n  ps_z_sample\n  ps_log10\n  ps_log10p\n  ps_clr\n  ps_shift\n  ps_scale"},{"path":"distance-calculation-in-microbiome-data-analysis.html","id":"distance-calculation-in-microbiome-data-analysis","chapter":"10 Distance Calculation in Microbiome Data Analysis","heading":"10 Distance Calculation in Microbiome Data Analysis","text":"Calculating distance matrices samples using appropriate metrics fundamental step data preprocessing. practice efficiently captures similarity dissimilarity samples, laying groundwork subsequent analysis dimensionality reduction techniques PCA, MDS, t-SNE.","code":""},{"path":"distance-calculation-in-microbiome-data-analysis.html","id":"import-processed-and-transformed-data-objects","chapter":"10 Distance Calculation in Microbiome Data Analysis","heading":"10.1 Import processed and transformed data objects","text":"","code":"set.seed(110912)\n\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(vegan)\n\nload(\"data/phyloseq_objects.rda\", verbose = TRUE)\nLoading objects:\n  ps_GlobalPatterns\n  ps_dietswap\n  ps_caporaso\n  ps_kostic_crc\nload(\"data/ps_transformed.rda\", verbose = TRUE)\nLoading objects:\n  ps_asin\n  ps_identity\n  ps_compositional\n  ps_z_otu\n  ps_z_sample\n  ps_log10\n  ps_log10p\n  ps_clr\n  ps_shift\n  ps_scale\nload(\"data/bray_distances.rda\", verbose = TRUE)\nLoading objects:\n  ps_asin_bray_dist\n  ps_compositional_bray_dist\n  ps_z_otu_bray_dist\n  ps_z_sample_bray_dist\n  ps_log10_bray_dist\n  ps_log10p_bray_dist\n  ps_clr_bray_dist\n  ps_shift_bray_dist\n  ps_scale_bray_dist\nload(\"data/phyloseq_raw_rel_psextra_df_objects.rda\", verbose = TRUE)\nLoading objects:\n  ps_raw\n  ps_rel\n  psextra_raw\n  psextra_rel\n  ps_df"},{"path":"distance-calculation-in-microbiome-data-analysis.html","id":"bray-curtis-dissimilarity","chapter":"10 Distance Calculation in Microbiome Data Analysis","heading":"10.2 Bray-Curtis Dissimilarity","text":"Bray-Curtis dissimilarity calculates dissimilarity two samples based relative abundances taxa. considers presence abundance information sensitive differences abundance magnitude.","code":"\nlibrary(vegan)\nlibrary(dplyr)\n\nps_asin_bray_dist  <- vegdist(t(otu_table(ps_asin)), method=\"bray\") %>%\n  as.matrix()\nps_identity_bray_dist  <- vegdist(t(otu_table(ps_identity)), method=\"bray\") %>%\n  as.matrix \nps_compositional_bray_dist  <- vegdist(t(otu_table(ps_compositional)), method=\"bray\") %>%\n  as.matrix \nps_z_otu_bray_dist  <- vegdist(t(otu_table(ps_z_otu)), method=\"bray\") %>%\n  as.matrix \nps_z_sample_bray_dist  <- vegdist(t(otu_table(ps_z_sample)), method=\"bray\") %>%\n  as.matrix \nps_log10_bray_dist  <- vegdist(t(otu_table(ps_log10)), method=\"bray\") %>%\n  as.matrix \nps_log10p_bray_dist  <- vegdist(t(otu_table(ps_log10p)), method=\"bray\") %>%\n  as.matrix \nps_clr_bray_dist  <- vegdist(t(otu_table(ps_clr)), method=\"bray\") %>%\n  as.matrix \nps_shift_bray_dist  <- vegdist(t(otu_table(ps_shift)), method=\"bray\") %>%\n  as.matrix \nps_scale_bray_dist  <- vegdist(t(otu_table(ps_scale)), method=\"bray\") %>%\n  as.matrix \n\nsave(ps_asin_bray_dist, \n     ps_compositional_bray_dist, \n     ps_z_otu_bray_dist, \n     ps_z_sample_bray_dist, \n     ps_log10_bray_dist, \n     ps_log10p_bray_dist, \n     ps_clr_bray_dist, \n     ps_shift_bray_dist, \n     ps_scale_bray_dist, \n     file = \"data/bray_distances.rda\")"},{"path":"distance-calculation-in-microbiome-data-analysis.html","id":"jaccard-distance","chapter":"10 Distance Calculation in Microbiome Data Analysis","heading":"10.3 Jaccard Distance","text":"Jaccard distance measures dissimilarity two samples based presence absence taxa, ignoring abundance information. calculated ratio number taxa found one samples total number taxa found samples.Confirm computed Jaccard distance objects","code":"\nlibrary(vegan)\nlibrary(dplyr)\n\nps_asin_jaccard_dist  <- vegdist(t(otu_table(ps_asin)), method=\"jaccard\") %>%\n  as.matrix()\nps_identity_jaccard_dist  <- vegdist(t(otu_table(ps_identity)), method=\"jaccard\") %>%\n  as.matrix \nps_compositional_jaccard_dist  <- vegdist(t(otu_table(ps_compositional)), method=\"jaccard\") %>%\n  as.matrix \nps_z_otu_jaccard_dist  <- vegdist(t(otu_table(ps_z_otu)), method=\"jaccard\") %>%\n  as.matrix \nps_z_sample_jaccard_dist  <- vegdist(t(otu_table(ps_z_sample)), method=\"jaccard\") %>%\n  as.matrix \nps_log10_jaccard_dist  <- vegdist(t(otu_table(ps_log10)), method=\"jaccard\") %>%\n  as.matrix \nps_log10p_jaccard_dist  <- vegdist(t(otu_table(ps_log10p)), method=\"jaccard\") %>%\n  as.matrix \nps_clr_jaccard_dist  <- vegdist(t(otu_table(ps_clr)), method=\"jaccard\") %>%\n  as.matrix \nps_shift_jaccard_dist  <- vegdist(t(otu_table(ps_shift)), method=\"jaccard\") %>%\n  as.matrix \nps_scale_jaccard_dist  <- vegdist(t(otu_table(ps_scale)), method=\"jaccard\") %>%\n  as.matrix \n\nsave(ps_asin_jaccard_dist, \n     ps_compositional_jaccard_dist, \n     ps_z_otu_jaccard_dist, \n     ps_z_sample_jaccard_dist, \n     ps_log10_jaccard_dist, \n     ps_log10p_jaccard_dist, \n     ps_clr_jaccard_dist, \n     ps_shift_jaccard_dist, \n     ps_scale_jaccard_dist, \n     file = \"data/jaccard_distances.rda\")load(\"data/jaccard_distances.rda\", verbose = T)\nLoading objects:\n  ps_asin_jaccard_dist\n  ps_compositional_jaccard_dist\n  ps_z_otu_jaccard_dist\n  ps_z_sample_jaccard_dist\n  ps_log10_jaccard_dist\n  ps_log10p_jaccard_dist\n  ps_clr_jaccard_dist\n  ps_shift_jaccard_dist\n  ps_scale_jaccard_dist"},{"path":"distance-calculation-in-microbiome-data-analysis.html","id":"euclidean-distance","chapter":"10 Distance Calculation in Microbiome Data Analysis","heading":"10.4 Euclidean Distance","text":"Euclidean distance calculates straight-line distance two samples multidimensional space based abundance profiles. considers differences presence abundance taxa.Confirm computed Euclidean distance objects","code":"\nlibrary(vegan)\nlibrary(dplyr)\n\nps_asin_euclidean_dist  <- vegdist(t(otu_table(ps_asin)), method=\"euclidean\") %>%\n  as.matrix()\nps_identity_euclidean_dist  <- vegdist(t(otu_table(ps_identity)), method=\"euclidean\") %>%\n  as.matrix \nps_compositional_euclidean_dist  <- vegdist(t(otu_table(ps_compositional)), method=\"euclidean\") %>%\n  as.matrix \nps_z_otu_euclidean_dist  <- vegdist(t(otu_table(ps_z_otu)), method=\"euclidean\") %>%\n  as.matrix \nps_z_sample_euclidean_dist  <- vegdist(t(otu_table(ps_z_sample)), method=\"euclidean\") %>%\n  as.matrix \nps_log10_euclidean_dist  <- vegdist(t(otu_table(ps_log10)), method=\"euclidean\") %>%\n  as.matrix \nps_log10p_euclidean_dist  <- vegdist(t(otu_table(ps_log10p)), method=\"euclidean\") %>%\n  as.matrix \nps_clr_euclidean_dist  <- vegdist(t(otu_table(ps_clr)), method=\"euclidean\") %>%\n  as.matrix \nps_shift_euclidean_dist  <- vegdist(t(otu_table(ps_shift)), method=\"euclidean\") %>%\n  as.matrix \nps_scale_euclidean_dist  <- vegdist(t(otu_table(ps_scale)), method=\"euclidean\") %>%\n  as.matrix \n\nsave(ps_asin_euclidean_dist, \n     ps_compositional_euclidean_dist, \n     ps_z_otu_euclidean_dist, \n     ps_z_sample_euclidean_dist, \n     ps_log10_euclidean_dist, \n     ps_log10p_euclidean_dist, \n     ps_clr_euclidean_dist, \n     ps_shift_euclidean_dist, \n     ps_scale_euclidean_dist, \n     file = \"data/euclidean_distances.rda\")load(\"data/euclidean_distances.rda\", verbose = T)\nLoading objects:\n  ps_asin_euclidean_dist\n  ps_compositional_euclidean_dist\n  ps_z_otu_euclidean_dist\n  ps_z_sample_euclidean_dist\n  ps_log10_euclidean_dist\n  ps_log10p_euclidean_dist\n  ps_clr_euclidean_dist\n  ps_shift_euclidean_dist\n  ps_scale_euclidean_dist"},{"path":"distance-calculation-in-microbiome-data-analysis.html","id":"aitchison-distance","chapter":"10 Distance Calculation in Microbiome Data Analysis","heading":"10.5 Aitchison Distance","text":"Aitchison distance, also known compositional distance log-ratio distance, specifically designed compositional data microbiome abundance data. calculates dissimilarity two samples based log-ratio transformations compositional vectors, providing meaningful comparisons samples addressing compositional constraints inherent relative abundance data.Confirm computed Aitchison distance objects","code":"\nlibrary(microViz)\nlibrary(dplyr)\n\n# ps_identity_aitchison_dists <- ps_asin %>% dist_calc(\"aitchison\")\nps_GlobalPatterns_aitchison_dists <- ps_GlobalPatterns %>% dist_calc(\"aitchison\")\nps_dietswap_aitchison_dists <- ps_dietswap %>% dist_calc(\"aitchison\")\nps_kostic_crc_aitchison_dists <- ps_kostic_crc %>% dist_calc(\"aitchison\")\n\nsave(ps_GlobalPatterns_aitchison_dists, \n     ps_dietswap_aitchison_dists, \n     ps_kostic_crc_aitchison_dists, \n     file = \"data/aitchison_distances.rda\")load(\"data/aitchison_distances.rda\", verbose = T)\nLoading objects:\n  ps_GlobalPatterns_aitchison_dists\n  ps_dietswap_aitchison_dists\n  ps_kostic_crc_aitchison_dists"},{"path":"utilizing-transformed-data.html","id":"utilizing-transformed-data","chapter":"11 What’s Next: Utilizing Transformed Data","heading":"11 What’s Next: Utilizing Transformed Data","text":"computing distances using various methods, Bray-Curtis, Jaccard, Euclidean, Aitchison, can harness transformed data downstream analyses. analyses may encompass:Beta Diversity Analysis: Comparing microbial community compositions samples elucidate differences similarities.Multivariate Statistical Analysis: Assessing significance differences groups samples using methods like PERMANOVA MANOVA.Data Visualization: Identifying patterns clusters within microbial community data visualization techniques PCoA NMDS plots.Correlation Analysis: Exploring relationships microbial taxa environmental variables uncover potential ecological associations.Dimensionality Reduction: Employing techniques like Principal Component Analysis (PCA), t-Distributed Stochastic Neighbor Embedding (t-SNE), Uniform Manifold Approximation Projection (UMAP) visualize high-dimensional microbiome data lower-dimensional spaces.leveraging transformed data distance calculations, can gain deeper insights microbial community dynamics relationships various environmental factors experimental conditions.","code":""},{"path":"dimensionality-reduction-techniques.html","id":"dimensionality-reduction-techniques","chapter":"12 Dimensionality Reduction Techniques","heading":"12 Dimensionality Reduction Techniques","text":"Dimensionality reduction crucial step microbiome analysis, aiming simplify datasets retaining essential information. section explores techniques reducing number features variables phyloseq object, enabling efficient analysis visualization microbial community data.delve commonly used dimensionality reduction methods PCA, MDS, t-SNE. techniques utilize distance matrices obtained previous step visualize explore structure microbiome data lower-dimensional spaces. subsection covers technical details method provides examples application microbiome data analysis.","code":""},{"path":"dimensionality-reduction-techniques.html","id":"prerequisite-1","chapter":"12 Dimensionality Reduction Techniques","heading":"Prerequisite","text":"Preprocessed R objectsPreprocessed phyloseq objectsEither R phyloseq objects can used input data.","code":""},{"path":"dimensionality-reduction-techniques.html","id":"import-libraries-and-data-objects","chapter":"12 Dimensionality Reduction Techniques","heading":"Import libraries and data objects","text":"","code":"set.seed(110912)\n\nlibrary(tidyverse, suppressPackageStartupMessages())\nlibrary(phyloseq)\nlibrary(microbiome)\nlibrary(vegan)\n\ncat(\"\\nSaved RData objects\\n\\n\")\n\nSaved RData objects\nload(\"../imap-data-preparation/data/phyloseq_raw_rel_psextra_df_objects.rda\", verbose = T)\nLoading objects:\n  ps_raw\n  ps_rel\n  psextra_raw\n  psextra_rel\n  ps_df\nload(\"../imap-data-preparation/data/ps_transformed.rda\", verbose = T)\nLoading objects:\n  ps_asin\n  ps_identity\n  ps_compositional\n  ps_z_otu\n  ps_z_sample\n  ps_log10\n  ps_log10p\n  ps_clr\n  ps_shift\n  ps_scale\nload(\"../imap-data-preparation/data/bray_distances.rda\", verbose = T)\nLoading objects:\n  ps_asin_bray_dist\n  ps_compositional_bray_dist\n  ps_z_otu_bray_dist\n  ps_z_sample_bray_dist\n  ps_log10_bray_dist\n  ps_log10p_bray_dist\n  ps_clr_bray_dist\n  ps_shift_bray_dist\n  ps_scale_bray_dist"},{"path":"dimensionality-reduction-techniques.html","id":"pca-principal-component-analysis","chapter":"12 Dimensionality Reduction Techniques","heading":"12.1 PCA (Principal Component Analysis)","text":"PCA dimensionality reduction technique commonly used explore patterns structure high-dimensional data. works transforming original variables new set uncorrelated variables called principal components. principal components capture maximum variance data, allowing visualization exploration major patterns clusters within dataset.","code":"\n# Sample R code for PCA with distance matrices\nlibrary(stats)\n\n# Assuming 'distance_matrix' is your distance matrix between samples\npca_asin_bray_metrics <- prcomp(ps_asin_bray_dist)"},{"path":"dimensionality-reduction-techniques.html","id":"mds-multidimensional-scaling","chapter":"12 Dimensionality Reduction Techniques","heading":"12.2 MDS (Multidimensional Scaling)","text":"MDS method visualizing similarities dissimilarities samples lower-dimensional space. aims preserve pairwise distances dissimilarities samples much possible, representing data reduced-dimensional space maintaining overall structure. MDS particularly useful exploring overall structure complex datasets identifying sample clusters gradients based ecological distances dissimilarity measures.","code":"\n# Sample R code for MDS with distance matrices\nlibrary(stats)\n\n# Assuming 'distance_matrix' is your distance matrix between samples\nmds_asin_bray_metrics <- cmdscale(ps_asin_bray_dist)"},{"path":"dimensionality-reduction-techniques.html","id":"pcoa-principal-coordinates-analysis","chapter":"12 Dimensionality Reduction Techniques","heading":"12.3 PCoA (Principal Coordinates Analysis)","text":"Principal Coordinates Analysis (PCoA), also known classical multidimensional scaling (MDS), dimensionality reduction technique commonly used ecology fields visualize explore patterns distance dissimilarity data. PCoA takes distance dissimilarity matrix input transforms set orthogonal axes (principal coordinates) capture maximum variation data. principal coordinates represent lower-dimensional representation original data preserving pairwise distances samples much possible. PCoA particularly useful visualizing interpreting relationships samples based similarities dissimilarities, facilitating identification clusters, gradients, patterns complex datasets","code":"\n# Sample R code for MDS with distance matrices\nlibrary(vegan)\n\n# Assuming 'distance_matrix' is your distance matrix between samples\npcoa_asin_bray_metrics <- capscale(ps_asin_bray_dist ~ 1)"},{"path":"dimensionality-reduction-techniques.html","id":"t-sne-t-distributed-stochastic-neighbor-embedding","chapter":"12 Dimensionality Reduction Techniques","heading":"12.4 t-SNE (t-Distributed Stochastic Neighbor Embedding)","text":"t-SNE nonlinear dimensionality reduction technique aims preserve local global relationships samples lower-dimensional space. particularly effective visualizing high-dimensional data two three dimensions, capturing fine-scale structure clustering within dataset. t-SNE works modeling similarities samples high-dimensional space mapping lower-dimensional space minimizing Kullback-Leibler divergence two distributions. commonly used exploratory data analysis visualization complex datasets, including microbiome abundance data.","code":"\n# Sample R code for t-SNE with distance matrices\nlibrary(Rtsne)\n\n# Assuming 'distance_matrix' is your distance matrix between samples\ntsne_asin_bray_metrics <- Rtsne(as.dist(ps_asin_bray_dist))\nsave(pca_asin_bray_metrics, mds_asin_bray_metrics, pcoa_asin_bray_metrics, tsne_asin_bray_metrics, file = \"data/reduced_dimension.rda\")"},{"path":"dimensionality-reduction-techniques.html","id":"non-negative-matrix-factorization-nmf","chapter":"12 Dimensionality Reduction Techniques","heading":"12.5 Non-negative Matrix Factorization (NMF)","text":"NMF dimensionality reduction technique factorizes non-negative matrix two lower-dimensional matrices non-negative elements. microbiome analysis, NMF can applied identify latent features microbial signatures within complex microbial community data, facilitating identification microbial co-occurrence patterns functional groups.","code":""},{"path":"dimensionality-reduction-techniques.html","id":"redundancy-analysis-rda","chapter":"12 Dimensionality Reduction Techniques","heading":"12.6 Redundancy Analysis (RDA)","text":"RDA multivariate statistical technique used explore relationships multiple response variables (e.g., microbial taxa) explanatory variables (e.g., environmental metadata factors). microbiome analysis, RDA can applied identify microbial taxa associated specific environmental gradients experimental conditions, providing insights ecological drivers shaping microbial composition.","code":"\n# Sample R code for RDA with distance matrices\nlibrary(vegan)\n\n# Assuming 'distance_matrix' is your distance matrix between samples\nrda_metrics <- rda(ps_asin)"},{"path":"dimensionality-reduction-techniques.html","id":"canonical-correspondence-analysis-cca","chapter":"12 Dimensionality Reduction Techniques","heading":"12.7 Canonical Correspondence Analysis (CCA)","text":"CCA multivariate technique similar RDA specifically designed analyzing relationships species data (e.g., microbial taxa) environmental variables. microbiome analysis, CCA can used identify microbial taxa strongly correlated environmental metadata factors, helping understand microbial communities respond different ecological conditions.","code":""},{"path":"dimensionality-reduction-techniques.html","id":"random-forests","chapter":"12 Dimensionality Reduction Techniques","heading":"12.8 Random Forests","text":"Random Forests machine learning algorithm can applied feature selection dimensionality reduction microbiome data. works constructing ensemble decision trees aggregating predictions identify important features (e.g., microbial taxa) predicting response variable interest (e.g., disease status). Random Forests can useful identifying key microbial biomarkers associated specific outcomes conditions.","code":""},{"path":"dimensionality-reduction-techniques.html","id":"deep-learning","chapter":"12 Dimensionality Reduction Techniques","heading":"12.9 Deep Learning","text":"Deep learning techniques, deep neural networks, can also applied dimensionality reduction feature extraction microbiome data. techniques ability learn complex patterns representations directly data, potentially uncovering novel insights microbial community structure function. However, deep learning methods may require large amounts data computational resources, interpretability can challenging.methods provide alternative approaches reducing dimensionality microbiome data extracting meaningful information complex microbial community datasets. Depending specific research question characteristics data, different methods may suitable informative.","code":""},{"path":"taxa-prevalence-and-detection.html","id":"taxa-prevalence-and-detection","chapter":"13 Taxa Prevalence and Detection","heading":"13 Taxa Prevalence and Detection","text":"Taxa prevalence detection analysis quantify often taxon present detected across samples study.High prevalence indicates taxon commonly found across many samples.Low prevalence suggests taxon sporadic rare.Analyzing taxa prevalence can provide insights distribution different microbial taxa potential ecological roles.","code":""},{"path":"taxa-prevalence-and-detection.html","id":"understand-sample-and-taxa-sizes","chapter":"13 Taxa Prevalence and Detection","heading":"13.1 Understand sample and taxa sizes","text":"","code":"library(phyloseq)\n\n# Min and max sample and taxa sums: These values are useful when setting up some threshholds.\n\ncat(\"Minimum sample sums:\", min(data.frame(sample_sums(ps_raw))), \"\\n\\n\")\nMinimum sample sums: 1776 \ncat(\"Maximum sample sums:\", max(data.frame(sample_sums(ps_raw))), \"\\n\\n\")\nMaximum sample sums: 28883 \ncat(\"Minimum taxa sums:\", min(data.frame(taxa_sums(ps_raw))), \"\\n\\n\")\nMinimum taxa sums: 0 \ncat(\"Maximum taxa sums:\", max(data.frame(taxa_sums(ps_raw))), \"\\n\\n\")\nMaximum taxa sums: 873314 "},{"path":"taxa-prevalence-and-detection.html","id":"subsetting-microbiome-data-by-taxa-prevalence","chapter":"13 Taxa Prevalence and Detection","heading":"13.2 Subsetting Microbiome Data by Taxa Prevalence","text":"","code":"\nlibrary(phyloseq)\nlibrary(microbiome)\n\n# Define a function to subset microbiome data based on taxa prevalence\nsubset_by_prevalence <- function(ps_raw, prevalence_threshold) {\n  # Calculate taxa prevalence across samples\n  taxa_prevalence <- prevalence(ps_raw)\n  \n  # Subset taxa based on prevalence threshold\n  taxa_to_keep <- rownames(taxa_prevalence)[taxa_prevalence >= prevalence_threshold]\n  \n  # Subset microbiome data\n  ps_subset <- prune_taxa(taxa_to_keep, ps_raw)\n  \n  return(ps_subset)\n}\n\n# Example usage: Subset microbiome data with a prevalence threshold of 0.1 (10%)\nps_subset <- subset_by_prevalence(ps_raw, 0.9)"},{"path":"imap-github-repos.html","id":"imap-github-repos","chapter":"A IMAP GitHub Repos","heading":"A IMAP GitHub Repos","text":"","code":""},{"path":"session-information.html","id":"session-information","chapter":"B Session Information","heading":"B Session Information","text":"Reproducibility relies ability precisely recreate working environment, session information serves vital reference achieve consistency. record details R environment, package versions, system settings computing environment time analysis.","code":"\nlibrary(sessioninfo)\n\n# Get session info\ninfo <- capture.output(print(session_info()))\n\n# Define patterns to exclude\nexclude_patterns <- c(\"/Users/.*\", \"Africa/Dar_es_Salaam\") # This line is location-dependent\n\n# Exclude lines containing specific information\ninfo_filtered <- info[!grepl(paste(exclude_patterns, collapse = \"|\"), info)]\n\n# Save the filtered session info to a text file in the root directory without line numbers\ncat(info_filtered, file = \"session_info.txt\", sep = \"\\n\")"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
