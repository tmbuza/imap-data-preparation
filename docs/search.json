[{"path":"index.html","id":"data-preparation","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"IMAP-Part 07: Microbiome Data Preparation Guide","text":"","code":""},{"path":"index.html","id":"welcome-to-chapter-7","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Welcome to chapter 7","text":"Welcome “Microbiome Data Preparation Guide.” comprehensive guide tailored researchers analysts engaged microbiome studies, providing essential insights methodologies effective data preparation. Assuming bioinformatics analysis phase successfully completed now possess output features tables, including Operational Taxonomic Unit (OTU) tables, taxonomy tables, metadata table, platforms Mothur Qiime2, guide lead crucial steps refining optimizing microbiome data.","code":""},{"path":"index.html","id":"why-data-preparation-matters","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Why Data Preparation Matters","text":"Microbiome analysis hinges quality integrity data. researchers analysts, intricate process data preparation paramount ensuring reliability downstream analyses accuracy biological interpretations. guide acknowledges diverse skill levels readers, accommodating novice researchers seeking foundational knowledge experienced analysts looking advanced strategies.","code":""},{"path":"index.html","id":"using-otu-and-taxonomy-tables","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Using OTU and Taxonomy Tables","text":"chapter, delve practical aspects using Operational Taxonomic Unit (OTU) tables taxonomy tables inputs downstream analysis. tables, derived bioinformatics phase, serve key components exploring composition diversity microbial communities. learn effectively clean, transform, integrate tables prepare range downstream analyses.","code":""},{"path":"index.html","id":"integrating-metadata-for-context","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"Integrating Metadata for Context","text":"integration metadata table enhances analytical capabilities allowing group observations based relevant variables. integration provides context microbiome data also enables explore impact different conditions factors microbial community composition. guide, ’ll demonstrate seamlessly incorporate metadata, unlocking valuable insights relationships microbial communities external variables.","code":""},{"path":"index.html","id":"what-to-expect","chapter":"IMAP-Part 07: Microbiome Data Preparation Guide","heading":"What to Expect","text":"Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring can follow along seamlessly.Step--Step Instructions: section guide presents clear concise step--step instructions, ensuring can follow along seamlessly.Best Practices: Explore best practices data cleaning, transformation, integration, emphasis optimizing microbiome datasets robust analysis.Best Practices: Explore best practices data cleaning, transformation, integration, emphasis optimizing microbiome datasets robust analysis.Practical Insights: Beyond technical instructions, guide provides practical insights help navigate nuanced decisions data preparation, empowering make informed choices align research goals.Practical Insights: Beyond technical instructions, guide provides practical insights help navigate nuanced decisions data preparation, empowering make informed choices align research goals.Whether delving world microbial communities first time seeking advanced strategies refine microbiome data, guide companion. embark journey, commitment data preparation pivotal extracting meaningful biological insights contributing advancement microbiome research.Let’s dive !","code":""},{"path":"preface.html","id":"preface","chapter":"1 Preparing for Downstream Analysis","heading":"1 Preparing for Downstream Analysis","text":"preface, set stage -depth exploration intricacies preparing microbiome data. foundation downstream analyses, effective data preparation essential extracting meaningful biological insights. guide addresses technical aspects data cleaning, transformation, integration also offers practical insights guide researchers nuanced decisions involved optimizing microbiome datasets. Whether ’re novice experienced researcher, embark journey elevate quality reliability microbiome analysis.","code":""},{"path":"preface.html","id":"import-library","chapter":"1 Preparing for Downstream Analysis","heading":"1.1 Import library","text":"","code":"library(tidyverse, suppressPackageStartupMessages())\n"},{"path":"preface.html","id":"mothur-metadata","chapter":"1 Preparing for Downstream Analysis","heading":"1.2 Mothur metadata","text":"","code":"library(tidyverse, suppressPackageStartupMessages())\n"},{"path":"preface.html","id":"mothur-otutable","chapter":"1 Preparing for Downstream Analysis","heading":"1.3 Mothur otutable","text":"","code":""},{"path":"preface.html","id":"mothur-taxonomy","chapter":"1 Preparing for Downstream Analysis","heading":"1.4 Mothur taxonomy","text":"","code":""},{"path":"preface.html","id":"mothur-composite","chapter":"1 Preparing for Downstream Analysis","heading":"1.5 Mothur composite","text":"","code":""},{"path":"preface.html","id":"qiime2-metadata","chapter":"1 Preparing for Downstream Analysis","heading":"1.6 QIIME2 metadata","text":"","code":"\nif (!dir.exists('data')) {dir.create('data')}\nif (!dir.exists('data/mothur')) {dir.create('data/mothur')}\nif (!dir.exists('data/qiime2')) {dir.create('data/qiime2')}\n\nlibrary(tidyverse, suppressPackageStartupMessages())## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n## ✔ dplyr     1.1.4     ✔ readr     2.1.5\n## ✔ forcats   1.0.0     ✔ stringr   1.5.1\n## ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n## ✔ purrr     1.0.2     \n## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## ✖ dplyr::filter() masks stats::filter()\n## ✖ dplyr::lag()    masks stats::lag()\n## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors"},{"path":"qiime2-metadata-1.html","id":"qiime2-metadata-1","chapter":"2 QIIME2 metadata","heading":"2 QIIME2 metadata","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/resources/metadata/qiime2_sample_metadata.tsv\", show_col_types = FALSE) %>% \n  dplyr::rename(sample_id=\"sample-id\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_metadata.csv\")"},{"path":"qiime2-metadata-1.html","id":"qiime2-otutable","chapter":"2 QIIME2 metadata","heading":"2.1 QIIME2 otutable","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/feature-table.tsv\", skip = 1, show_col_types = FALSE) %>%\n  dplyr::rename(feature='#OTU ID') %>%\n  select(-starts_with('Mock')) %>% \n  mutate_at(2:ncol(.), as.numeric) %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>% \n  pivot_longer(-feature, names_to = \"sample_id\", values_to = \"count\") %>% \n  relocate(sample_id, .before = feature) %>% \n  write_csv(\"data/qiime2/qiime2_tidy_otutable.csv\")"},{"path":"qiime2-metadata-1.html","id":"qiime2-taxonomy","chapter":"2 QIIME2 metadata","heading":"2.2 QIIME2 taxonomy","text":"","code":"\nread_tsv(\"../imap-qiime2-bioinformatics/qiime2_process/export/taxonomy.tsv\", show_col_types=FALSE) %>% \n  dplyr::rename(feature=\"Feature ID\") %>% \n  distinct() %>%\n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  mutate(Taxon = str_replace_all(Taxon, \"; s__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; g__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; f__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; o__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; c__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; p__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"; k__$\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\[|\\\\]\", \"\"),\n         Taxon = str_replace_all(Taxon, \"\\\\s\", \"\")) %>%\n  dplyr::filter(!grepl(\"s__*\", Taxon)) %>%\n  dplyr::filter(grepl(\"g__*\", Taxon)) %>% \n  select(-Confidence) %>% \n  mutate(Taxon = str_replace_all(Taxon, \"\\\\w__\", \"\")) %>% \n  separate(Taxon, into = c(\"Kingdom\", \"Phylum\", \"Class\", \"Order\", \"Family\", \"Genus\"), sep = \";\") %>% \n  write_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\")"},{"path":"qiime2-metadata-1.html","id":"qiime2-composite","chapter":"2 QIIME2 metadata","heading":"2.3 QIIME2 composite","text":"","code":"\n# QIIME2 composite\nlibrary(tidyverse, suppressPackageStartupMessages())\n\nqiime2_tidy_metadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\", show_col_types = FALSE)\nqiime2_tidy_otutable <- read_csv(\"data/qiime2/qiime2_tidy_otutable.csv\", show_col_types = FALSE)\nqiime2_tidy_taxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE)\n\nqiime2_composite <- inner_join(qiime2_tidy_metadata, qiime2_tidy_otutable, by = \"sample_id\") %>% \n  inner_join(., qiime2_tidy_taxonomy, by = \"feature\") %>% \n  group_by(sample_id) %>% \n  mutate(rel_abund = count/sum(count)) %>% \n  ungroup() %>% \n  mutate_if(is.numeric, ~replace(., is.na(.), 0)) %>%\n  relocate(count, .before = rel_abund) \n\nwrite_csv(qiime2_composite, \"data/qiime2/qiime2_composite.csv\")"},{"path":"qiime2-metadata-1.html","id":"create-a-phyloseq-object","chapter":"2 QIIME2 metadata","heading":"2.4 Create a phyloseq object","text":"","code":"\nlibrary(tidyverse)\nlibrary(phyloseq)## Warning in .recacheSubclasses(def@className, def, env): undefined subclass\n## \"ndiMatrix\" of class \"replValueSp\"; definition not updated\nlibrary(microbiome)## \n## microbiome R package (microbiome.github.com)\n##     \n## \n## \n##  Copyright (C) 2011-2022 Leo Lahti, \n##     Sudarshan Shetty et al. <microbiome.github.io>## \n## Attaching package: 'microbiome'## The following object is masked from 'package:ggplot2':\n## \n##     alpha## The following object is masked from 'package:base':\n## \n##     transform\nlibrary(ape)## \n## Attaching package: 'ape'## The following object is masked from 'package:dplyr':\n## \n##     where\nmetadata <- read_csv(\"data/qiime2/qiime2_tidy_metadata.csv\",show_col_types = FALSE) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  sample_data(metadata)\n\notutable <- read_csv(\"data/qiime2/qiime2_tidy_features.csv\",show_col_types = FALSE) %>% \n  pivot_wider(id_cols = sample_id, names_from = feature, values_from = count) %>% \n  tibble::column_to_rownames(\"sample_id\") %>% \n  otu_table(otutable, taxa_are_rows = FALSE)\n\ntaxonomy <- read_csv(\"data/qiime2/qiime2_tidy_taxonomy.csv\", show_col_types = FALSE) %>%\n  tibble::column_to_rownames(\"feature\") %>%\n  as.matrix() %>% \n  tax_table(taxonomy)\n\nps_raw_basic <- merge_phyloseq(metadata, otutable, taxonomy)\n\nlibrary(ape)\nps_tree = rtree(ntaxa(ps_raw_basic), rooted=TRUE, tip.label=taxa_names(ps_raw_basic))\nps_raw <- phyloseq::merge_phyloseq(ps_raw_basic, ps_tree)\n\nps_rel <- phyloseq::transform_sample_counts(ps_raw, function(x){x / sum(x)})\n\nsave(ps_tree, ps_raw, ps_rel,  file = \"data/qiime2/qiime2_phyloseq_objects.rda\")"},{"path":"qiime2-metadata-1.html","id":"confirm-the-phyloseq-object","chapter":"2 QIIME2 metadata","heading":"2.5 Confirm the phyloseq object","text":"","code":"\nps_raw## phyloseq-class experiment-level object\n## otu_table()   OTU Table:         [ 95 taxa and 128 samples ]\n## sample_data() Sample Data:       [ 128 samples by 12 sample variables ]\n## tax_table()   Taxonomy Table:    [ 95 taxa by 6 taxonomic ranks ]\n## phy_tree()    Phylogenetic Tree: [ 95 tips and 94 internal nodes ]"},{"path":"imap-github-repos.html","id":"imap-github-repos","chapter":"A IMAP GitHub Repos","heading":"A IMAP GitHub Repos","text":"","code":""},{"path":"data-preparation-rulegraph.html","id":"data-preparation-rulegraph","chapter":"B Data Preparation Rulegraph","heading":"B Data Preparation Rulegraph","text":"","code":""},{"path":"session-information.html","id":"session-information","chapter":"C Session Information","heading":"C Session Information","text":"Reproducibility relies ability precisely recreate working environment, session information serves vital reference achieve consistency. record details R environment, package versions, system settings computing environment time analysis.detailed overview tools versions suitable guide, encourage explore session information saved accompanying text file named resources/session_info.txt,","code":"\nlibrary(knitr)\nlibrary(sessioninfo)\n\n# Get session info\ninfo <- capture.output(print(session_info()))\n\n# Create the 'resources' folder if it doesn't exist\nif (!dir.exists(\"resources\")) {\n  dir.create(\"resources\")\n}\n\n# Save the session information to a text file without line numbers\ncat(info, file = \"resources/session_info.txt\", sep = \"\\n\")"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"Last updated February 19, 2024.\nGithub_Repo: https://github.com/datainsights/imap-project-overview\nRepo compiled maintained : Teresia Mrema-Buza.\nrelated info, visit CDI website (…progress).","code":""}]
