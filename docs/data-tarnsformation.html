<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Data Tranformation from Phyloseq Objects | IMAP: Integrated Microbiome Analysis Pipelines</title>
<meta name="author" content="Teresia Mrema-Buza">
<meta name="description" content="The process of data transformation in microbiome analysis involves converting raw or relative abundance values into matrices that are suitable for further analysis. Data transformation focuses on...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="9 Data Tranformation from Phyloseq Objects | IMAP: Integrated Microbiome Analysis Pipelines">
<meta property="og:type" content="book">
<meta property="og:url" content="https://tmbuza.github.io/imap-data-preparation/data-tarnsformation.html">
<meta property="og:image" content="https://tmbuza.github.io/imap-data-preparation/images/planning.png">
<meta property="og:description" content="The process of data transformation in microbiome analysis involves converting raw or relative abundance values into matrices that are suitable for further analysis. Data transformation focuses on...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Data Tranformation from Phyloseq Objects | IMAP: Integrated Microbiome Analysis Pipelines">
<meta name="twitter:description" content="The process of data transformation in microbiome analysis involves converting raw or relative abundance values into matrices that are suitable for further analysis. Data transformation focuses on...">
<meta name="twitter:image" content="https://tmbuza.github.io/imap-data-preparation/images/planning.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Sen-0.4.8/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=DM%20Mono&amp;display=swap" rel="stylesheet">
<link href="libs/Bitter-0.4.8/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="End-to-End Practical User Guides Using Integrated Approaches"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a>:
        <small class="text-muted">End-to-End Practical User Guides Using Integrated Approaches</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">IMAP-Part 07: Microbiome Data Preparation Guide</a></li>
<li class="book-part">GETTING STARTED</li>
<li><a class="" href="preface.html">Preparing for Downstream Analysis</a></li>
<li><a class="" href="data-tidying.html"><span class="header-section-number">1</span> Data Tidying</a></li>
<li class="book-part">MOTHUR OUTPUT</li>
<li><a class="" href="prepare-mothur-output.html"><span class="header-section-number">2</span> Prepare Mothur Output</a></li>
<li class="book-part">QIIME2 OUTPUT</li>
<li><a class="" href="prepare-qiime2-output.html"><span class="header-section-number">3</span> Prepare Qiime2 Output</a></li>
<li class="book-part">PHYLOSEQ OBJECTS</li>
<li><a class="" href="creating-phyloseq-objects.html"><span class="header-section-number">4</span> Creating phyloseq Objects</a></li>
<li class="book-part">EXTERNAL DATASETS</li>
<li><a class="" href="phyloseq-objects-demo-datasets.html"><span class="header-section-number">5</span> Phyloseq Objects Demo Datasets</a></li>
<li class="book-part">PHYLOSEQ FUNCTIONS</li>
<li><a class="" href="reviewing-phyloseq-objects.html"><span class="header-section-number">6</span> Reviewing Phyloseq Objects</a></li>
<li class="book-part">PHYLOSEQ EXTRA OBJECTS</li>
<li><a class="" href="create-psextra-objects.html"><span class="header-section-number">7</span> Create psExtra Objects</a></li>
<li class="book-part">CLEANING PHYLOSEQ OBJECT</li>
<li><a class="" href="pipeline-for-cleaning-phyloseq-objects.html"><span class="header-section-number">8</span> Pipeline for Cleaning Phyloseq Objects</a></li>
<li class="book-part">DATA TRANSFORMATION</li>
<li><a class="active" href="data-tarnsformation.html"><span class="header-section-number">9</span> Data Tranformation from Phyloseq Objects</a></li>
<li class="book-part">DISTANCES MATRICES</li>
<li><a class="" href="distance-calculation-in-microbiome-data-analysis.html"><span class="header-section-number">10</span> Distance Calculation in Microbiome Data Analysis</a></li>
<li><a class="" href="utilizing-transformed-data.html"><span class="header-section-number">11</span> Whatâ€™s Next: Utilizing Transformed Data</a></li>
<li class="book-part">DIMENSIONALITY REDUCTION</li>
<li><a class="" href="dimensionality-reduction-techniques.html"><span class="header-section-number">12</span> Dimensionality Reduction Techniques</a></li>
<li><a class="" href="taxa-prevalence-and-detection.html"><span class="header-section-number">13</span> Taxa Prevalence and Detection</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="imap-github-repos.html"><span class="header-section-number">A</span> IMAP GitHub Repos</a></li>
<li><a class="" href="session-information.html"><span class="header-section-number">B</span> Session Information</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/tmbuza/imap-data-preparation.git">View book source <i class="fas fa-air-freshener"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-tarnsformation" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Data Tranformation from Phyloseq Objects<a class="anchor" aria-label="anchor" href="#data-tarnsformation"><i class="fas fa-link"></i></a>
</h1>
<p>The process of data transformation in microbiome analysis involves converting raw or relative abundance values into matrices that are suitable for further analysis. Data transformation focuses on modifying the data itself. In this context, we will explore various methods used for this transformation on a phyloseq object.</p>
<div id="import-processed-phyloseq-object" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Import processed phyloseq object<a class="anchor" aria-label="anchor" href="#import-processed-phyloseq-object"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="data-tarnsformation.html#cb50-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../imap-data-preparation/data/phyloseq_raw_rel_psextra_df_objects.rda"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>) </span>
<span id="cb50-2"><a href="data-tarnsformation.html#cb50-2" tabindex="-1"></a>Loading objects<span class="sc">:</span></span>
<span id="cb50-3"><a href="data-tarnsformation.html#cb50-3" tabindex="-1"></a>  ps_raw</span>
<span id="cb50-4"><a href="data-tarnsformation.html#cb50-4" tabindex="-1"></a>  ps_rel</span>
<span id="cb50-5"><a href="data-tarnsformation.html#cb50-5" tabindex="-1"></a>  psextra_raw</span>
<span id="cb50-6"><a href="data-tarnsformation.html#cb50-6" tabindex="-1"></a>  psextra_rel</span>
<span id="cb50-7"><a href="data-tarnsformation.html#cb50-7" tabindex="-1"></a>  ps_df</span></code></pre></div>
</div>
<div id="raw-abundance" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Raw Abundance<a class="anchor" aria-label="anchor" href="#raw-abundance"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data-tarnsformation.html#cb51-1" tabindex="-1"></a>ps_raw <span class="ot">&lt;-</span> psextra_raw</span>
<span id="cb51-2"><a href="data-tarnsformation.html#cb51-2" tabindex="-1"></a><span class="fu">otu_table</span>(ps_raw)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb51-3"><a href="data-tarnsformation.html#cb51-3" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">10</span> taxa and <span class="dv">10</span> samples]</span>
<span id="cb51-4"><a href="data-tarnsformation.html#cb51-4" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb51-5"><a href="data-tarnsformation.html#cb51-5" tabindex="-1"></a>                       Sample<span class="dv">-1</span> Sample<span class="dv">-2</span> Sample<span class="dv">-3</span> Sample<span class="dv">-4</span> Sample<span class="dv">-5</span> Sample<span class="dv">-6</span></span>
<span id="cb51-6"><a href="data-tarnsformation.html#cb51-6" tabindex="-1"></a>Eubacterium limosum           <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span></span>
<span id="cb51-7"><a href="data-tarnsformation.html#cb51-7" tabindex="-1"></a>Staphylococcus                <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span></span>
<span id="cb51-8"><a href="data-tarnsformation.html#cb51-8" tabindex="-1"></a>Oceanospirillum               <span class="dv">1</span>        <span class="dv">2</span>        <span class="dv">1</span>        <span class="dv">2</span>        <span class="dv">1</span>        <span class="dv">1</span></span>
<span id="cb51-9"><a href="data-tarnsformation.html#cb51-9" tabindex="-1"></a>Ruminococcus obeum           <span class="dv">89</span>      <span class="dv">901</span>      <span class="dv">620</span>      <span class="dv">476</span>      <span class="dv">457</span>      <span class="dv">375</span></span>
<span id="cb51-10"><a href="data-tarnsformation.html#cb51-10" tabindex="-1"></a>Burkholderia                  <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">2</span>        <span class="dv">0</span>        <span class="dv">2</span>        <span class="dv">1</span></span>
<span id="cb51-11"><a href="data-tarnsformation.html#cb51-11" tabindex="-1"></a>Clostridium sphenoides       <span class="dv">41</span>      <span class="dv">127</span>      <span class="dv">133</span>       <span class="dv">63</span>       <span class="dv">94</span>       <span class="dv">90</span></span>
<span id="cb51-12"><a href="data-tarnsformation.html#cb51-12" tabindex="-1"></a>Fusobacteria                  <span class="dv">4</span>        <span class="dv">5</span>        <span class="dv">5</span>        <span class="dv">5</span>        <span class="dv">5</span>        <span class="dv">8</span></span>
<span id="cb51-13"><a href="data-tarnsformation.html#cb51-13" tabindex="-1"></a>Bifidobacterium              <span class="dv">43</span>       <span class="dv">25</span>      <span class="dv">183</span>      <span class="dv">493</span>       <span class="dv">22</span>       <span class="dv">24</span></span>
<span id="cb51-14"><a href="data-tarnsformation.html#cb51-14" tabindex="-1"></a>Methylobacterium              <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span></span>
<span id="cb51-15"><a href="data-tarnsformation.html#cb51-15" tabindex="-1"></a>Clostridium ramosum           <span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">2</span></span>
<span id="cb51-16"><a href="data-tarnsformation.html#cb51-16" tabindex="-1"></a>                       Sample<span class="dv">-7</span> Sample<span class="dv">-8</span> Sample<span class="dv">-9</span> Sample<span class="dv">-10</span></span>
<span id="cb51-17"><a href="data-tarnsformation.html#cb51-17" tabindex="-1"></a>Eubacterium limosum           <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span>         <span class="dv">1</span></span>
<span id="cb51-18"><a href="data-tarnsformation.html#cb51-18" tabindex="-1"></a>Staphylococcus                <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb51-19"><a href="data-tarnsformation.html#cb51-19" tabindex="-1"></a>Oceanospirillum               <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span>         <span class="dv">2</span></span>
<span id="cb51-20"><a href="data-tarnsformation.html#cb51-20" tabindex="-1"></a>Ruminococcus obeum          <span class="dv">661</span>      <span class="dv">444</span>      <span class="dv">339</span>       <span class="dv">599</span></span>
<span id="cb51-21"><a href="data-tarnsformation.html#cb51-21" tabindex="-1"></a>Burkholderia                  <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">0</span>         <span class="dv">1</span></span>
<span id="cb51-22"><a href="data-tarnsformation.html#cb51-22" tabindex="-1"></a>Clostridium sphenoides      <span class="dv">153</span>       <span class="dv">92</span>       <span class="dv">55</span>        <span class="dv">84</span></span>
<span id="cb51-23"><a href="data-tarnsformation.html#cb51-23" tabindex="-1"></a>Fusobacteria                  <span class="dv">5</span>        <span class="dv">5</span>        <span class="dv">4</span>         <span class="dv">5</span></span>
<span id="cb51-24"><a href="data-tarnsformation.html#cb51-24" tabindex="-1"></a>Bifidobacterium             <span class="dv">116</span>       <span class="dv">62</span>      <span class="dv">151</span>        <span class="dv">20</span></span>
<span id="cb51-25"><a href="data-tarnsformation.html#cb51-25" tabindex="-1"></a>Methylobacterium              <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span>         <span class="dv">0</span></span>
<span id="cb51-26"><a href="data-tarnsformation.html#cb51-26" tabindex="-1"></a>Clostridium ramosum           <span class="dv">3</span>        <span class="dv">2</span>        <span class="dv">2</span>         <span class="dv">2</span></span></code></pre></div>
</div>
<div id="no-transformation" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> No Transformation<a class="anchor" aria-label="anchor" href="#no-transformation"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>Similar to raw abundance</p>
</blockquote>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="data-tarnsformation.html#cb52-1" tabindex="-1"></a>(ps_identity <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'identity'</span>))</span>
<span id="cb52-2"><a href="data-tarnsformation.html#cb52-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb52-3"><a href="data-tarnsformation.html#cb52-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb52-4"><a href="data-tarnsformation.html#cb52-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb52-5"><a href="data-tarnsformation.html#cb52-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb52-6"><a href="data-tarnsformation.html#cb52-6" tabindex="-1"></a></span>
<span id="cb52-7"><a href="data-tarnsformation.html#cb52-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb52-8"><a href="data-tarnsformation.html#cb52-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_identity)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb52-9"><a href="data-tarnsformation.html#cb52-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb52-10"><a href="data-tarnsformation.html#cb52-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb52-11"><a href="data-tarnsformation.html#cb52-11" tabindex="-1"></a>                    Sample<span class="dv">-1</span> Sample<span class="dv">-2</span> Sample<span class="dv">-3</span></span>
<span id="cb52-12"><a href="data-tarnsformation.html#cb52-12" tabindex="-1"></a>Eubacterium limosum        <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span></span>
<span id="cb52-13"><a href="data-tarnsformation.html#cb52-13" tabindex="-1"></a>Staphylococcus             <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span></span>
<span id="cb52-14"><a href="data-tarnsformation.html#cb52-14" tabindex="-1"></a>Oceanospirillum            <span class="dv">1</span>        <span class="dv">2</span>        <span class="dv">1</span></span>
<span id="cb52-15"><a href="data-tarnsformation.html#cb52-15" tabindex="-1"></a>Ruminococcus obeum        <span class="dv">89</span>      <span class="dv">901</span>      <span class="dv">620</span></span>
<span id="cb52-16"><a href="data-tarnsformation.html#cb52-16" tabindex="-1"></a>Burkholderia               <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">2</span></span></code></pre></div>
</div>
<div id="relative-abundance" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Relative abundance<a class="anchor" aria-label="anchor" href="#relative-abundance"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data-tarnsformation.html#cb53-1" tabindex="-1"></a>(<span class="at">ps_rel =</span> phyloseq<span class="sc">::</span><span class="fu">transform_sample_counts</span>(ps_raw, <span class="cf">function</span>(x){x <span class="sc">/</span> <span class="fu">sum</span>(x)}))</span>
<span id="cb53-2"><a href="data-tarnsformation.html#cb53-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb53-3"><a href="data-tarnsformation.html#cb53-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb53-4"><a href="data-tarnsformation.html#cb53-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb53-5"><a href="data-tarnsformation.html#cb53-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb53-6"><a href="data-tarnsformation.html#cb53-6" tabindex="-1"></a></span>
<span id="cb53-7"><a href="data-tarnsformation.html#cb53-7" tabindex="-1"></a><span class="fu">otu_table</span>(ps_rel)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb53-8"><a href="data-tarnsformation.html#cb53-8" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb53-9"><a href="data-tarnsformation.html#cb53-9" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb53-10"><a href="data-tarnsformation.html#cb53-10" tabindex="-1"></a>                        Sample<span class="dv">-1</span>     Sample<span class="dv">-2</span>     Sample<span class="dv">-3</span></span>
<span id="cb53-11"><a href="data-tarnsformation.html#cb53-11" tabindex="-1"></a>Eubacterium limosum <span class="fl">0.0001182173</span> <span class="fl">4.742483e-05</span> <span class="fl">3.462244e-05</span></span>
<span id="cb53-12"><a href="data-tarnsformation.html#cb53-12" tabindex="-1"></a>Staphylococcus      <span class="fl">0.0000000000</span> <span class="fl">0.000000e+00</span> <span class="fl">0.000000e+00</span></span>
<span id="cb53-13"><a href="data-tarnsformation.html#cb53-13" tabindex="-1"></a>Oceanospirillum     <span class="fl">0.0001182173</span> <span class="fl">9.484966e-05</span> <span class="fl">3.462244e-05</span></span>
<span id="cb53-14"><a href="data-tarnsformation.html#cb53-14" tabindex="-1"></a>Ruminococcus obeum  <span class="fl">0.0105213382</span> <span class="fl">4.272977e-02</span> <span class="fl">2.146591e-02</span></span>
<span id="cb53-15"><a href="data-tarnsformation.html#cb53-15" tabindex="-1"></a>Burkholderia        <span class="fl">0.0001182173</span> <span class="fl">4.742483e-05</span> <span class="fl">6.924488e-05</span></span></code></pre></div>
</div>
<div id="arc-sine-asin-transformation" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Arc sine (asin) transformation<a class="anchor" aria-label="anchor" href="#arc-sine-asin-transformation"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Typically used when dealing with proportional and percentages.</li>
<li>Proportionals range from 0 to 1</li>
<li>Percentages range from 0 to 100</li>
<li>The Metaphlan3 relative abundances are in percentages! That means the column totals in 100.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data-tarnsformation.html#cb54-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">otu_table</span>(ps_rel)</span>
<span id="cb54-2"><a href="data-tarnsformation.html#cb54-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">/</span><span class="fu">max</span>(x)</span>
<span id="cb54-3"><a href="data-tarnsformation.html#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="data-tarnsformation.html#cb54-4" tabindex="-1"></a>ps_asin <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">asin</span>(<span class="fu">sqrt</span>(y)), <span class="dv">6</span>)</span>
<span id="cb54-5"><a href="data-tarnsformation.html#cb54-5" tabindex="-1"></a></span>
<span id="cb54-6"><a href="data-tarnsformation.html#cb54-6" tabindex="-1"></a>ps_asin <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(ps_asin)</span>
<span id="cb54-7"><a href="data-tarnsformation.html#cb54-7" tabindex="-1"></a>ps_asin[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb54-8"><a href="data-tarnsformation.html#cb54-8" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">4</span> samples]</span>
<span id="cb54-9"><a href="data-tarnsformation.html#cb54-9" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb54-10"><a href="data-tarnsformation.html#cb54-10" tabindex="-1"></a>                    Sample<span class="dv">-1</span> Sample<span class="dv">-2</span> Sample<span class="dv">-3</span> Sample<span class="dv">-4</span></span>
<span id="cb54-11"><a href="data-tarnsformation.html#cb54-11" tabindex="-1"></a>Eubacterium limosum <span class="fl">0.012391</span> <span class="fl">0.007848</span> <span class="fl">0.006706</span> <span class="fl">0.009903</span></span>
<span id="cb54-12"><a href="data-tarnsformation.html#cb54-12" tabindex="-1"></a>Staphylococcus      <span class="fl">0.000000</span> <span class="fl">0.000000</span> <span class="fl">0.000000</span> <span class="fl">0.000000</span></span>
<span id="cb54-13"><a href="data-tarnsformation.html#cb54-13" tabindex="-1"></a>Oceanospirillum     <span class="fl">0.012391</span> <span class="fl">0.011099</span> <span class="fl">0.006706</span> <span class="fl">0.014005</span></span>
<span id="cb54-14"><a href="data-tarnsformation.html#cb54-14" tabindex="-1"></a>Ruminococcus obeum  <span class="fl">0.117166</span> <span class="fl">0.237814</span> <span class="fl">0.167759</span> <span class="fl">0.217764</span></span>
<span id="cb54-15"><a href="data-tarnsformation.html#cb54-15" tabindex="-1"></a>Burkholderia        <span class="fl">0.012391</span> <span class="fl">0.007848</span> <span class="fl">0.009484</span> <span class="fl">0.000000</span></span></code></pre></div>
</div>
<div id="compositional-version" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Compositional Version<a class="anchor" aria-label="anchor" href="#compositional-version"><i class="fas fa-link"></i></a>
</h2>
<p>Compositional data represents relative proportions or percentages of different microbial taxa within a sample, rather than the absolute abundance of each taxon. This transformation is necessary because raw abundance data is typically affected by various factors, such as sequencing depth, which can lead to spurious correlations and biases in downstream analyses.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data-tarnsformation.html#cb55-1" tabindex="-1"></a>(ps_compositional <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'compositional'</span>))</span>
<span id="cb55-2"><a href="data-tarnsformation.html#cb55-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb55-3"><a href="data-tarnsformation.html#cb55-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb55-4"><a href="data-tarnsformation.html#cb55-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb55-5"><a href="data-tarnsformation.html#cb55-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb55-6"><a href="data-tarnsformation.html#cb55-6" tabindex="-1"></a></span>
<span id="cb55-7"><a href="data-tarnsformation.html#cb55-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb55-8"><a href="data-tarnsformation.html#cb55-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_compositional)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb55-9"><a href="data-tarnsformation.html#cb55-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb55-10"><a href="data-tarnsformation.html#cb55-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb55-11"><a href="data-tarnsformation.html#cb55-11" tabindex="-1"></a>                        Sample<span class="dv">-1</span>     Sample<span class="dv">-2</span>     Sample<span class="dv">-3</span></span>
<span id="cb55-12"><a href="data-tarnsformation.html#cb55-12" tabindex="-1"></a>Eubacterium limosum <span class="fl">0.0001182173</span> <span class="fl">4.742483e-05</span> <span class="fl">3.462244e-05</span></span>
<span id="cb55-13"><a href="data-tarnsformation.html#cb55-13" tabindex="-1"></a>Staphylococcus      <span class="fl">0.0000000000</span> <span class="fl">0.000000e+00</span> <span class="fl">0.000000e+00</span></span>
<span id="cb55-14"><a href="data-tarnsformation.html#cb55-14" tabindex="-1"></a>Oceanospirillum     <span class="fl">0.0001182173</span> <span class="fl">9.484966e-05</span> <span class="fl">3.462244e-05</span></span>
<span id="cb55-15"><a href="data-tarnsformation.html#cb55-15" tabindex="-1"></a>Ruminococcus obeum  <span class="fl">0.0105213382</span> <span class="fl">4.272977e-02</span> <span class="fl">2.146591e-02</span></span>
<span id="cb55-16"><a href="data-tarnsformation.html#cb55-16" tabindex="-1"></a>Burkholderia        <span class="fl">0.0001182173</span> <span class="fl">4.742483e-05</span> <span class="fl">6.924488e-05</span></span></code></pre></div>
</div>
<div id="z-transform-for-otus" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Z-transform for OTUs<a class="anchor" aria-label="anchor" href="#z-transform-for-otus"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="data-tarnsformation.html#cb56-1" tabindex="-1"></a>(ps_z_otu <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'Z'</span>, <span class="st">'OTU'</span>))</span>
<span id="cb56-2"><a href="data-tarnsformation.html#cb56-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb56-3"><a href="data-tarnsformation.html#cb56-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb56-4"><a href="data-tarnsformation.html#cb56-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb56-5"><a href="data-tarnsformation.html#cb56-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb56-6"><a href="data-tarnsformation.html#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="data-tarnsformation.html#cb56-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb56-8"><a href="data-tarnsformation.html#cb56-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_z_otu)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb56-9"><a href="data-tarnsformation.html#cb56-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb56-10"><a href="data-tarnsformation.html#cb56-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb56-11"><a href="data-tarnsformation.html#cb56-11" tabindex="-1"></a>                      Sample<span class="dv">-1</span>   Sample<span class="dv">-2</span>   Sample<span class="dv">-3</span></span>
<span id="cb56-12"><a href="data-tarnsformation.html#cb56-12" tabindex="-1"></a>Eubacterium limosum <span class="sc">-</span><span class="fl">0.2855358</span> <span class="sc">-</span><span class="fl">0.2855358</span> <span class="sc">-</span><span class="fl">0.2855358</span></span>
<span id="cb56-13"><a href="data-tarnsformation.html#cb56-13" tabindex="-1"></a>Staphylococcus      <span class="sc">-</span><span class="fl">0.2685840</span> <span class="sc">-</span><span class="fl">0.2685840</span> <span class="sc">-</span><span class="fl">0.2685840</span></span>
<span id="cb56-14"><a href="data-tarnsformation.html#cb56-14" tabindex="-1"></a>Oceanospirillum     <span class="sc">-</span><span class="fl">0.5570347</span>  <span class="fl">0.2530445</span> <span class="sc">-</span><span class="fl">0.5570347</span></span>
<span id="cb56-15"><a href="data-tarnsformation.html#cb56-15" tabindex="-1"></a>Ruminococcus obeum  <span class="sc">-</span><span class="fl">0.7310885</span>  <span class="fl">2.1112033</span>  <span class="fl">1.6508691</span></span>
<span id="cb56-16"><a href="data-tarnsformation.html#cb56-16" tabindex="-1"></a>Burkholderia         <span class="fl">0.3632341</span>  <span class="fl">0.3632341</span>  <span class="fl">1.1488042</span></span></code></pre></div>
</div>
<div id="z-transform-for-samples" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Z-transform for Samples<a class="anchor" aria-label="anchor" href="#z-transform-for-samples"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data-tarnsformation.html#cb57-1" tabindex="-1"></a>(ps_z_sample <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'Z'</span>, <span class="st">'sample'</span>))</span>
<span id="cb57-2"><a href="data-tarnsformation.html#cb57-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb57-3"><a href="data-tarnsformation.html#cb57-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb57-4"><a href="data-tarnsformation.html#cb57-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb57-5"><a href="data-tarnsformation.html#cb57-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb57-6"><a href="data-tarnsformation.html#cb57-6" tabindex="-1"></a></span>
<span id="cb57-7"><a href="data-tarnsformation.html#cb57-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb57-8"><a href="data-tarnsformation.html#cb57-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_z_sample)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb57-9"><a href="data-tarnsformation.html#cb57-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb57-10"><a href="data-tarnsformation.html#cb57-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb57-11"><a href="data-tarnsformation.html#cb57-11" tabindex="-1"></a>                      Sample<span class="dv">-1</span>   Sample<span class="dv">-2</span>   Sample<span class="dv">-3</span></span>
<span id="cb57-12"><a href="data-tarnsformation.html#cb57-12" tabindex="-1"></a>Eubacterium limosum <span class="sc">-</span><span class="fl">0.7821978</span> <span class="sc">-</span><span class="fl">0.8924188</span> <span class="sc">-</span><span class="fl">0.8682102</span></span>
<span id="cb57-13"><a href="data-tarnsformation.html#cb57-13" tabindex="-1"></a>Staphylococcus      <span class="sc">-</span><span class="fl">1.1517915</span> <span class="sc">-</span><span class="fl">1.2167251</span> <span class="sc">-</span><span class="fl">1.1804675</span></span>
<span id="cb57-14"><a href="data-tarnsformation.html#cb57-14" tabindex="-1"></a>Oceanospirillum     <span class="sc">-</span><span class="fl">0.7821978</span> <span class="sc">-</span><span class="fl">0.7027117</span> <span class="sc">-</span><span class="fl">0.8682102</span></span>
<span id="cb57-15"><a href="data-tarnsformation.html#cb57-15" tabindex="-1"></a>Ruminococcus obeum   <span class="fl">1.2475566</span>  <span class="fl">1.9669852</span>  <span class="fl">1.7167961</span></span>
<span id="cb57-16"><a href="data-tarnsformation.html#cb57-16" tabindex="-1"></a>Burkholderia        <span class="sc">-</span><span class="fl">0.7821978</span> <span class="sc">-</span><span class="fl">0.8924188</span> <span class="sc">-</span><span class="fl">0.6855514</span></span></code></pre></div>
</div>
<div id="log10-transform" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Log10 Transform<a class="anchor" aria-label="anchor" href="#log10-transform"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="data-tarnsformation.html#cb58-1" tabindex="-1"></a>(ps_log10 <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'log10'</span>))</span>
<span id="cb58-2"><a href="data-tarnsformation.html#cb58-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb58-3"><a href="data-tarnsformation.html#cb58-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb58-4"><a href="data-tarnsformation.html#cb58-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb58-5"><a href="data-tarnsformation.html#cb58-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb58-6"><a href="data-tarnsformation.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="data-tarnsformation.html#cb58-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb58-8"><a href="data-tarnsformation.html#cb58-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_log10)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb58-9"><a href="data-tarnsformation.html#cb58-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb58-10"><a href="data-tarnsformation.html#cb58-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb58-11"><a href="data-tarnsformation.html#cb58-11" tabindex="-1"></a>                    Sample<span class="dv">-1</span>  Sample<span class="dv">-2</span>  Sample<span class="dv">-3</span></span>
<span id="cb58-12"><a href="data-tarnsformation.html#cb58-12" tabindex="-1"></a>Eubacterium limosum <span class="fl">0.301030</span> <span class="fl">0.3010300</span> <span class="fl">0.3010300</span></span>
<span id="cb58-13"><a href="data-tarnsformation.html#cb58-13" tabindex="-1"></a>Staphylococcus      <span class="fl">0.000000</span> <span class="fl">0.0000000</span> <span class="fl">0.0000000</span></span>
<span id="cb58-14"><a href="data-tarnsformation.html#cb58-14" tabindex="-1"></a>Oceanospirillum     <span class="fl">0.301030</span> <span class="fl">0.4771213</span> <span class="fl">0.3010300</span></span>
<span id="cb58-15"><a href="data-tarnsformation.html#cb58-15" tabindex="-1"></a>Ruminococcus obeum  <span class="fl">1.954243</span> <span class="fl">2.9552065</span> <span class="fl">2.7930916</span></span>
<span id="cb58-16"><a href="data-tarnsformation.html#cb58-16" tabindex="-1"></a>Burkholderia        <span class="fl">0.301030</span> <span class="fl">0.3010300</span> <span class="fl">0.4771213</span></span></code></pre></div>
</div>
<div id="log10p-transform" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Log10p Transform<a class="anchor" aria-label="anchor" href="#log10p-transform"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data-tarnsformation.html#cb59-1" tabindex="-1"></a>(ps_log10p <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'log10p'</span>))</span>
<span id="cb59-2"><a href="data-tarnsformation.html#cb59-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb59-3"><a href="data-tarnsformation.html#cb59-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb59-4"><a href="data-tarnsformation.html#cb59-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb59-5"><a href="data-tarnsformation.html#cb59-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb59-6"><a href="data-tarnsformation.html#cb59-6" tabindex="-1"></a></span>
<span id="cb59-7"><a href="data-tarnsformation.html#cb59-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb59-8"><a href="data-tarnsformation.html#cb59-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_log10p)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb59-9"><a href="data-tarnsformation.html#cb59-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb59-10"><a href="data-tarnsformation.html#cb59-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb59-11"><a href="data-tarnsformation.html#cb59-11" tabindex="-1"></a>                    Sample<span class="dv">-1</span>  Sample<span class="dv">-2</span>  Sample<span class="dv">-3</span></span>
<span id="cb59-12"><a href="data-tarnsformation.html#cb59-12" tabindex="-1"></a>Eubacterium limosum <span class="fl">0.301030</span> <span class="fl">0.3010300</span> <span class="fl">0.3010300</span></span>
<span id="cb59-13"><a href="data-tarnsformation.html#cb59-13" tabindex="-1"></a>Staphylococcus      <span class="fl">0.000000</span> <span class="fl">0.0000000</span> <span class="fl">0.0000000</span></span>
<span id="cb59-14"><a href="data-tarnsformation.html#cb59-14" tabindex="-1"></a>Oceanospirillum     <span class="fl">0.301030</span> <span class="fl">0.4771213</span> <span class="fl">0.3010300</span></span>
<span id="cb59-15"><a href="data-tarnsformation.html#cb59-15" tabindex="-1"></a>Ruminococcus obeum  <span class="fl">1.954243</span> <span class="fl">2.9552065</span> <span class="fl">2.7930916</span></span>
<span id="cb59-16"><a href="data-tarnsformation.html#cb59-16" tabindex="-1"></a>Burkholderia        <span class="fl">0.301030</span> <span class="fl">0.3010300</span> <span class="fl">0.4771213</span></span></code></pre></div>
</div>
<div id="clr-transform" class="section level2" number="9.11">
<h2>
<span class="header-section-number">9.11</span> CLR Transform<a class="anchor" aria-label="anchor" href="#clr-transform"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Note that small pseudocount is added if data contains zeroes</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="data-tarnsformation.html#cb60-1" tabindex="-1"></a>(ps_clr <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'clr'</span>))</span>
<span id="cb60-2"><a href="data-tarnsformation.html#cb60-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb60-3"><a href="data-tarnsformation.html#cb60-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb60-4"><a href="data-tarnsformation.html#cb60-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb60-5"><a href="data-tarnsformation.html#cb60-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb60-6"><a href="data-tarnsformation.html#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="data-tarnsformation.html#cb60-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb60-8"><a href="data-tarnsformation.html#cb60-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_clr)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb60-9"><a href="data-tarnsformation.html#cb60-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb60-10"><a href="data-tarnsformation.html#cb60-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb60-11"><a href="data-tarnsformation.html#cb60-11" tabindex="-1"></a>                     Sample<span class="dv">-1</span>  Sample<span class="dv">-2</span>  Sample<span class="dv">-3</span></span>
<span id="cb60-12"><a href="data-tarnsformation.html#cb60-12" tabindex="-1"></a>Eubacterium limosum <span class="sc">-</span><span class="fl">1.497647</span> <span class="sc">-</span><span class="fl">2.040486</span> <span class="sc">-</span><span class="fl">2.016371</span></span>
<span id="cb60-13"><a href="data-tarnsformation.html#cb60-13" tabindex="-1"></a>Staphylococcus      <span class="sc">-</span><span class="fl">3.555474</span> <span class="sc">-</span><span class="fl">3.359449</span> <span class="sc">-</span><span class="fl">3.114983</span></span>
<span id="cb60-14"><a href="data-tarnsformation.html#cb60-14" tabindex="-1"></a>Oceanospirillum     <span class="sc">-</span><span class="fl">1.497647</span> <span class="sc">-</span><span class="fl">1.490870</span> <span class="sc">-</span><span class="fl">2.016371</span></span>
<span id="cb60-15"><a href="data-tarnsformation.html#cb60-15" tabindex="-1"></a>Ruminococcus obeum   <span class="fl">2.855975</span>  <span class="fl">4.452252</span>  <span class="fl">4.008689</span></span>
<span id="cb60-16"><a href="data-tarnsformation.html#cb60-16" tabindex="-1"></a>Burkholderia        <span class="sc">-</span><span class="fl">1.497647</span> <span class="sc">-</span><span class="fl">2.040486</span> <span class="sc">-</span><span class="fl">1.505545</span></span></code></pre></div>
</div>
<div id="shift-the-baseline" class="section level2" number="9.12">
<h2>
<span class="header-section-number">9.12</span> Shift the baseline<a class="anchor" aria-label="anchor" href="#shift-the-baseline"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data-tarnsformation.html#cb61-1" tabindex="-1"></a>(ps_shift <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'shift'</span>, <span class="at">shift=</span><span class="dv">1</span>))</span>
<span id="cb61-2"><a href="data-tarnsformation.html#cb61-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb61-3"><a href="data-tarnsformation.html#cb61-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb61-4"><a href="data-tarnsformation.html#cb61-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb61-5"><a href="data-tarnsformation.html#cb61-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb61-6"><a href="data-tarnsformation.html#cb61-6" tabindex="-1"></a></span>
<span id="cb61-7"><a href="data-tarnsformation.html#cb61-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb61-8"><a href="data-tarnsformation.html#cb61-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_shift)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb61-9"><a href="data-tarnsformation.html#cb61-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb61-10"><a href="data-tarnsformation.html#cb61-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb61-11"><a href="data-tarnsformation.html#cb61-11" tabindex="-1"></a>                    Sample<span class="dv">-1</span> Sample<span class="dv">-2</span> Sample<span class="dv">-3</span></span>
<span id="cb61-12"><a href="data-tarnsformation.html#cb61-12" tabindex="-1"></a>Eubacterium limosum        <span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">2</span></span>
<span id="cb61-13"><a href="data-tarnsformation.html#cb61-13" tabindex="-1"></a>Staphylococcus             <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span></span>
<span id="cb61-14"><a href="data-tarnsformation.html#cb61-14" tabindex="-1"></a>Oceanospirillum            <span class="dv">2</span>        <span class="dv">3</span>        <span class="dv">2</span></span>
<span id="cb61-15"><a href="data-tarnsformation.html#cb61-15" tabindex="-1"></a>Ruminococcus obeum        <span class="dv">90</span>      <span class="dv">902</span>      <span class="dv">621</span></span>
<span id="cb61-16"><a href="data-tarnsformation.html#cb61-16" tabindex="-1"></a>Burkholderia               <span class="dv">2</span>        <span class="dv">2</span>        <span class="dv">3</span></span></code></pre></div>
</div>
<div id="data-scaling" class="section level2" number="9.13">
<h2>
<span class="header-section-number">9.13</span> Data Scaling<a class="anchor" aria-label="anchor" href="#data-scaling"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="data-tarnsformation.html#cb62-1" tabindex="-1"></a>(ps_scale <span class="ot">&lt;-</span> microbiome<span class="sc">::</span><span class="fu">transform</span>(ps_raw, <span class="st">'scale'</span>, <span class="at">scale=</span><span class="dv">1</span>))</span>
<span id="cb62-2"><a href="data-tarnsformation.html#cb62-2" tabindex="-1"></a>phyloseq<span class="sc">-</span>class experiment<span class="sc">-</span>level object</span>
<span id="cb62-3"><a href="data-tarnsformation.html#cb62-3" tabindex="-1"></a><span class="fu">otu_table</span>()   OTU Table<span class="sc">:</span>         [ <span class="dv">130</span> taxa and <span class="dv">222</span> samples ]</span>
<span id="cb62-4"><a href="data-tarnsformation.html#cb62-4" tabindex="-1"></a><span class="fu">sample_data</span>() Sample Data<span class="sc">:</span>       [ <span class="dv">222</span> samples by <span class="dv">8</span> sample variables ]</span>
<span id="cb62-5"><a href="data-tarnsformation.html#cb62-5" tabindex="-1"></a><span class="fu">tax_table</span>()   Taxonomy Table<span class="sc">:</span>    [ <span class="dv">130</span> taxa by <span class="dv">3</span> taxonomic ranks ]</span>
<span id="cb62-6"><a href="data-tarnsformation.html#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="data-tarnsformation.html#cb62-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb62-8"><a href="data-tarnsformation.html#cb62-8" tabindex="-1"></a><span class="fu">otu_table</span>(ps_scale)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb62-9"><a href="data-tarnsformation.html#cb62-9" tabindex="-1"></a>OTU Table<span class="sc">:</span>          [<span class="dv">5</span> taxa and <span class="dv">3</span> samples]</span>
<span id="cb62-10"><a href="data-tarnsformation.html#cb62-10" tabindex="-1"></a>                     taxa are rows</span>
<span id="cb62-11"><a href="data-tarnsformation.html#cb62-11" tabindex="-1"></a>                    Sample<span class="dv">-1</span> Sample<span class="dv">-2</span> Sample<span class="dv">-3</span></span>
<span id="cb62-12"><a href="data-tarnsformation.html#cb62-12" tabindex="-1"></a>Eubacterium limosum        <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">1</span></span>
<span id="cb62-13"><a href="data-tarnsformation.html#cb62-13" tabindex="-1"></a>Staphylococcus             <span class="dv">0</span>        <span class="dv">0</span>        <span class="dv">0</span></span>
<span id="cb62-14"><a href="data-tarnsformation.html#cb62-14" tabindex="-1"></a>Oceanospirillum            <span class="dv">1</span>        <span class="dv">2</span>        <span class="dv">1</span></span>
<span id="cb62-15"><a href="data-tarnsformation.html#cb62-15" tabindex="-1"></a>Ruminococcus obeum        <span class="dv">89</span>      <span class="dv">901</span>      <span class="dv">620</span></span>
<span id="cb62-16"><a href="data-tarnsformation.html#cb62-16" tabindex="-1"></a>Burkholderia               <span class="dv">1</span>        <span class="dv">1</span>        <span class="dv">2</span></span></code></pre></div>
</div>
<div id="save-transformed-objects" class="section level2" number="9.14">
<h2>
<span class="header-section-number">9.14</span> Save transformed objects<a class="anchor" aria-label="anchor" href="#save-transformed-objects"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span></span>
<span>  <span class="va">ps_asin</span>, </span>
<span>  <span class="va">ps_identity</span>,</span>
<span>  <span class="va">ps_compositional</span>, </span>
<span>  <span class="va">ps_z_otu</span>, </span>
<span>  <span class="va">ps_z_sample</span>, </span>
<span>  <span class="va">ps_log10</span>, </span>
<span>  <span class="va">ps_log10p</span>, </span>
<span>  <span class="va">ps_clr</span>, </span>
<span>  <span class="va">ps_shift</span>, </span>
<span>  <span class="va">ps_scale</span>, </span>
<span>  file <span class="op">=</span> <span class="st">"data/ps_transformed.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="confirm-saved-object" class="section level2" number="9.15">
<h2>
<span class="header-section-number">9.15</span> Confirm saved object<a class="anchor" aria-label="anchor" href="#confirm-saved-object"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="data-tarnsformation.html#cb64-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/ps_transformed.rda"</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-2"><a href="data-tarnsformation.html#cb64-2" tabindex="-1"></a>Loading objects<span class="sc">:</span></span>
<span id="cb64-3"><a href="data-tarnsformation.html#cb64-3" tabindex="-1"></a>  ps_asin</span>
<span id="cb64-4"><a href="data-tarnsformation.html#cb64-4" tabindex="-1"></a>  ps_identity</span>
<span id="cb64-5"><a href="data-tarnsformation.html#cb64-5" tabindex="-1"></a>  ps_compositional</span>
<span id="cb64-6"><a href="data-tarnsformation.html#cb64-6" tabindex="-1"></a>  ps_z_otu</span>
<span id="cb64-7"><a href="data-tarnsformation.html#cb64-7" tabindex="-1"></a>  ps_z_sample</span>
<span id="cb64-8"><a href="data-tarnsformation.html#cb64-8" tabindex="-1"></a>  ps_log10</span>
<span id="cb64-9"><a href="data-tarnsformation.html#cb64-9" tabindex="-1"></a>  ps_log10p</span>
<span id="cb64-10"><a href="data-tarnsformation.html#cb64-10" tabindex="-1"></a>  ps_clr</span>
<span id="cb64-11"><a href="data-tarnsformation.html#cb64-11" tabindex="-1"></a>  ps_shift</span>
<span id="cb64-12"><a href="data-tarnsformation.html#cb64-12" tabindex="-1"></a>  ps_scale</span></code></pre></div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="pipeline-for-cleaning-phyloseq-objects.html"><span class="header-section-number">8</span> Pipeline for Cleaning Phyloseq Objects</a></div>
<div class="next"><a href="distance-calculation-in-microbiome-data-analysis.html"><span class="header-section-number">10</span> Distance Calculation in Microbiome Data Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-tarnsformation"><span class="header-section-number">9</span> Data Tranformation from Phyloseq Objects</a></li>
<li><a class="nav-link" href="#import-processed-phyloseq-object"><span class="header-section-number">9.1</span> Import processed phyloseq object</a></li>
<li><a class="nav-link" href="#raw-abundance"><span class="header-section-number">9.2</span> Raw Abundance</a></li>
<li><a class="nav-link" href="#no-transformation"><span class="header-section-number">9.3</span> No Transformation</a></li>
<li><a class="nav-link" href="#relative-abundance"><span class="header-section-number">9.4</span> Relative abundance</a></li>
<li><a class="nav-link" href="#arc-sine-asin-transformation"><span class="header-section-number">9.5</span> Arc sine (asin) transformation</a></li>
<li><a class="nav-link" href="#compositional-version"><span class="header-section-number">9.6</span> Compositional Version</a></li>
<li><a class="nav-link" href="#z-transform-for-otus"><span class="header-section-number">9.7</span> Z-transform for OTUs</a></li>
<li><a class="nav-link" href="#z-transform-for-samples"><span class="header-section-number">9.8</span> Z-transform for Samples</a></li>
<li><a class="nav-link" href="#log10-transform"><span class="header-section-number">9.9</span> Log10 Transform</a></li>
<li><a class="nav-link" href="#log10p-transform"><span class="header-section-number">9.10</span> Log10p Transform</a></li>
<li><a class="nav-link" href="#clr-transform"><span class="header-section-number">9.11</span> CLR Transform</a></li>
<li><a class="nav-link" href="#shift-the-baseline"><span class="header-section-number">9.12</span> Shift the baseline</a></li>
<li><a class="nav-link" href="#data-scaling"><span class="header-section-number">9.13</span> Data Scaling</a></li>
<li><a class="nav-link" href="#save-transformed-objects"><span class="header-section-number">9.14</span> Save transformed objects</a></li>
<li><a class="nav-link" href="#confirm-saved-object"><span class="header-section-number">9.15</span> Confirm saved object</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/tmbuza/imap-data-preparation.git/blob/gh-pages/05_data_transformation.Rmd">View source <i class="fas fa-air-freshener"></i></a></li>
          <li><a id="book-edit" href="https://github.com/tmbuza/imap-data-preparation.git/edit/gh-pages/05_data_transformation.Rmd">Edit this page <i class="fas fa-air-freshener"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container">
    <div class="row">
      <div class="col-12 col-md-6 mt-3">
        <p><strong><u><a class="text-light" href="https://microbiome.complexdatainsights.com"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a></u></strong>: End-to-End Practical User Guides Using Integrated Approaches</p>
<br><p>Authored by Teresia Mrema-Buza, Last updated: <b>2024-04-26</b>.</p>
<br>
</div>
      <div class="col-12 col-md-6 mt-3">
        <p>Note: This practical guide was created using the <a class="text-light" href="https://bookdown.org/yihui/bookdown/">bookdown</a> R package, styled with the modern bs4_book format.</p>
      </div>

    </div>
  </div>
</footer>
</body>
</html>
